(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{219:function(e,t,a){e.exports={Container:"Auth_Container__1KNy7",socialButtons:"Auth_socialButtons__2wwH9"}},24:function(e,t,a){e.exports={Layout:"Layout_Layout__3t6t4",siteLayoutSiteLayoutBackground:"Layout_siteLayoutSiteLayoutBackground__3hzn7",siteLayoutSiteLayoutMain:"Layout_siteLayoutSiteLayoutMain__31K3l",ItemWrapper:"Layout_ItemWrapper__1epI5",Icon:"Layout_Icon__1H3fU",ItemText:"Layout_ItemText__3u4uH"}},370:function(e,t,a){e.exports={Avatar:"Account_Avatar__l4shx"}},382:function(e,t,a){e.exports=a(792)},405:function(e,t,a){},621:function(e,t){},623:function(e,t){},660:function(e,t){},661:function(e,t){},792:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),l=a(2),c=a.n(l),i=a(801),o=a(9),s=a.n(o),u=(a(405),a(57)),m=a.n(u),d=a(73),p=a(6),f=a(806),h=a(800),g=a(802),E=a(805),b=a(87),y=a(88),v=a(91),k=a(89),w=a(92),O=function(e){function t(){return Object(b.a)(this,t),Object(v.a)(this,Object(k.a)(t).apply(this,arguments))}return Object(w.a)(t,e),Object(y.a)(t,[{key:"componentDidMount",value:function(){this.props.onLogout()}},{key:"render",value:function(){return r.a.createElement(g.a,{to:"/login"})}}]),t}(n.Component),j=O,I=a(67),C=a(81),x=a(3),S=a(219),_=a.n(S),N=function(e){var t=null;if(e.icon){var a=function(e){for(var t=[],a=[];e.length>0;)if(0===(e=e.trim()).indexOf("</"))(e=e.substring(2)).indexOf("<")>0?(e=e.substring(e.indexOf("<")),a.pop()):e="";else{var n={type:(e=e.substring(e.indexOf("<"))).substring(1,e.indexOf(" ")),children:[]},r=(e=e.substring(e.indexOf(" "))).substring(0,e.indexOf(">")),l=r.indexOf("/>")>=0;for(e=e.substring(e.indexOf(">")+1).trim();r.length>0;){var c=r.substring(0,r.indexOf("=")).trim(),i=(r=r.substring(r.indexOf('"')+1)).substring(0,r.indexOf('"')).trim();r=r.substring(r.indexOf('"')+1).trim(),n[c]=i}0===a.length?t.push(n):a[a.length-1].children.push(n),l||a.push(n)}return t[0]}(e.icon);t=r.a.createElement("svg",{"data-testid":e.datatestid||"svg",height:a.height,width:a.width,viewBox:a.viewBox,className:e.className},a.children.map(function(e,t){return function e(t,a){switch(t.type){case"path":return r.a.createElement("path",{key:a,d:t.d,fill:t.fill},t.children.map(function(t,a){return e(t,a)}));case"g":return r.a.createElement("g",{key:a,fill:t.fill},t.children.map(function(t,a){return e(t,a)}));default:return}}(e,t)}))}return t},F=new C.a,D=Object(E.a)(function(e){var t=Object(n.useState)(!1),a=Object(p.a)(t,2),l=a[0],c=a[1],i=Object(n.useState)(!1),o=Object(p.a)(i,2),s=o[0],u=o[1];Object(n.useEffect)(function(){f()});var m="?rememberme=false";l&&(m="?rememberme=true");var d="&redirect=/login";e.history.location.state&&(d="&redirect="+e.history.location.state.toString());var f=function(){F.get("cookies_consent")&&u(!0)},h="https://getreward.herokuapp.com/api/auth/";return r.a.createElement("div",{className:_.a.Container},s?r.a.createElement(r.a.Fragment,null,r.a.createElement("h1",null,"Continue with:"),r.a.createElement("div",{className:_.a.socialButtons},r.a.createElement("a",{href:h+"google/start".concat(m)},r.a.createElement(N,{icon:'<svg width="50" height="50" viewBox="0 0 24 24"><path fill="#4285F4" d="M12.24 10.285V14.4h6.806c-.275 1.765-2.056 5.174-6.806 5.174-4.095 0-7.439-3.389-7.439-7.574s3.345-7.574 7.439-7.574c2.33 0 3.891.989 4.785 1.849l3.254-3.138C18.189 1.186 15.479 0 12.24 0c-6.635 0-12 5.365-12 12s5.365 12 12 12c6.926 0 11.52-4.869 11.52-11.726 0-.788-.085-1.39-.189-1.989H12.24z"></path></svg>'}),r.a.createElement("div",null,"GOOGLE")),r.a.createElement("a",{href:h+"facebook/start".concat(m)},r.a.createElement(N,{icon:'<svg width="50" height="50" viewBox="0 0 24 24"><path fill="#1877F2" d="M23.9981 11.9991C23.9981 5.37216 18.626 0 11.9991 0C5.37216 0 0 5.37216 0 11.9991C0 17.9882 4.38789 22.9522 10.1242 23.8524V15.4676H7.07758V11.9991H10.1242V9.35553C10.1242 6.34826 11.9156 4.68714 14.6564 4.68714C15.9692 4.68714 17.3424 4.92149 17.3424 4.92149V7.87439H15.8294C14.3388 7.87439 13.8739 8.79933 13.8739 9.74824V11.9991H17.2018L16.6698 15.4676H13.8739V23.8524C19.6103 22.9522 23.9981 17.9882 23.9981 11.9991Z"></path></svg>'}),r.a.createElement("div",null,"FACEBOOK")),r.a.createElement("a",{href:h+"github/start".concat(m,"&").concat(d)},r.a.createElement(N,{icon:'<svg width="50" height="50" viewBox="0 0 16 16"><path fill="#333" d="M8 0C3.58 0 0 3.58 0 8C0 11.54 2.29 14.53 5.47 15.59C5.87 15.66 6.02 15.42 6.02 15.21C6.02 15.02 6.01 14.39 6.01 13.72C4 14.09 3.48 13.23 3.32 12.78C3.23 12.55 2.84 11.84 2.5 11.65C2.22 11.5 1.82 11.13 2.49 11.12C3.12 11.11 3.57 11.7 3.72 11.94C4.44 13.15 5.59 12.81 6.05 12.6C6.12 12.08 6.33 11.73 6.56 11.53C4.78 11.33 2.92 10.64 2.92 7.58C2.92 6.71 3.23 5.99 3.74 5.43C3.66 5.23 3.38 4.41 3.82 3.31C3.82 3.31 4.49 3.1 6.02 4.13C6.66 3.95 7.34 3.86 8.02 3.86C8.7 3.86 9.38 3.95 10.02 4.13C11.55 3.09 12.22 3.31 12.22 3.31C12.66 4.41 12.38 5.23 12.3 5.43C12.81 5.99 13.12 6.7 13.12 7.58C13.12 10.65 11.25 11.33 9.47 11.53C9.76 11.78 10.01 12.26 10.01 13.01C10.01 14.08 10 14.94 10 15.21C10 15.42 10.15 15.67 10.55 15.59C13.71 14.53 16 11.53 16 8C16 3.58 12.42 0 8 0Z"></path></svg>'}),r.a.createElement("div",null,"GITHUB"))),r.a.createElement(I.a,{checked:l,onChange:function(){return c(!l)}},"Remember me")):r.a.createElement(r.a.Fragment,null,r.a.createElement("div",null,"We use cookies only for login purposes. In order to proceed you need to agree with the use of cookies."),r.a.createElement(x.a,{onClick:function(){F.set("cookies_consent","true",{path:"/",maxAge:3153e4}),f()}},"Agree"),r.a.createElement(x.a,{onClick:function(){window.open("https://websiter.dev","_self")}},"Return to the homepage")))}),T=a(11),M=a(28),A=(new C.a,a(117),a(101),a(200),a(545),a(257),a(258),a(550),a(259),a(553),a(260),a(261),a(201),a(558),a(560),a(562),a(793),a(566),a(568),a(570),a(262),a(143),a(263),a(795),a(794),a(578),a(580),a(582),a(584),a(586),a(589),a(131)),P=a(35),z=a(24),L=a(330),R=a.n(L),G=a(335),B=a.n(G),V=a(334),W=a.n(V),K=a(333),U=a.n(K),q=a(221),H=a.n(q),J=a(332),Y=a.n(J),Z=a(331),$=a.n(Z),Q=a(329),X=a.n(Q),ee=A.a.Header,te=(A.a.Sider,A.a.Content),ae=Object(E.a)(function(e){var t=Object(n.useState)(),a=Object(p.a)(t,2),l=(a[0],a[1],e.history.location.pathname.split("/")[1]||void 0);return console.log(l),r.a.createElement(r.a.Fragment,null,e.isAuthenticated?r.a.createElement(A.a,{className:z.Layout},r.a.createElement(ee,{className:z.siteLayoutSiteLayoutBackground},r.a.createElement(P.a,{theme:"light",mode:"horizontal",selectedKeys:[l],onClick:function(t){var a=t.key;return e.history.push("/"+a)},overflowedIndicator:r.a.createElement(X.a,null)},r.a.createElement(P.a.Item,{key:"dashboard"},r.a.createElement("div",{className:z.ItemWrapper},r.a.createElement("div",{className:z.Icon},r.a.createElement(H.a,null)),r.a.createElement("div",{className:z.ItemText},"Dashboard"))),r.a.createElement(P.a.Item,{key:"progresses"},r.a.createElement("div",{className:z.ItemWrapper},r.a.createElement("div",{className:z.Icon},r.a.createElement(H.a,null)),r.a.createElement("div",{className:z.ItemText},"Progresses"))),r.a.createElement(P.a.Item,{key:"goals"},r.a.createElement("div",{className:z.ItemWrapper},r.a.createElement("div",{className:z.Icon},r.a.createElement(R.a,null)),r.a.createElement("div",{className:z.ItemText},"Goals"))),r.a.createElement(P.a.Item,{key:"shop"},r.a.createElement("div",{className:z.ItemWrapper},r.a.createElement("div",{className:z.Icon},r.a.createElement($.a,null)),r.a.createElement("div",{className:z.ItemText},"Shop"))),r.a.createElement(P.a.Item,{key:"friends"},r.a.createElement("div",{className:z.ItemWrapper},r.a.createElement("div",{className:z.Icon},r.a.createElement(Y.a,null)),r.a.createElement("div",{className:z.ItemText},"Friends"))),r.a.createElement(P.a.Item,{key:"wishlist"},r.a.createElement("div",{className:z.ItemWrapper},r.a.createElement("div",{className:z.Icon},r.a.createElement(U.a,null)),r.a.createElement("div",{className:z.ItemText},"Wishlist"))),r.a.createElement(P.a.Item,{key:"account"},r.a.createElement("div",{className:z.ItemWrapper},r.a.createElement("div",{className:z.Icon},r.a.createElement(W.a,null)),r.a.createElement("div",{className:z.ItemText},"Account"))),r.a.createElement(P.a.Item,{key:"logout"},r.a.createElement("div",{className:z.ItemWrapper},r.a.createElement("div",{className:z.Icon},r.a.createElement(B.a,null)),r.a.createElement("div",{className:z.ItemText},"Logout"))))),r.a.createElement(te,{className:z.siteLayoutSiteLayoutMain},e.children)):e.children)}),ne=a(25),re=a(8),le=a(22),ce=a(30),ie=a.n(ce),oe=a(4),se=a(165),ue=a.n(se),me=new C.a,de=function(e,t,a,n){n=Object(oe.a)({forceAuth:!0,forceActivate:!0,pullData:!0},n||{});var r=function(){sessionStorage.setItem("systemRefresh","0");var e=me.get("auth_token"),t=me.get("rememberme");t&&(me.remove("rememberme",{path:"/"}),"false"===t&&me.remove("auth_token",{path:"/"}));var a=ue.a.decode(e);return s.a.defaults.headers.post["Content-Type"]="application/json",s.a.defaults.headers.put["Content-Type"]="application/json",s.a.defaults.headers.delete["Content-Type"]="application/json",s.a.defaults.headers.common.Accept="application/json",!(!e||!a)&&(s.a.defaults.headers.common["x-auth-token"]=e,s.a.defaults.headers.post["x-auth-token"]=e,s.a.defaults.headers.get["x-auth-token"]=e,s.a.defaults.headers.delete["x-auth-token"]=e,s.a.defaults.headers.put["x-auth-token"]=e,a._id)}();n.forceAuth&&(r||e.history.push({pathname:"/login",state:e.history.location.pathname})),n.forceActivate&&e.isAuthenticated&&t.user&&"notactivated"===!t.user.status&&e.history.push("/activate-account"),n.pullData&&s.a.get("/api"+e.history.location.pathname).then(function(t){return t.data.status&&"no account"===t.data.status&&e.history.push("/activate-account"),a(Object(oe.a)({},t.data,{isAuthenticated:r})),t.data}).catch(function(e){})},pe=a(23),fe=a(41),he=a(373),ge=a(80),Ee=a(64),be=a(65),ye=a.n(be),ve=a(31),ke=function(e,t,a,n){if(null==e)return alert("No file selected.");var r=new FileReader;r.onload=function(){var r=Object(d.a)(m.a.mark(function r(l){return m.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:Oe(e,{width:t,height:t},function(e){we(e,"/120").then(function(e){Ie(e,a,n)})});case 1:case"end":return r.stop()}},r)}));return function(e){return r.apply(this,arguments)}}(),r.readAsArrayBuffer(e)},we=function(e,t,a){return a=a||(e.match(/^data:([^;]+);/)||"")[1],fetch(e).then(function(e){return e.arrayBuffer()}).then(function(e){return new File([e],t,{type:a})})},Oe=function(e,t,a){if(e){var n=new FileReader;n.onload=function(e){je(e.target.result,t,a)},n.readAsDataURL(e)}},je=function(e,t,a){var n,r=new Image;r.onload=function(){var e=r.width/t.width,l=r.height/t.height,c=document.createElement("canvas"),i=c.getContext("2d");c.width=r.width,c.height=r.height,i.drawImage(r,0,0),(e>1||l>1)&&(r.width>r.height?(c.height=r.height/r.width*t.width,c.width=t.width):(c.width=r.width/r.height*t.width,c.height=t.width)),i.drawImage(c,0,0,c.width,c.height),i.drawImage(r,0,0,c.width,c.height),n=c.toDataURL(),a(n)},r.src=e},Ie=function(e,t,a){return s.a.post("/api/sign-s3",{fileName:t}).then(function(t){Ce(e,t.data,a)}).catch(function(e){})},Ce=function(e,t,a){return s.a.put(t.signedRequest,e,{headers:{"Content-Type":"multipart/form-data"}}).then(function(e){a(t.url)}).catch(function(e){console.log(e)})},xe=a(336),Se=a(176),_e=a(338),Ne=a.n(_e),Fe=a(337),De=a.n(Fe),Te=function(e){var t=Object(n.useState)(""),a=Object(p.a)(t,2),l=a[0],c=a[1],i=Object(n.useState)(),o=Object(p.a)(i,2),s=o[0],u=o[1],m=Object(n.useState)(),d=Object(p.a)(m,2),f=d[0],h=d[1],g=e.rewards.findIndex(function(t){return t.key===e.rewardKey});return-1===g&&e.setRewards([].concat(Object(ne.a)(e.rewards),[{key:e.rewardKey,rewards:[]}])),console.log(e.rewards),g>=0?r.a.createElement("div",null,r.a.createElement(T.a.Item,{label:e.label,key:e.rewardKey},r.a.createElement("ol",null,e.rewards[g].rewards.map(function(t,a){return r.a.createElement("li",null,"simple"===t.mode?t.simple:"money"===t.mode?t.money:"item"===t.mode?t.itemName:"",r.a.createElement(x.a,{type:"link",onClick:function(){h(a),u(t)}},r.a.createElement(De.a,null)),r.a.createElement(x.a,{type:"link",onClick:function(){var t=Object(ne.a)(e.rewards);t[g]=Object(oe.a)({},t[g],{rewards:t[g].rewards.filter(function(e,t){return t!==a})}),e.setRewards(t)},danger:!0},r.a.createElement(Ne.a,null)))})),r.a.createElement(x.a,{type:"link",onClick:function(){h("new"),u({mode:"simple"})}},r.a.createElement(ye.a,null),"Add rewards")),r.a.createElement(pe.a,{visible:s,title:"new"===s?"Add new reward":"Edit reward",closable:!0,onCancel:function(){return u()},onOk:function(){var t=Object(ne.a)(e.rewards),a={};"money"===s.mode?a.money=s.money:(Object(xe.a)("rewardToSave"),a=Object(oe.a)({},s,{money:void 0})),t[g]="new"===f?Object(oe.a)({},t[g],{rewards:[].concat(Object(ne.a)(t[g].rewards),[a])}):Object(oe.a)({},t[g],{rewards:t[g].rewards.map(function(e,t){return t===f?a:e})}),e.setRewards(t),u(),h()},destroyOnClose:!0,okText:"Save"},s&&r.a.createElement(r.a.Fragment,null,r.a.createElement(T.a.Item,{label:"Reward type"},r.a.createElement(fe.a,{placeholder:"Type",value:s.mode,onSelect:function(e){return u(Object(oe.a)({},s,{mode:e}))},style:{width:"100%"}},r.a.createElement(fe.a.Option,{key:"simple",value:"simple"},"Simple reward"),r.a.createElement(fe.a.Option,{key:"item",value:"item"},"Item reward"),r.a.createElement(fe.a.Option,{key:"money",value:"money"},"Money reward"))),r.a.createElement(ge.a,{type:"horizontal"}),"simple"===s.mode?r.a.createElement(T.a.Item,{label:"Description"},r.a.createElement(M.a.TextArea,{value:s.simple,onChange:function(e){var t=e.target.value;return u(Object(oe.a)({},s,{simple:t}))},placeholder:"Explain how you will reward"})):"money"===s.mode?r.a.createElement(T.a.Item,{label:"Amount"},r.a.createElement(Se.a,{value:s.money,onChange:function(e){return u(Object(oe.a)({},s,{money:e}))}})):r.a.createElement(r.a.Fragment,null,r.a.createElement(T.a.Item,{label:"Images"},r.a.createElement(Ee.a,{listType:"picture-card",fileList:(s.itemImages||[]).map(function(e,t){return Object(oe.a)({},e,{uid:t})}),onPreview:function(e){c(e.url)},onChange:function(e){var t=e.fileList;return u(Object(oe.a)({},s,{itemImages:t}))},customRequest:function(e){var t=e.file;ke(t,800,void 0,function(e){u(Object(oe.a)({},s,{itemImages:[].concat(Object(ne.a)(s.itemImages||[]),[{url:e}]).map(function(e,t){return Object(oe.a)({},e,{uid:t})})}))})}},(s.itemImages||[]).length>=8?null:r.a.createElement("div",null,r.a.createElement(ye.a,null),r.a.createElement("div",{className:"ant-upload-text"},"Upload"))),r.a.createElement(pe.a,{visible:l,footer:null,onCancel:function(){return c("")}},r.a.createElement("img",{alt:"example",style:{width:"100%"},src:l}))),r.a.createElement(T.a.Item,{label:"Name"},r.a.createElement(M.a,{value:s.itemName,onChange:function(e){var t=e.target.value;return u(Object(oe.a)({},s,{itemName:t}))}})),r.a.createElement(T.a.Item,{label:"Description"},r.a.createElement(M.a.TextArea,{value:s.itemDescription,onChange:function(e){var t=e.target.value;return u(Object(oe.a)({},s,{itemDescription:t}))}})))))):null},Me=a(222),Ae=a(799),Pe=a(372),ze=function(e){function t(){return Object(b.a)(this,t),Object(v.a)(this,Object(k.a)(t).apply(this,arguments))}return Object(w.a)(t,e),Object(y.a)(t,[{key:"render",value:function(){var e=this.props;return(0,e.connectDragSource)((0,e.connectDropTarget)(e.children))}}]),t}(r.a.Component),Le=Object(Me.DropTarget)("DND_NODE",{drop:function(e,t){var a=t.getItem().index,n=e.index;a!==n&&(e.moveTabNode(a,n),t.getItem().index=n)}},function(e){return{connectDropTarget:e.dropTarget()}})(Object(Me.DragSource)("DND_NODE",{beginDrag:function(e){return{id:e.id,index:e.index}}},function(e,t){return{connectDragSource:e.dragSource(),isDragging:t.isDragging()}})(ze)),Re=function(e){function t(){var e,a;Object(b.a)(this,t);for(var n=arguments.length,l=new Array(n),c=0;c<n;c++)l[c]=arguments[c];return(a=Object(v.a)(this,(e=Object(k.a)(t)).call.apply(e,[this].concat(l)))).state={order:[]},a.moveTabNode=function(e,t){var n=a.state.order.slice(),l=a.props.children;r.a.Children.forEach(l,function(e){-1===n.indexOf(e.key)&&n.push(e.key)});var c=n.indexOf(e),i=n.indexOf(t);n.splice(c,1),n.splice(i,0,e),a.setState({order:n})},a.renderTabBar=function(e,t){return r.a.createElement(t,e,function(e){return r.a.createElement(Le,{key:e.key,index:e.key,moveTabNode:a.moveTabNode},e)})},a}return Object(w.a)(t,e),Object(y.a)(t,[{key:"render",value:function(){var e=this.state.order,t=this.props.children,a=[];r.a.Children.forEach(t,function(e){a.push(e)});var n=a.slice().sort(function(t,n){var r=e.indexOf(t.key),l=e.indexOf(n.key);return-1!==r&&-1!==l?r-l:-1!==r?-1:-1!==l?1:a.indexOf(t)-a.indexOf(n)});return r.a.createElement(Ae.a,{backend:Pe.a},r.a.createElement(le.a,Object.assign({renderTabBar:this.renderTabBar},this.props),n))}}]),t}(r.a.Component),Ge=function(e){var t=e.goal,a=e.deleteGoal,l=Object(n.useState)(t&&t.milestones||[{name:"Milestone 1",key:"mile1"}]),c=Object(p.a)(l,2),i=c[0],o=c[1],s=Object(n.useState)("mile1"),u=Object(p.a)(s,2),m=u[0],d=u[1],f=Object(n.useState)(t&&t.images.map(function(e,t){return{url:e,uid:t}})||[]),h=Object(p.a)(f,2),g=h[0],E=h[1],b=Object(n.useState)(t&&t.withMilestones),y=Object(p.a)(b,2),v=y[0],k=y[1],w=Object(n.useState)(""),O=Object(p.a)(w,2),j=O[0],I=O[1],C=Object(n.useState)(t&&t.newTabIndex||2),S=Object(p.a)(C,2),_=S[0],N=S[1],F=e.goalId||"",D=Object(n.useState)(t&&t.rewardsGroups||[]),A=Object(p.a)(D,2),P=A[0],z=A[1],L=function(){var e=Object(ne.a)(i),t="mile".concat(_);e.push({key:t,name:"New milestone"}),o(e),d(t),N(_+1)},R=function(e){var t,a=m;i.forEach(function(a,n){a.key===e&&(t=n-1)});var n=i.filter(function(t){return t.key!==e});n.length&&a===e&&(a=t>=0?n[t].key:n[0].key),o(n),d(a)},G=e.account.friendsData,B=r.a.createElement(fe.a,{mode:"multiple",style:{width:"100%"},placeholder:"Please select"},G.map(function(e){return r.a.createElement(fe.a.Option,{key:e._id},r.a.createElement(ve.a,{src:"https://websiter.s3.us-east-2.amazonaws.com/"+e._id+"/avatar",size:20,style:{marginRight:"10px"}}),e.name," - (",e._id,")")})),V=T.a.useForm(),W=Object(p.a)(V,1)[0];return!e.goalId||t?r.a.createElement(r.a.Fragment,null,r.a.createElement(T.a,Object.assign({form:W,name:"dynamic_form_nest_item",onFinish:function(t){var a=[],n=!0,r=!1,l=void 0;try{for(var c,o=i[Symbol.iterator]();!(n=(c=o.next()).done);n=!0){var s=c.value;a.push(Object(oe.a)({},t[s.key],{key:s.key,name:s.name}))}}catch(u){r=!0,l=u}finally{try{n||null==o.return||o.return()}finally{if(r)throw l}}e.onFinish(Object(oe.a)({},t,{images:g.map(function(e){return e.url}),milestones:i,milestonesValues:a,newTabIndex:_,rewardsGroups:P}))},autoComplete:"off",initialValues:t||{name:"New goal",mile1:{name:"Milestone 1",key:"mile1"}}},{labelCol:{span:8},wrapperCol:{span:16}},{onValuesChange:function(e){var t=function(t){var a=i.findIndex(function(e){return e.key===t});if(a>-1&&e[t].name){var n=Object(ne.a)(i);n[a]=Object(oe.a)({},n[a],{name:e[t].name}),o(n)}"withMilestones"===t&&k(e[t])};for(var a in e)t(a)}}),r.a.createElement(T.a.Item,{name:"images",label:"Images",valuePropName:"images",getValueFromEvent:function(e){return Array.isArray(e)?e:e&&e.fileList.map(function(e){return e.url})}},r.a.createElement(Ee.a,{listType:"picture-card",fileList:g.map(function(e,t){return Object(oe.a)({},e,{uid:t})}),onPreview:function(e){I(e.url)},onChange:function(e){var t=e.fileList;return E(t)},customRequest:function(e){var t=e.file;ke(t,800,void 0,function(e){E([].concat(Object(ne.a)(g),[{url:e}]).map(function(e,t){return Object(oe.a)({},e,{uid:t})}))})}},g.length>=8?null:r.a.createElement("div",null,r.a.createElement(ye.a,null),r.a.createElement("div",{className:"ant-upload-text"},"Upload")))),r.a.createElement(T.a.Item,{label:"Name",name:"name",rules:[{required:!0,message:"Please input the goal name."}]},r.a.createElement(M.a,null)),r.a.createElement(T.a.Item,{label:"Description",name:"description"},r.a.createElement(M.a.TextArea,{placeholder:"Write a few words about why this goal is important and how to achieve it."})),e.isGoal&&r.a.createElement(T.a.Item,{label:"Available for",name:"users"},B),r.a.createElement(T.a.Item,{label:"Experts",name:"experts"},B),r.a.createElement(T.a.Item,{label:"Supporters",name:"supporters"},B),r.a.createElement(Te,{rewardKey:"start",label:"Start rewards",rewards:P,setRewards:z}),r.a.createElement(Te,{rewardKey:"finish",label:"Finish rewards",rewards:P,setRewards:z}),r.a.createElement(T.a.Item,{label:"Milestones",name:"withMilestones",valuePropName:"checked"},r.a.createElement(he.a,null)),v&&r.a.createElement(r.a.Fragment,null,r.a.createElement(ge.a,null,"Milestones"),r.a.createElement(Re,{tabPosition:"left",type:"editable-card",onChange:function(e){d(e)},activeKey:m||"mile1",onEdit:function(e,t){"add"===t?L(e):R(e)}},i.map(function(e){return r.a.createElement(le.a.TabPane,{tab:e.name,key:e.key},r.a.createElement(T.a.Item,{label:"Name",name:[e.key,"name"],rules:[{required:!0,message:"Missing name"}]},r.a.createElement(M.a,null)),r.a.createElement(T.a.Item,{label:"Description",name:[e.key,"description"]},r.a.createElement(M.a.TextArea,{placeholder:"Write a few words about why this milestone is important and how to achieve it."})),r.a.createElement(Te,{rewardKey:e.key,label:"Rewards",rewards:P,setRewards:z}))}))),r.a.createElement(T.a.Item,{wrapperCol:{offset:8,span:16}},r.a.createElement(x.a,{type:"primary",htmlType:"submit",size:"large"},"Save"),F&&e.isGoal&&r.a.createElement(x.a,{type:"link",onClick:a,danger:!0,size:"large"},"Delete"))),r.a.createElement(pe.a,{visible:j,footer:null,onCancel:function(){return I("")}},r.a.createElement("img",{alt:"example",style:{width:"100%"},src:j}))):null},Be=function(e){var t=Object(n.useState)(),a=Object(p.a)(t,2),l=a[0],c=a[1],i=e.goalId;Object(n.useEffect)(function(){e.goalId&&s.a.get("/api/goals/".concat(e.nickname,"/").concat(e.goalId)).then(function(e){if(e.data.success){var t={},a=!0,n=!1,r=void 0;try{for(var l,i=e.data.goal.milestonesValues[Symbol.iterator]();!(a=(l=i.next()).done);a=!0){var o=l.value;t[o.key]=o}}catch(u){n=!0,r=u}finally{try{a||null==i.return||i.return()}finally{if(n)throw r}}var s=Object(oe.a)({},e.data.goal,t);c(s)}}).catch(function(e){})},[]);return!e.goalId||l?r.a.createElement(Ge,{goal:l,onFinish:function(t){s.a.post("/api/goals/add",{value:t,id:e.goalId}).then(function(t){e.setData(Object(oe.a)({},e.data,t.data)),e.setEditGoalOpen(!1)}).catch(function(e){})},deleteGoal:function(){i&&s.a.post("/api/goals/delete/"+i).then(function(t){e.setData(Object(oe.a)({},e.data,t.data))}).catch(function(e){}),e.setEditGoalOpen(!1)},account:e.account,isGoal:!0,goalId:i}):null},Ve=Object(E.a)(function(e){var t=e.goal,a=e.owner,n=e.available,l=e.account,c=e.setEditedGoal,i=e.setEditGoalOpen,o=e.setInviteGoal;return r.a.createElement(re.a,{type:"inner",style:{width:200,display:"inline-block"},hoverable:!0,cover:r.a.createElement("div",{onClick:function(){return e.history.push("/goals/"+a._id+"/"+t.goalId)},style:{backgroundImage:"url("+(t.images.length>0&&t.images[0])+")",height:200,width:200,backgroundSize:"cover"}}),actions:[r.a.createElement(r.a.Fragment,null,a._id===l._id&&c&&r.a.createElement(x.a,{key:"1",onClick:function(){c(t.goalId),i(!0)},icon:r.a.createElement(ie.a,null)},"Edit"),(n||a._id===l._id)&&r.a.createElement(x.a,{key:"2",onClick:function(){return e=t.goalId,n=a._id,r=l._id,void s.a.post("/api/progresses/add",{goalId:e,ownerId:n,userId:r}).then(function(e){}).catch(function(e){});var e,n,r},icon:r.a.createElement(ie.a,null)},"Start a progress"),a._id===l._id&&o&&r.a.createElement(x.a,{key:"3",onClick:function(){o(t)},icon:r.a.createElement(ie.a,null)},"Invite friends"))]},r.a.createElement(re.a.Meta,{title:t.name,description:t.description}))}),We=Object(E.a)(Ve),Ke=re.a.Meta,Ue=le.a.TabPane,qe=Object(E.a)(function(e){var t=Object(n.useState)({}),a=Object(p.a)(t,2),l=a[0],c=a[1],i=Object(n.useState)(""),o=Object(p.a)(i,2),s=o[0],u=o[1],m=Object(n.useState)(!1),d=Object(p.a)(m,2),f=d[0],h=d[1],g=Object(n.useState)(!1),E=Object(p.a)(g,2),b=E[0],y=E[1];Object(n.useEffect)(function(){de(e,l,c,{})},[]);var v=l.account,k=r.a.createElement(pe.a,{title:"Add goal",visible:f,maskClosable:!0,closable:!0,onCancel:function(){return h(!1)},width:"90%",footer:r.a.createElement(x.a,{key:"back",onClick:function(){return h(!1)}},"Close"),destroyOnClose:!0},r.a.createElement(Be,{account:v,setEditGoalOpen:h,setData:c,data:l,goalId:s,nickname:v&&v._id})),w=v&&r.a.createElement(pe.a,{title:"Invite friends to work on your goal",visible:b,maskClosable:!0,closable:!0,onCancel:function(){return y(!1)},footer:r.a.createElement(x.a,{key:"back",onClick:function(){return y(!1)}},"Close"),destroyOnClose:!0},v.friendsData.filter(function(e){return!(b.progresses&&b.progresses.find(function(t){return t.user===e._id}))}).map(function(t,a){return r.a.createElement("div",{key:a},r.a.createElement("span",{style:{cursor:"pointer"},onClick:function(){return e.history.push("/profile/"+t._id)}},r.a.createElement(ve.a,{src:"https://websiter.s3.us-east-2.amazonaws.com/"+t._id+"/avatar",size:20}),t.name," - (",t._id,")"),r.a.createElement(x.a,{onClick:function(){return startProgress(b.goalId,v._id,t._id)}},"Invite"))}));return v?r.a.createElement(r.a.Fragment,null,r.a.createElement(le.a,{defaultActiveKey:"1"},r.a.createElement(Ue,{tab:"My goals",key:"1"},r.a.createElement(re.a,{title:"Important goals for me and people I care"},r.a.createElement(re.a,{type:"inner",style:{width:200,display:"inline-block"},hoverable:!0,cover:r.a.createElement("div",{style:{height:200,width:200,backgroundSize:"cover",display:"flex",alignItems:"center",justifyContent:"center"}},r.a.createElement(ie.a,{style:{fontSize:"60px"}})),actions:[r.a.createElement(x.a,{key:"1",onClick:function(){u(""),h(!0)},icon:r.a.createElement(ie.a,null)},"Add goal")]},r.a.createElement(Ke,{title:"Add a goal",description:""})),v.goals&&v.goals.map(function(e,t){return r.a.createElement(We,{key:t,goal:e,owner:v,account:v,setEditedGoal:u,setEditGoalOpen:h,setInviteGoal:y})}))),r.a.createElement(Ue,{tab:"Available goals",key:"2"},r.a.createElement(re.a,{title:"Important goals that I can work on"},v.friendsData&&[v].concat(Object(ne.a)(v.friendsData)).map(function(e,t){return e.goals.map(function(a,n){return a.users.includes(v._id)||e._id===v._id?r.a.createElement(We,{key:t+"_"+n,goal:a,owner:e,available:a.users.includes(v._id),account:v,setEditedGoal:u,setEditGoalOpen:h,setInviteGoal:y}):null})}))),r.a.createElement(Ue,{tab:"My friends' goals",key:"3"},r.a.createElement(re.a,{title:"Important goals created by my friends"},v.friendsData&&v.friendsData.map(function(e,t){return e.goals.map(function(a,n){return r.a.createElement(We,{key:t+"_"+n,goal:a,owner:e,available:a.users.includes(v._id),account:v,setEditedGoal:u,setEditGoalOpen:h,setInviteGoal:y})})})))),k,w):null}),He=a(36),Je=a(37),Ye=Je.a.Item,Ze=Object(E.a)(function(e){var t=Object(n.useState)(""),a=Object(p.a)(t,2),l=a[0],c=a[1],i=Object(n.useState)(),o=Object(p.a)(i,2),s=o[0],u=o[1],m=e.goal.rewardsGroups.find(function(t){return t.key===e.groupKey});return console.log(m),m?r.a.createElement(r.a.Fragment,null,r.a.createElement("ol",null,m.rewards.map(function(e,t){return r.a.createElement("li",{key:t},r.a.createElement(x.a,{type:"link",onClick:function(){return u(e)}},"simple"===e.mode?e.simple:"money"===e.mode?e.money:"item"===e.mode?e.itemName:""))})),r.a.createElement(pe.a,{visible:s,footer:null,onCancel:function(){return u()},title:"Reward details"},s?r.a.createElement(r.a.Fragment,null,s.itemImages&&s.itemImages.map(function(e,t){return r.a.createElement("span",{key:t,onClick:function(){return c(e)}},r.a.createElement(re.a,{type:"inner",style:{width:200,display:"inline-block"},hoverable:!0,cover:r.a.createElement("div",{style:{backgroundImage:"url("+e+")",height:200,width:200,backgroundSize:"cover"}})}))}),r.a.createElement(Je.a,{title:"Reward description",bordered:!0,column:{xxl:4,xl:3,lg:3,md:3,sm:2,xs:1}},"item"===s.mode&&r.a.createElement(Ye,{label:"Name"},s.itemName),"item"===s.mode&&r.a.createElement(Ye,{label:"Description"},s.itemDescription),"simple"===s.mode&&r.a.createElement(Ye,{label:"Description"},s.simple),"money"===s.mode&&r.a.createElement(Ye,{label:"Money"},s.money))):null),r.a.createElement(pe.a,{visible:l,footer:null,onCancel:function(){return c("")}},r.a.createElement("img",{alt:"example",style:{width:"100%"},src:l}))):null}),$e=Je.a.Item,Qe=Object(E.a)(function(e){var t=Object(n.useState)({}),a=Object(p.a)(t,2),l=a[0],c=a[1],i=Object(n.useState)(""),o=Object(p.a)(i,2),s=o[0],u=o[1];Object(n.useEffect)(function(){de(e,l,c,{})},[]);var m,d=l.goal,f=l.profile;return d?r.a.createElement(r.a.Fragment,null,r.a.createElement(He.a,{className:"site-page-header",title:d.name,backIcon:!1}),d.images.map(function(e,t){return r.a.createElement("span",{key:t,onClick:function(){return u(e)}},r.a.createElement(re.a,{type:"inner",style:{width:200,display:"inline-block"},hoverable:!0,cover:r.a.createElement("div",{style:{backgroundImage:"url("+e+")",height:200,width:200,backgroundSize:"cover"}})}))}),r.a.createElement("p",null,d.description),r.a.createElement(Je.a,{title:"Goal description",bordered:!0,column:{xxl:4,xl:3,lg:3,md:3,sm:2,xs:1}},r.a.createElement($e,{label:"Users"},(m=d.users,f&&f.friendsData?m.map(function(t,a){var n=f.friendsData.find(function(e){return e._id===t});return n?r.a.createElement("span",{key:a,style:{cursor:"pointer"},onClick:function(){return e.history.push("/profile/"+t)}},r.a.createElement(ve.a,{src:"https://websiter.s3.us-east-2.amazonaws.com/"+t+"/avatar",size:20,style:{marginRight:"10px"}}),n.name," - (",t,")"):t}):m)),r.a.createElement($e,{label:"Supporters"},d.supporters),r.a.createElement($e,{label:"Experts"},d.experts),r.a.createElement($e,{label:"Start reward"},r.a.createElement(Ze,{groupKey:"start",goal:d})),r.a.createElement($e,{label:"Finish reward"},r.a.createElement(Ze,{groupKey:"finish",goal:d})),r.a.createElement($e,{label:"Total price"},d.totalPrice),r.a.createElement($e,{label:"With milestones"},d.withMilestones?"Yes":"No")),d.withMilestones&&r.a.createElement(r.a.Fragment,null,r.a.createElement(ge.a,null,"Milestones"),r.a.createElement(le.a,{tabPosition:"left"},d.milestones.map(function(e){return r.a.createElement(le.a.TabPane,{tab:e.name,key:e.key},r.a.createElement("h2",null,e.name),r.a.createElement("p",null,e.description),r.a.createElement(Je.a,{title:"Milestone description",bordered:!0,column:{xxl:4,xl:3,lg:3,md:3,sm:2,xs:1}},r.a.createElement($e,{label:"Rewards"},r.a.createElement(Ze,{groupKey:e.key,goal:d}))))})),r.a.createElement(pe.a,{visible:s,footer:null,onCancel:function(){return u("")}},r.a.createElement("img",{alt:"example",style:{width:"100%"},src:s})))):null}),Xe=re.a.Meta,et=le.a.TabPane,tt=Object(E.a)(function(e){var t=Object(n.useState)(e.progressesData&&e.account?Object(oe.a)({},e):{}),a=Object(p.a)(t,2),l=a[0],c=a[1];Object(n.useEffect)(function(){e.progressesData&&e.account||de(e,l,c,{})},[]);var i=l.account,o=l.progressesData,s=Object(E.a)(function(e){var t=e.progress,a=t.goal;return r.a.createElement(re.a,{type:"inner",style:{width:200,display:"inline-block"},hoverable:!0,cover:r.a.createElement("div",{onClick:function(){return e.history.push("/progresses/"+t._id)},style:{backgroundImage:a&&"url("+(a.images.length>0&&a.images[0])+")",height:200,width:200,backgroundSize:"cover"}})},a&&r.a.createElement(r.a.Fragment,null,r.a.createElement(Xe,{title:a.name}),r.a.createElement(Xe,{title:"Made by "+t.worker,description:"In goal by "+t.owner})))});return i?r.a.createElement(r.a.Fragment,null,r.a.createElement(le.a,{defaultActiveKey:"1"},r.a.createElement(et,{tab:"All roles",key:"1"},r.a.createElement(re.a,{title:"All progresses where I have a role"},o&&o.map(function(e,t){return r.a.createElement(s,{key:t,progress:e})}))),r.a.createElement(et,{tab:"Achiever",key:"2"},r.a.createElement(re.a,{title:"All progresses where I am achieving goals"},o&&o.filter(function(e){return e.worker===i._id}).map(function(e,t){return r.a.createElement(s,{key:t,progress:e})}))),r.a.createElement(et,{tab:"Motivator",key:"3"},r.a.createElement(re.a,{title:"All progresses where I motivate friends to achieve goals"},o&&o.filter(function(e){return e.owner===i._id}).map(function(e,t){return r.a.createElement(s,{key:t,progress:e})}))),r.a.createElement(et,{tab:"Expert",key:"4"},r.a.createElement(re.a,{title:"All progresses where I check and approve progresses"},o&&o.filter(function(e){return e.goal&&(e.goal.experts.includes(i._id)||e.goal.milestonesValues.find(function(e){return e.experts.includes(i._id)}))}).map(function(e,t){return r.a.createElement(s,{key:t,progress:e})}))),r.a.createElement(et,{tab:"Supporter",key:"5"},r.a.createElement(re.a,{title:"All progresses where I support friend to achieve goals"},o&&o.filter(function(e){return e.goal&&(e.goal.supporters.includes(i._id)||e.goal.milestonesValues.find(function(e){return e.supporters.includes(i._id)}))}).map(function(e,t){return r.a.createElement(s,{key:t,progress:e})}))))):null}),at=a(371),nt=a(170),rt=a(362),lt=a.n(rt),ct=a(767).create({propertyFilter:function(e,t){return"patch"!==e}}),it=!1,ot=function(e){function t(){var e,a;Object(b.a)(this,t);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(a=Object(v.a)(this,(e=Object(k.a)(t)).call.apply(e,[this].concat(r)))).start=function(){var e;it=new WebSocket("wss://getreward.herokuapp.com");var t=function(){clearTimeout(e),e=setTimeout(function(){it.close()},31e3),it.send(JSON.stringify({messageCode:"heartbeat"}))};it.onopen=function(e){it.send(JSON.stringify({messageCode:"auth",user:s.a.defaults.headers.common["x-auth-token"],progressId:a.props.data.progress._id})),t()},it.onmessage=function(e){var n=JSON.parse(e.data);switch(n.messageCode){case"heartbeat":t();break;case"logout":a.props.logout();break;case"messageSaved":a.props.setState(Object(oe.a)({},a.props.state,{messageValue:""}));break;case"friendsData":a.props.setData(Object(oe.a)({},a.props.data,{account:Object(oe.a)({},a.props.data.account,{friendsData:n.friendsData})}));break;case"redirectToProgresses":a.props.history.push("/progresses");break;case"update":var r;a.props.data.progress.__v===n.progress.__v-1&&((r=ct.patch(a.props.data.progress,n.progress.patch)).__v=n.progress.__v,a.props.setData(Object(oe.a)({},a.props.data,{progress:r})),console.log("HURRAY")),mt(r||a.props.data.progress,a.props.data.account.friends);break;case"error":alert(n.text)}},it.onclose=function(t){clearTimeout(e)}},a.checkInterval=null,a.check=function(){it&&3!==it.readyState||a.start()},a}return Object(w.a)(t,e),Object(y.a)(t,[{key:"componentWillMount",value:function(){this.checkInterval=setInterval(this.check,5e3)}},{key:"componentWillUnmount",value:function(){clearInterval(this.checkInterval),it&&it.close()}},{key:"render",value:function(){return r.a.createElement("span",null)}}]),t}(n.Component),st=Object(E.a)(ot),ut=function(e,t,a){it&&3!==it.readyState&&it.send(JSON.stringify({messageCode:"sendMessage",messageValue:e.messageValue,editedMessage:e.editedMessage,replyToMessage:e.replyToMessage,imageUrl:a,progressId:t.progress._id,accountId:t.account._id}))},mt=function(e,t){if(it&&3!==it.readyState&&e){var a=[e.owner,e.worker].concat(Object(ne.a)(e.goal.supporters),Object(ne.a)(e.goal.experts),Object(ne.a)(t));a=Object(ne.a)(new Set(a)),it.send(JSON.stringify({messageCode:"getFriendsData",accountIds:a}))}},dt=a(66),pt=a(174),ft=a(358),ht=a.n(ft),gt=a(359),Et=a.n(gt),bt=a(360),yt=a.n(bt),vt=a(361),kt=a.n(vt),wt=Object(E.a)(function(e){var t=e.data,a=e.state,n=e.setState,l=e.message,c=t.account,i=function(e,a){console.log("jjjjj"),function(e,t,a){it&&3!==it.readyState&&it.send(JSON.stringify({messageCode:t,messageId:a,progressId:e.progress._id,accountId:e.account._id}))}(t,e,a)};return r.a.createElement(nt.a,{actions:[r.a.createElement("span",{key:"comment-basic-like"},r.a.createElement(dt.a,{title:"Like"},l.likes.includes(c._id)?r.a.createElement(ht.a,{onClick:function(){return i("removeLikeMessage",l.messageId)}}):r.a.createElement(Et.a,{onClick:function(){return i("likeMessage",l.messageId)}})),r.a.createElement("span",{style:{paddingLeft:"8px"}},l.likes.length)),r.a.createElement("span",{key:"comment-basic-dislike"},r.a.createElement(dt.a,{title:"Dislike"},l.dislikes.includes(c._id)?r.a.createElement(yt.a,{onClick:function(){return i("removeDislikeMessage",l.messageId)}}):r.a.createElement(kt.a,{onClick:function(){return i("dislikeMessage",l.messageId)}})),r.a.createElement("span",{style:{paddingLeft:"8px"}},l.dislikes.length)),r.a.createElement("span",{key:"comment-basic-reply-to",onClick:function(){n(Object(oe.a)({},a,{replyToMessage:l.messageId,editedMessage:""}))}},"Reply to"),r.a.createElement("span",{key:"comment-basic-reply-to",onClick:function(){n(Object(oe.a)({},a,{messageValue:l.text,editedMessage:l.messageId,replyToMessage:""}))}},"Edit")],author:r.a.createElement("a",null,c.friendsData.find(function(e){return e._id===l.author}).name+" ("+l.author+")"),avatar:r.a.createElement(ve.a,{src:"https://websiter.s3.us-east-2.amazonaws.com/"+l.author+"/avatar"}),content:"message"===l.action?r.a.createElement("p",null,l.text):"image"===l.action?r.a.createElement("div",{style:{backgroundImage:"url("+l.text+")",width:"200px",height:"200px",backgroundSize:"cover",cursor:"pointer"},onClick:function(){return n(Object(oe.a)({},a,{previewImage:l.text}))}}):null,datetime:r.a.createElement("span",null,r.a.createElement(pt.a,{datetime:l.date,live:!0}))},e.children)}),Ot=Object(E.a)(function(e){var t=Object(n.useState)(!1),a=Object(p.a)(t,2),l=a[0],c=a[1],i=e.data,o=e.state,s=e.setState,u=i.progress,m=i.account,d=u.goal,f=Object(n.useRef)(null);Object(n.useEffect)(function(){f&&f.current&&f.current.scrollIntoView({behavior:"smooth"})},[e.data.progress.messages.length]);return d?r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:{flex:1,overflow:"hidden",display:"flex",flexDirection:"column"}},r.a.createElement("div",{style:{flex:1,overflow:"auto"}},function e(t){return t&&t.length?[].concat(Object(ne.a)(t.map(function(t,a){return r.a.createElement(wt,{key:a,message:t,data:i,state:o,setState:s},e(t.replies))})),[r.a.createElement("div",{key:"-1",ref:f})]):null}(u.messages)),r.a.createElement("div",null,r.a.createElement(nt.a,{avatar:r.a.createElement(ve.a,{src:"https://websiter.s3.us-east-2.amazonaws.com/"+m._id+"/avatar"}),content:r.a.createElement(r.a.Fragment,null,o.editedMessage&&r.a.createElement(r.a.Fragment,null,r.a.createElement("span",null,"Editing message"),r.a.createElement("span",{style:{cursor:"pointer"},onClick:function(){s(Object(oe.a)({},o,{replyToMessage:"",editedMessage:"",messageValue:""}))}},"Cancel editing")),o.replyToMessage&&r.a.createElement(r.a.Fragment,null,r.a.createElement("span",null,"Commenting message"),r.a.createElement("span",{style:{cursor:"pointer"},onClick:function(){s(Object(oe.a)({},o,{replyToMessage:"",editedMessage:""}))}},"Cancel commenting")),r.a.createElement(T.a.Item,null,r.a.createElement(M.a.TextArea,{autoSize:{minRows:4,maxRows:8},rows:4,onChange:function(e){return s(Object(oe.a)({},o,{messageValue:e.target.value}))},value:o.messageValue})),r.a.createElement(T.a.Item,null,r.a.createElement(x.a,{htmlType:"submit",onClick:function(){return ut(o,i)},type:"primary"},"Send message"),r.a.createElement(Ee.a,{showUploadList:!1,customRequest:function(e){var t=e.file;c(!0),ke(t,800,void 0,function(e){c(!1),ut(o,i,e)})}},r.a.createElement(x.a,{style:{marginLeft:"20px"}},l?r.a.createElement(r.a.Fragment,null,r.a.createElement(lt.a,null)," Loading"):r.a.createElement(r.a.Fragment,null,r.a.createElement(ye.a,null)," Add a photo")))))})))):null}),jt=a(172),It=Je.a.Item,Ct=function(e){var t=e.data,a=e.state,n=e.setState,l=t.progress,c=(t.account,l.goal),i=function(e){var a=e.checked,n=e.milestoneId;return r.a.createElement(I.a,{checked:a,onChange:function(e){return function(e,t,a){it&&3!==it.readyState&&it.send(JSON.stringify({messageCode:"changeStage",milestoneId:a,value:t,progressId:e.progress._id,accountId:e.account._id}))}(t,e.target.checked,n)}})},o=[{title:"Milestone",dataIndex:"name",key:"name",render:function(e){return r.a.createElement(x.a,{type:"link",onClick:function(){return n(Object(oe.a)({},a,{previewMilestone:e}))}},e.name)}},{title:"Price",dataIndex:"price",key:"price"},{title:"Status",dataIndex:"status",key:"status",render:function(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",null,e?"Paid:":"Not finished"),e&&r.a.createElement(Ze,{goal:{rewardsGroups:[{rewards:e,key:1}]},groupKey:1}))}},{title:"Worker",dataIndex:"worker",key:"worker",render:i},{title:"Owner",dataIndex:"owner",key:"owner",render:i}].concat(Object(ne.a)(c.experts.map(function(e){return{title:e,dataIndex:e,key:e,render:i}}))),s=function(e,t,a){return{checked:t.approvedBy.find(function(t){return t.accountId===e}),milestoneId:a.key}},u=l.stages.find(function(e){return"start"===e.milestoneId})||{approvedBy:[]},m={},d=!0,p=!1,f=void 0;try{for(var h,g=c.experts[Symbol.iterator]();!(d=(h=g.next()).done);d=!0){var E=h.value;m[E]=s(E,u,{key:"start"})}}catch(F){p=!0,f=F}finally{try{d||null==g.return||g.return()}finally{if(p)throw f}}var b=Object(oe.a)({key:"start",name:{name:"Start",description:"At this stage owner and user should agree to start this progress.",key:"start"},price:l.startPrice,status:u.paid,worker:s(l.worker,u,{key:"start"}),owner:s(l.owner,u,{key:"start"})},m),y=l.stages.find(function(e){return"finish"===e.milestoneId})||{approvedBy:[]},v={},k=!0,w=!1,O=void 0;try{for(var j,C=c.experts[Symbol.iterator]();!(k=(j=C.next()).done);k=!0){var S=j.value;v[S]=s(S,y,{key:"finish"})}}catch(F){w=!0,O=F}finally{try{k||null==C.return||C.return()}finally{if(w)throw O}}var _=Object(oe.a)({key:"finish",name:{name:"Finish",description:"At this stage owner and user should agree to finish this progress.",key:"finish"},price:l.price,status:y.paid,worker:s(l.worker,y,{key:"finish"}),owner:s(l.owner,y,{key:"finish"})},v),N=[b].concat(Object(ne.a)(c.milestonesValues.map(function(e,t){var a=l.stages.find(function(t){return t.milestoneId===e.key})||{approvedBy:[]},n={},r=!0,i=!1,o=void 0;try{for(var u,m=c.experts[Symbol.iterator]();!(r=(u=m.next()).done);r=!0){var d=u.value;n[d]=s(d,a,e)}}catch(F){i=!0,o=F}finally{try{r||null==m.return||m.return()}finally{if(i)throw o}}return console.log(e),Object(oe.a)({key:t,name:e,price:e.price,status:a.paid,worker:s(l.worker,a,e),owner:s(l.owner,a,e)},n)})),[_]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(jt.a,{columns:o,dataSource:N}),r.a.createElement(pe.a,{visible:a.previewMilestone,footer:null,onCancel:function(){return n(Object(oe.a)({},a,{previewMilestone:""}))},closable:!0},a.previewMilestone?r.a.createElement(r.a.Fragment,null,r.a.createElement("h2",null,a.previewMilestone.name),r.a.createElement("p",null,a.previewMilestone.description),r.a.createElement(Je.a,{title:"Milestone description",bordered:!0,column:{xxl:4,xl:3,lg:3,md:3,sm:2,xs:1}},r.a.createElement(It,{label:"Rewards"},r.a.createElement(Ze,{groupKey:a.previewMilestone.key,goal:c})))):null))},xt=function(e){var t=e.data,a=e.state,n=e.setState,l=t.progress,c={},i=!0,o=!1,s=void 0;try{for(var u,m=l.goal.milestonesValues[Symbol.iterator]();!(i=(u=m.next()).done);i=!0){var d=u.value;c[d.key]=d}}catch(f){o=!0,s=f}finally{try{i||null==m.return||m.return()}finally{if(o)throw s}}var p=Object(oe.a)({},l.goal,c);return p?r.a.createElement(Ge,{goal:p,onFinish:function(e){!function(e,t){it&&3!==it.readyState&&it.send(JSON.stringify({messageCode:"editGoalInProgress",progressId:e.progress._id,accountId:e.account._id,value:t}))}(t,e),n(Object(oe.a)({},a,{editProgressOpen:!1}))},account:t.account}):null},St=Je.a.Item,_t=Object(E.a)(function(e){var t=e.data,a=e.state,n=e.setState,l=t.progress,c=(t.account,l.goal);return c?r.a.createElement(r.a.Fragment,null,r.a.createElement(He.a,{className:"site-page-header",title:c.name,backIcon:!1}),r.a.createElement(x.a,{type:"primary",onClick:function(){n(Object(oe.a)({},a,{editProgressOpen:!0}))}},"Edit progress"),c.images.map(function(e,t){return r.a.createElement("span",{key:t,onClick:function(){return n(Object(oe.a)({},a,{previewImage:e}))}},r.a.createElement(re.a,{type:"inner",style:{width:200,display:"inline-block"},hoverable:!0,cover:r.a.createElement("div",{style:{backgroundImage:"url("+e+")",height:200,width:200,backgroundSize:"cover"}})}))}),r.a.createElement("p",null,c.description),r.a.createElement(Je.a,{title:"Goal description",bordered:!0,column:{xxl:4,xl:3,lg:3,md:3,sm:2,xs:1}},r.a.createElement(St,{label:"Status"},l.status),r.a.createElement(St,{label:"Worker"},l.worker),r.a.createElement(St,{label:"Owner"},l.owner),r.a.createElement(St,{label:"Supporters"},c.supporters),r.a.createElement(St,{label:"Experts"},c.experts),r.a.createElement(St,{label:"Start reward"},r.a.createElement(Ze,{groupKey:"start",goal:c})),r.a.createElement(St,{label:"Finish reward"},r.a.createElement(Ze,{groupKey:"finish",goal:c})),r.a.createElement(St,{label:"With milestones"},c.withMilestones?"Yes":"No")),r.a.createElement(ge.a,{orientation:"center",type:"horizontal"},"Milestones"),r.a.createElement(Ct,{data:t,state:a,setState:n}),r.a.createElement(x.a,{danger:!0,onClick:function(){!function(e){it&&3!==it.readyState&&it.send(JSON.stringify({messageCode:"leaveProgress",progressId:e.progress._id,accountId:e.account._id}))}(t)}},"Leave the progress"),r.a.createElement(pe.a,{visible:a.editProgressOpen,footer:null,onCancel:function(){return n(Object(oe.a)({},a,{editProgressOpen:!1}))},closable:!0,destroyOnClose:!0},r.a.createElement(xt,{data:t,state:a,setState:n}))):null}),Nt=(re.a.Meta,Je.a.Item,Object(E.a)(function(e){var t=Object(n.useState)({}),a=Object(p.a)(t,2),l=a[0],c=a[1],i=Object(n.useState)({}),o=Object(p.a)(i,2),s=o[0],u=o[1];Object(n.useEffect)(function(){de(e,l,c,{})},[]);var m=l.progress,d=l.account;l.profile;if(!m)return null;var f=m.goal;return f?r.a.createElement(r.a.Fragment,null,d&&r.a.createElement(st,{data:l,setData:c,state:s,setState:u}),r.a.createElement("div",{style:{height:"100%",flexDirection:"column",overflow:"hidden",display:"flex"}},r.a.createElement(He.a,{className:"site-page-header",title:f.name,backIcon:!1}),r.a.createElement("div",null,r.a.createElement(x.a,{type:"primary",onClick:function(){return u(Object(oe.a)({},s,{activityOpen:!0}))}},"Show activity and settings")),r.a.createElement(Ot,{data:l,setData:c,state:s,setState:u}),r.a.createElement(at.a,{title:"Activity",placement:"right",closable:!0,onClose:function(){return u(Object(oe.a)({},s,{activityOpen:!1}))},visible:s.activityOpen,width:"90%"},r.a.createElement(_t,{data:l,setData:c,state:s,setState:u})),r.a.createElement(pe.a,{visible:s.previewImage,footer:null,onCancel:function(){return u(Object(oe.a)({},s,{previewImage:""}))}},r.a.createElement("img",{alt:"example",style:{width:"100%"},src:s.previewImage})))):null})),Ft=re.a.Meta,Dt=Object(E.a)(function(e){return r.a.createElement(re.a,{title:"Your wallet with all money that you have"},e.data.account.wallet&&e.data.account.wallet.map(function(t,a){return r.a.createElement(re.a,{key:a,type:"inner",style:{width:200,display:"inline-block"},cover:r.a.createElement("span",{onClick:function(){return e.history.push("/progile/"+t.user)}},r.a.createElement(ve.a,{src:"https://websiter.s3.us-east-2.amazonaws.com/"+t.user+"/avatar",size:100})),hoverable:!0,actions:[r.a.createElement(x.a,{key:"1",onClick:function(){e.history.push("/progile/"+t.user)},icon:r.a.createElement(ie.a,null)},"Go to the shop")]},r.a.createElement(Ft,{title:t.amount,description:t.user}))}))}),Tt=a(374),Mt=Object(E.a)(function(e){var t=e.data.account;if(!t)return null;var a=t.transactionsData,n=(t.friendsData,[{title:"Type",dataIndex:"types",key:"types",render:function(e){return r.a.createElement(r.a.Fragment,null,e.map(function(e){var t=e.length>5?"geekblue":"green";return"loser"===e&&(t="volcano"),r.a.createElement(Tt.a,{color:t,key:e},e.toUpperCase())}))}},{title:"With",dataIndex:"user",key:"user"},{title:"Item",dataIndex:"perk",key:"perk",render:function(e){return console.log(e),e.simple?e.simple:r.a.createElement(Ze,{goal:{rewardsGroups:[{rewards:[e],key:1}]},groupKey:1})}},{title:"Amount",dataIndex:"amount",key:"amount",render:function(e){return e>0?e:""}},{title:"Date",dataIndex:"date",key:"date",render:function(e){return r.a.createElement(pt.a,{datetime:e,live:!0})}},{title:"Progress",dataIndex:"progress",key:"progress",render:function(t){return r.a.createElement(x.a,{type:"link",onClick:function(){return e.history.push("/progresses/"+t)}},t)}},{title:"Status",key:"status",dataIndex:"status",render:function(a,n){return"Not confirmed"===a?r.a.createElement(r.a.Fragment,null,r.a.createElement(x.a,{danger:!0,type:"link",onClick:function(){return t=n.transaction._id,void s.a.post("/api/shop/cancel",{transactionId:t}).then(function(t){t.data.success&&e.setData(Object(oe.a)({},e.data,t.data))}).catch(function(e){});var t}},"Cancel"),n.transaction.from===t._id&&r.a.createElement(x.a,{type:"link",onClick:function(){return t=n.transaction._id,void s.a.post("/api/shop/confirm",{transactionId:t}).then(function(t){t.data.success&&e.setData(Object(oe.a)({},e.data,t.data))}).catch(function(e){});var t}},"Confirm")):a}}]),l=[],c=Object(ne.a)(a);c=c.sort(function(e,t){return new Date(e.date).getTime()<new Date(t.date).getTime()?1:-1});var i=!0,o=!1,u=void 0;try{for(var m,d=c[Symbol.iterator]();!(i=(m=d.next()).done);i=!0){var p=m.value,f=[];p.from===t._id&&p.to===t.id&&f.push("internal"),p.to===t._id?p.progress?(f.push("earn"),p.amount?f.push("money"):f.push("item")):p.item&&p.amount?(f.push("buy"),f.push("item")):(f.push("recieve gift"),p.amount?f.push("money"):f.push("item")):p.from===t._id&&(p.progress?(f.push("pay"),p.amount?f.push("money"):f.push("item")):p.item&&p.amount?(f.push("sell"),f.push("item")):(f.push("send gift"),p.amount?f.push("money"):f.push("item")));var h=p.to!==t._id?p.to:p.from;l.push({key:l.length,types:f,user:h,perk:p.item,amount:p.amount,date:p.date,progress:p.progress,status:p.status,transaction:p})}}catch(g){o=!0,u=g}finally{try{i||null==d.return||d.return()}finally{if(o)throw u}}return console.log(t),r.a.createElement(jt.a,{columns:n,dataSource:l})}),At=function(e){var t=Object(n.useState)(),a=Object(p.a)(t,2),l=a[0],c=a[1],i=Object(n.useState)(""),o=Object(p.a)(i,2),u=o[0],m=o[1],d=Object(n.useState)([]),f=Object(p.a)(d,2),h=f[0],g=f[1],E=e.perkId||"";Object(n.useEffect)(function(){E&&s.a.get("/api/".concat(e.mode||"shop","/").concat(e.nickname,"/").concat(E)).then(function(e){e.data.success&&(c(e.data.perk),g(e.data.perk.images.map(function(e,t){return{url:e,uid:t}})))}).catch(function(e){})},[]);var b=e.account.friendsData||[],y=r.a.createElement(fe.a,{mode:"multiple",style:{width:"100%"},placeholder:"Please select"},b.map(function(e){return r.a.createElement(fe.a.Option,{key:e._id},r.a.createElement(ve.a,{src:"https://websiter.s3.us-east-2.amazonaws.com/"+e._id+"/avatar",size:20,style:{marginRight:"10px"}}),e.name," - (",e._id,")")})),v=T.a.useForm(),k=Object(p.a)(v,1)[0];return!e.perkId||l?r.a.createElement(r.a.Fragment,null,r.a.createElement(T.a,Object.assign({form:k,name:"dynamic_form_nest_item",onFinish:function(t){s.a.post("/api/".concat(e.mode||"shop","/add"),{value:Object(oe.a)({},t,{images:h.map(function(e){return e.url})}),id:e.perkId}).then(function(t){e.setData(Object(oe.a)({},e.data,t.data)),e.setEditPerkOpen(!1)}).catch(function(e){})},autoComplete:"off",initialValues:l||{name:"New item"}},{labelCol:{span:8},wrapperCol:{span:16}}),r.a.createElement(T.a.Item,{name:"images",label:"Images",valuePropName:"images",getValueFromEvent:function(e){return Array.isArray(e)?e:e&&e.fileList.map(function(e){return e.url})}},r.a.createElement(Ee.a,{listType:"picture-card",fileList:h.map(function(e,t){return Object(oe.a)({},e,{uid:t})}),onPreview:function(e){m(e.url)},onChange:function(e){var t=e.fileList;return g(t)},customRequest:function(e){var t=e.file;ke(t,800,void 0,function(e){g([].concat(Object(ne.a)(h),[{url:e}]).map(function(e,t){return Object(oe.a)({},e,{uid:t})}))})}},h.length>=8?null:r.a.createElement("div",null,r.a.createElement(ye.a,null),r.a.createElement("div",{className:"ant-upload-text"},"Upload")))),r.a.createElement(T.a.Item,{label:"Name",name:"name",rules:[{required:!0,message:"Please input the item name."}]},r.a.createElement(M.a,null)),r.a.createElement(T.a.Item,{label:"Description",name:"description"},r.a.createElement(M.a.TextArea,{placeholder:"Write a few words about why this item."})),"shop"===e.mode&&r.a.createElement(T.a.Item,{label:"Available for",name:"users"},y),"shop"===e.mode&&r.a.createElement(T.a.Item,{label:"Price",name:"price"},r.a.createElement(Se.a,null)),r.a.createElement(T.a.Item,{wrapperCol:{offset:8,span:16}},r.a.createElement(x.a,{type:"primary",htmlType:"submit",size:"large"},"Save"),E&&r.a.createElement(x.a,{type:"link",onClick:function(){E&&s.a.post("/api/".concat(e.mode||"shop","/delete/").concat(E)).then(function(t){e.setData(Object(oe.a)({},e.data,t.data))}).catch(function(e){}),e.setEditPerkOpen(!1)},danger:!0,size:"large"},"Delete"))),r.a.createElement(pe.a,{visible:u,footer:null,onCancel:function(){return m("")}},r.a.createElement("img",{alt:"example",style:{width:"100%"},src:u}))):null},Pt=re.a.Meta,zt=Object(E.a)(function(e){var t=e.perk,a=e.owner,n=e.account,l=e.setEditedPerk,c=e.setEditPerkOpen;return r.a.createElement(re.a,{type:"inner",style:{width:200,display:"inline-block"},hoverable:!0,cover:r.a.createElement("div",{onClick:function(){return e.history.push("/shop/"+a._id+"/"+t.perkId)},style:{backgroundImage:"url("+(t.images.length>0&&t.images[0])+")",height:200,width:200,backgroundSize:"cover"}}),actions:[r.a.createElement(r.a.Fragment,null,a._id===n._id&&!e.onlyBuy&&r.a.createElement(x.a,{key:"1",onClick:function(){l(t.perkId),c(!0)},icon:r.a.createElement(ie.a,null)},"Edit"),"shop"===e.mode&&r.a.createElement(x.a,{key:"1",onClick:function(){!function(){var r=n.wallet.find(function(e){return e.user===a._id});r&&r.amount>=t.price?s.a.post("/api/shop/buy",{perkId:t.perkId,ownerId:a._id}).then(function(t){t.data.success&&e.setData(Object(oe.a)({},e.data,t.data))}).catch(function(e){}):alert("You cannot buy this item as you do not have enough money from this user.")}()},icon:r.a.createElement(ie.a,null)},"Buy"))]},r.a.createElement(Pt,{title:t.name,description:t.price}))}),Lt=re.a.Meta,Rt=(le.a.TabPane,Object(E.a)(function(e){var t=Object(n.useState)(""),a=Object(p.a)(t,2),l=a[0],c=a[1],i=Object(n.useState)(),o=Object(p.a)(i,2),s=o[0],u=o[1],m=e.data,d=e.setData,f=m.account,h=r.a.createElement(pe.a,{title:"Add item",visible:s,maskClosable:!0,closable:!0,onCancel:function(){return u(!1)},width:"90%",footer:r.a.createElement(x.a,{key:"back",onClick:function(){return u(!1)}},"Close"),destroyOnClose:!0},r.a.createElement(At,{account:f,setEditPerkOpen:u,setData:d,data:m,perkId:l,nickname:f&&f._id,mode:e.mode}));return r.a.createElement(re.a,{title:"Nice things that you can do or give people that you care"},r.a.createElement(re.a,{type:"inner",style:{width:200,display:"inline-block"},hoverable:!0,cover:r.a.createElement("div",{style:{height:200,width:200,backgroundSize:"cover",display:"flex",alignItems:"center",justifyContent:"center"}},r.a.createElement(ie.a,{style:{fontSize:"60px"}})),actions:[r.a.createElement(x.a,{key:"1",onClick:function(){c(""),u(!0)},icon:r.a.createElement(ie.a,null)},"Add item")]},r.a.createElement(Lt,{title:"Add an item",description:""})),f[e.listKey||e.mode]&&f[e.listKey||e.mode].map(function(t,a){return r.a.createElement(zt,{key:a,perk:t,owner:f,account:f,setEditedPerk:c,setEditPerkOpen:u,mode:e.mode})}),h)})),Gt=Object(E.a)(function(e){var t=Object(n.useState)({}),a=Object(p.a)(t,2),l=a[0],c=a[1];return Object(n.useEffect)(function(){function t(){return(t=Object(d.a)(m.a.mark(function t(){return m.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,de(e,l,c,{});case 2:case"end":return t.stop()}},t)}))).apply(this,arguments)}!function(){t.apply(this,arguments)}()},[]),l.account?r.a.createElement(le.a,null,r.a.createElement(le.a.TabPane,{tab:"My shop",key:1},r.a.createElement(Rt,{data:l,setData:c,mode:"shop",listKey:"perks"})),r.a.createElement(le.a.TabPane,{tab:"Wallet",key:3},r.a.createElement(Dt,{data:l})),r.a.createElement(le.a.TabPane,{tab:"Transactions",key:4},r.a.createElement(Mt,{data:l,setData:c}))):r.a.createElement("span",null)}),Bt=function(e){var t=e.invitingFriends,a=e.invitedFriends,n=e.realFriends,l=e._id,c=e.callback,i=e.accountId,o=function(e){s.a.post("/api/friends/unfriend",{id:e}).then(function(e){e.data.success&&c()}).catch(function(e){})};return i.toString()===l.toString()?null:t.find(function(e){return e.friend.toString()===l.toString()})?[r.a.createElement(x.a,{key:"0",onClick:function(){return e=l,void s.a.post("/api/friends/accept",{id:e}).then(function(e){e.data.success&&c()}).catch(function(e){});var e},icon:r.a.createElement(ie.a,null)},"Accept"),r.a.createElement(x.a,{key:"1",onClick:function(){return o(l)},icon:r.a.createElement(ie.a,null)},"Decline")]:a.find(function(e){return e.friend.toString()===l.toString()})?[r.a.createElement(x.a,{key:"2",onClick:function(){return o(l)},icon:r.a.createElement(ie.a,null)},"Cancel invitation")]:n.find(function(e){return e.friend.toString()===l.toString()})?[r.a.createElement(x.a,{key:"3",onClick:function(){return o(l)},icon:r.a.createElement(ie.a,null)},"Unfriend")]:[r.a.createElement(x.a,{key:"4",onClick:function(){return e=l,void s.a.post("/api/friends/add",{id:e}).then(function(e){e.data.success&&c()}).catch(function(e){});var e},icon:r.a.createElement(ie.a,null)},"Become friends")]},Vt=re.a.Meta,Wt=function(e){return r.a.createElement(re.a,{type:"inner",style:{width:200,display:"inline-block"},cover:r.a.createElement("span",{onClick:function(){return e.history.push("/profile/"+e.friend._id)}},r.a.createElement(ve.a,{src:e.friend.image&&"https://websiter.s3.us-east-2.amazonaws.com/"+e.friend._id+"/avatar",size:100})),actions:[r.a.createElement(Bt,{accountId:e.account?e.account._id:"",realFriends:e.realFriends,invitedFriends:e.invitedFriends,invitingFriends:e.invitingFriends,_id:e.friend._id,callback:function(){return de(e,e.data,e.setData,{forceAuth:!1,forceActivate:!1})}})]},r.a.createElement(Vt,{title:e.friend.name,description:e.friend._id}))},Kt=re.a.Meta,Ut=function(e){var t=Object(n.useState)(),a=Object(p.a)(t,2),l=a[0],c=a[1],i=Object(n.useState)(),o=Object(p.a)(i,2),u=o[0],m=o[1],d=Object(n.useState)(null),f=Object(p.a)(d,2),h=f[0],g=f[1],E=Object(n.useState)(),b=Object(p.a)(E,2),y=b[0],v=b[1];if(Object(n.useEffect)(function(){de(e,y,v,{})},[]),!y)return null;var k=y.account,w=[],O=[],j=[];if(k.friendsData&&k.friends){var I=!0,C=!1,S=void 0;try{for(var _,N=function(){var e=_.value,t=k.friends.find(function(t){return t.friend.toString()===e._id.toString()}),a=Object(oe.a)({},t,e);t&&("friend"===t.status?w.push(a):"invited"===t.status?O.push(a):"inviting"===t.status&&j.push(a))},F=k.friendsData[Symbol.iterator]();!(I=(_=F.next()).done);I=!0)N()}catch(P){C=!0,S=P}finally{try{I||null==F.return||F.return()}finally{if(C)throw S}}}var D=r.a.createElement(pe.a,{title:"Add friend",visible:l,maskClosable:!0,closable:!0,onCancel:function(){return c(!1)},footer:r.a.createElement(x.a,{key:"back",onClick:function(){return c(!1)}},"Return")},r.a.createElement("p",null,"To find a friend you need to enter your friend's nickname."),r.a.createElement(T.a,Object.assign({name:"dynamic_form_nest_item",onFinish:function(e){s.a.post("/api/friends/find",Object(oe.a)({},e)).then(function(e){e.data.success?g(e.data.friend):(alert("Accounts with this nickname do not exist."),g(null))}).catch(function(e){})},autoComplete:"off"},{labelCol:{span:8},wrapperCol:{span:16}}),r.a.createElement(T.a.Item,{label:"Search",name:"search",rules:[{required:!0,message:"Search field is too short",min:2}]},r.a.createElement(M.a,{placeholder:"Must be more than 2 characters long"})),r.a.createElement(T.a.Item,{wrapperCol:{offset:8,span:16}},r.a.createElement(x.a,{type:"primary",htmlType:"submit",size:"large"},"Search"))),h&&r.a.createElement(re.a,{title:"Search result"},r.a.createElement(Wt,Object.assign({},e,{friend:h,realFriends:w,invitingFriends:j,invitedFriends:O,data:y,setData:v})))),A=r.a.createElement(pe.a,{title:"Pending friends",visible:u,maskClosable:!0,closable:!0,onCancel:function(){return m(!1)},footer:r.a.createElement(x.a,{key:"back",onClick:function(){return m(!1)}},"Return")},j.length>0&&r.a.createElement(re.a,{title:"People invited me to be friends"},j.map(function(t){return r.a.createElement(Wt,Object.assign({key:t._id},e,{friend:t,realFriends:w,invitingFriends:j,invitedFriends:O,data:y,setData:v}))})),O.length>0&&r.a.createElement(re.a,{title:"I invited these people"},O.map(function(t){return r.a.createElement(Wt,Object.assign({key:t._id},e,{friend:t,realFriends:w,invitingFriends:j,invitedFriends:O,data:y,setData:v}))})));return r.a.createElement(r.a.Fragment,null,r.a.createElement(He.a,{className:"site-page-header",title:"My friends",backIcon:!1}),(O.length>0||j.length>0)&&r.a.createElement(x.a,{style:{margin:"30px 0px "},type:"primary",onClick:function(){return m(!0)}},"Show pending friends"),r.a.createElement(re.a,null,r.a.createElement(re.a,{onClick:function(){return c(!0)},type:"inner",style:{width:200,display:"inline-block"},cover:r.a.createElement("div",{style:{height:200,width:200,backgroundSize:"cover",display:"flex",alignItems:"center",justifyContent:"center"}},r.a.createElement(ie.a,{style:{fontSize:"60px"}}))},r.a.createElement(Kt,{title:"Add a friend"})),w.map(function(t){return r.a.createElement(Wt,Object.assign({key:t._id},e,{friend:t,realFriends:w,invitingFriends:j,invitedFriends:O,data:y,setData:v}))})),D,A)},qt=a(370),Ht=(a(803),a(804)),Jt=(re.a.Meta,Object(E.a)(function(e){var t=Object(n.useState)(),a=Object(p.a)(t,2),l=a[0],c=a[1],i=Object(n.useState)(Math.floor(1e4*Math.random())),o=Object(p.a)(i,2),u=o[0],m=o[1],d=Object(n.useState)(!1),f=Object(p.a)(d,2),h=f[0],g=f[1];Object(n.useEffect)(function(){de(e,l,c,{})},[]),!h&&l&&function(e,t){var a=new Image;a.src=e,a.onload=function(){return t(!0)},a.onerror=function(){return t(!1)}}("https://websiter.s3.us-east-2.amazonaws.com/"+l.account._id+"/avatar",g);var E=h&&l&&"https://websiter.s3.us-east-2.amazonaws.com/"+l.account._id+"/avatar";return l?r.a.createElement(r.a.Fragment,null,r.a.createElement(He.a,{className:"site-page-header",title:"My account",backIcon:!1}),r.a.createElement(Ee.a,{name:"avatar",listType:"picture-card",className:qt.Avatar,showUploadList:!1,customRequest:function(e){var t=e.file;console.log(t),ke(t,800,"avatar",function(){m(Math.floor(1e4*Math.random()))})}},E?r.a.createElement("img",{src:E+"?version="+u,alt:"avatar",style:{width:"100%"}}):r.a.createElement("div",null,r.a.createElement(Ht.a,null),r.a.createElement("div",{className:"ant-upload-text"},"Upload"))),r.a.createElement(T.a,Object.assign({name:"dynamic_form_nest_item",onFinish:function(e){s.a.post("/api/account",{name:e.name}).then(function(e){}).catch(function(e){})},autoComplete:"off"},{labelCol:{span:8},wrapperCol:{span:16}},{initialValues:{name:l.account.name,nickname:l.account._id}}),r.a.createElement(T.a.Item,{label:"Name",name:"name",rules:[{required:!0,message:"Name is too short",min:2,whitespace:!0}]},r.a.createElement(M.a,{placeholder:"Must be more than 1 character long"})),r.a.createElement(T.a.Item,{label:"Nickname",name:"nickname",rules:[{required:!0,message:"Nickname is too short",whitespace:!0},{pattern:/^[a-zA-Z0-9_-]*$/,message:"Nickname should contain only letters, numbers, '-' and '_'."}]},r.a.createElement(M.a,{disabled:!0,placeholder:"Must be more than 1 character long"})),r.a.createElement(T.a.Item,{wrapperCol:{offset:8,span:16}},r.a.createElement(x.a,{type:"primary",htmlType:"submit",size:"large"},"Save")))):null})),Yt=Object(E.a)(function(e){var t=Object(n.useState)(),a=Object(p.a)(t,2),l=a[0],c=a[1];if(Object(n.useEffect)(function(){de(e,l,c,{forceAuth:!1,forceActivate:!1})},[e.history.location.pathname]),!l||!l.profile)return null;var i=l.profile,o=l.account,s=i&&i.image&&"https://websiter.s3.us-east-2.amazonaws.com/"+i._id+"/avatar",u=[],m=[],d=[];if(o&&o.friends){var f=!0,h=!1,g=void 0;try{for(var E,b=o.friends[Symbol.iterator]();!(f=(E=b.next()).done);f=!0){var y=E.value;"friend"===y.status?u.push(y):"invited"===y.status?m.push(y):"inviting"===y.status&&d.push(y)}}catch(v){h=!0,g=v}finally{try{f||null==b.return||b.return()}finally{if(h)throw g}}}return l?r.a.createElement(r.a.Fragment,null,r.a.createElement(He.a,{className:"site-page-header",title:i.name,backIcon:!1}),r.a.createElement("div",null,"Nickname - ",i._id),r.a.createElement(ve.a,{src:s,size:200}),r.a.createElement(Bt,{accountId:o?o._id:"",realFriends:u,invitedFriends:m,invitingFriends:d,_id:i._id,callback:function(){return de(e,l,c,{forceAuth:!1,forceActivate:!1})}}),r.a.createElement(le.a,null,r.a.createElement(le.a.TabPane,{tab:"Friends",key:1},r.a.createElement(re.a,{title:"Friends"},i.friends.filter(function(e){return"friend"===e.status}).map(function(t){var a=Object(oe.a)({},i.friendsData.find(function(e){return e._id.toString()===t.friend.toString()}),t.friend);return r.a.createElement(Wt,Object.assign({key:a._id},e,{account:o,friend:a,realFriends:u,invitingFriends:d,invitedFriends:m,data:l,setData:c}))}))),r.a.createElement(le.a.TabPane,{tab:"Progresses",key:2},r.a.createElement(re.a,{title:"Friends"},r.a.createElement(tt,{account:i,progressesData:i.progressesData}))),r.a.createElement(le.a.TabPane,{tab:"Goals",key:3},r.a.createElement(re.a,{title:"Goals"},i.goals.map(function(e,t){return r.a.createElement(We,{key:t,goal:e,owner:i,available:e.users.includes(o._id),account:o})}))),r.a.createElement(le.a.TabPane,{tab:"Shop",key:4},r.a.createElement(re.a,{title:"Shop"},i.perks&&i.perks.map(function(e,t){return r.a.createElement(zt,{key:t,perk:e,owner:i,account:o,onlyBuy:!0,data:l,setData:c})}))),r.a.createElement(le.a.TabPane,{tab:"Wallet",key:5},r.a.createElement(re.a,{title:"Wallet"},r.a.createElement(Dt,{data:{account:i}}))),r.a.createElement(le.a.TabPane,{tab:"Wishlist",key:6},r.a.createElement(re.a,{title:"Friends"},i.friends.filter(function(e){return"friend"===e.status}).map(function(t){var a=Object(oe.a)({},i.friendsData.find(function(e){return e._id.toString()===t.friend.toString()}),t.friend);return r.a.createElement(Wt,Object.assign({key:a._id},e,{account:o,friend:a,realFriends:u,invitingFriends:d,invitedFriends:m,data:l,setData:c}))}))))):null}),Zt=Object(E.a)(function(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement(He.a,{className:"site-page-header",title:"Activate your account",backIcon:!1}),r.a.createElement(T.a,Object.assign({name:"dynamic_form_nest_item",onFinish:function(t){s.a.post("/api/activate-account",Object(oe.a)({},t)).then(function(t){t.data.nicknameNotUnique&&alert("THis nickname is taken. Try another one."),e.history.push("/set-goals")}).catch(function(e){})},autoComplete:"off"},{labelCol:{span:8},wrapperCol:{span:16}}),r.a.createElement(T.a.Item,{label:"Name",name:"name",rules:[{required:!0,message:"Name is too short",min:2,whitespace:!0}]},r.a.createElement(M.a,{placeholder:"Must be more than 1 character long"})),r.a.createElement(T.a.Item,{label:"Nickname",name:"nickname",rules:[{required:!0,message:"Nickname is too short",whitespace:!0},{pattern:/^[a-zA-Z0-9_-]*$/,message:"Nickname should contain only letters, numbers, '-' and '_'."}]},r.a.createElement(M.a,{placeholder:"Must be more than 1 character long"})),r.a.createElement(T.a.Item,{wrapperCol:{offset:8,span:16}},r.a.createElement(x.a,{type:"primary",htmlType:"submit",size:"large"},"Save"))))}),$t=Je.a.Item,Qt=Object(E.a)(function(e){var t=Object(n.useState)({}),a=Object(p.a)(t,2),l=a[0],c=a[1],i=Object(n.useState)(""),o=Object(p.a)(i,2),s=o[0],u=o[1];Object(n.useEffect)(function(){de(e,l,c,{})},[]);var m,d=l.perk,f=l.profile;return d?r.a.createElement(r.a.Fragment,null,r.a.createElement(He.a,{className:"site-page-header",title:d.name,backIcon:!1}),d.images.map(function(e){return r.a.createElement("span",{onClick:function(){return u(e)}},r.a.createElement(re.a,{type:"inner",style:{width:200,display:"inline-block"},hoverable:!0,cover:r.a.createElement("div",{style:{backgroundImage:"url("+e+")",height:200,width:200,backgroundSize:"cover"}})}))}),r.a.createElement("p",null,d.description),r.a.createElement(Je.a,{title:"Goal description",bordered:!0,column:{xxl:4,xl:3,lg:3,md:3,sm:2,xs:1}},r.a.createElement($t,{label:"Available for"},(m=d.users,f&&f.friendsData?m.map(function(t){var a=f.friendsData.find(function(e){return e._id===t});return a?r.a.createElement("span",{style:{cursor:"pointer"},onClick:function(){return e.history.push("/profile/"+t)}},r.a.createElement(ve.a,{src:"https://websiter.s3.us-east-2.amazonaws.com/"+t+"/avatar",size:20,style:{marginRight:"10px"}}),a.name," - (",t,")"):t}):m)),r.a.createElement($t,{label:"Price"},d.price)),r.a.createElement(pe.a,{visible:s,footer:null,onCancel:function(){return u("")}},r.a.createElement("img",{alt:"example",style:{width:"100%"},src:s}))):null}),Xt=function(e){var t=Object(n.useState)({}),a=Object(p.a)(t,2),l=a[0],c=a[1],i=Object(n.useState)(""),o=Object(p.a)(i,2),s=o[0],u=o[1];Object(n.useEffect)(function(){de(e,l,c,{})},[]);var m=l.wishlistItem;return m?r.a.createElement(r.a.Fragment,null,r.a.createElement(He.a,{className:"site-page-header",title:m.name,backIcon:!1}),m.images.map(function(e){return r.a.createElement("span",{onClick:function(){return u(e)}},r.a.createElement(re.a,{type:"inner",style:{width:200,display:"inline-block"},hoverable:!0,cover:r.a.createElement("div",{style:{backgroundImage:"url("+e+")",height:200,width:200,backgroundSize:"cover"}})}))}),r.a.createElement("p",null,m.description),r.a.createElement(pe.a,{visible:s,footer:null,onCancel:function(){return u("")}},r.a.createElement("img",{alt:"example",style:{width:"100%"},src:s}))):null},ea=Object(E.a)(function(e){var t=Object(n.useState)({}),a=Object(p.a)(t,2),l=a[0],c=a[1];return Object(n.useEffect)(function(){function t(){return(t=Object(d.a)(m.a.mark(function t(){return m.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,de(e,l,c,{});case 2:case"end":return t.stop()}},t)}))).apply(this,arguments)}!function(){t.apply(this,arguments)}()},[]),l.account?r.a.createElement(Rt,{data:l,setData:c,mode:"wishlist"}):r.a.createElement("span",null)}),ta=new C.a,aa=Object(E.a)(function(){var e=Object(n.useState)(),t=Object(p.a)(e,2),a=t[0],l=t[1];Object(n.useEffect)(function(){function e(){return(e=Object(d.a)(m.a.mark(function e(){var t,a,n;return m.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:sessionStorage.setItem("systemRefresh","0"),t=ta.get("auth_token"),(a=ta.get("rememberme"))&&(ta.remove("rememberme",{path:"/"}),"false"===a&&ta.remove("auth_token",{path:"/"})),n=ue.a.decode(t),s.a.defaults.headers.post["Content-Type"]="application/json",s.a.defaults.headers.put["Content-Type"]="application/json",s.a.defaults.headers.delete["Content-Type"]="application/json",s.a.defaults.headers.common.Accept="application/json",t&&n?(s.a.defaults.headers.common["x-auth-token"]=t,s.a.defaults.headers.post["x-auth-token"]=t,s.a.defaults.headers.get["x-auth-token"]=t,s.a.defaults.headers.delete["x-auth-token"]=t,s.a.defaults.headers.put["x-auth-token"]=t,l(n._id)):l(!1);case 10:case"end":return e.stop()}},e)}))).apply(this,arguments)}!function(){e.apply(this,arguments)}()});var c=ta.get("redirectto");c&&ta.remove("redirectto",{path:"/"});var i=r.a.createElement(ae,{isAuthenticated:a},r.a.createElement(f.a,null,r.a.createElement(h.a,{path:"/goals",exact:!0,component:qe}),r.a.createElement(h.a,{path:"/goals",component:Qe}),r.a.createElement(h.a,{path:"/progresses",exact:!0,component:tt}),r.a.createElement(h.a,{path:"/progresses",component:Nt}),r.a.createElement(h.a,{path:"/profile",component:Yt}),r.a.createElement(h.a,{path:"/friends",exact:!0,component:Ut}),r.a.createElement(h.a,{path:"/account",exact:!0,component:Jt}),r.a.createElement(h.a,{path:"/shop",exact:!0,component:Gt}),r.a.createElement(h.a,{path:"/shop",component:Qt}),r.a.createElement(h.a,{path:"/wishlist",exact:!0,component:ea}),r.a.createElement(h.a,{path:"/wishlist",component:Xt}),!a&&r.a.createElement(h.a,{path:"/login",exact:!0,component:D}),r.a.createElement(h.a,{path:"/logout",exact:!0,component:j}),r.a.createElement(h.a,{path:"/activate-account",exact:!0,component:Zt}),!1,r.a.createElement(g.a,{to:"/dashboard"})));return"undefined"===typeof a?null:c?r.a.createElement(g.a,{to:c}):r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:{height:"100%"}},i))});s.a.defaults.baseURL="https://getreward.herokuapp.com";var na=r.a.createElement(i.a,null,r.a.createElement(aa,null)),ra=document.getElementById("root");c.a.render(na,ra)}},[[382,1,2]]]);
//# sourceMappingURL=main.e4f57ad0.chunk.js.map