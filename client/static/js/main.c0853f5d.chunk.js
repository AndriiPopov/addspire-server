(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{220:function(e,t,a){e.exports={Container:"Auth_Container__1KNy7",socialButtons:"Auth_socialButtons__2wwH9"}},364:function(e,t,a){e.exports={Avatar:"Account_Avatar__l4shx"}},377:function(e,t,a){e.exports=a(770)},406:function(e,t,a){},54:function(e,t,a){e.exports={Layout:"Layout_Layout__3t6t4",Header:"Layout_Header__3lh1Y",TopHeader:"Layout_TopHeader__3_LuK",BottomHeader:"Layout_BottomHeader__3DOBo",Main:"Layout_Main__3usmk",Button:"Layout_Button__1O5Hm",MenuButtonContiner:"Layout_MenuButtonContiner__PpulB",QuickButtonContiner:"Layout_QuickButtonContiner__4d4Lg"}},595:function(e,t){},597:function(e,t){},634:function(e,t){},635:function(e,t){},770:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),i=a(7),o=a.n(i),c=a(34),l=a(31),s=a.n(l),u=a(14),d=a(57),m=a(127),p=a(321),f=(a(406),a(43)),g=a(9),h=a(82),y=a(89),v=a(4),E=a(220),b=a.n(E),k=function(e){var t=null;if(e.icon){var a=function(e){for(var t=[],a=[];e.length>0;)if(0===(e=e.trim()).indexOf("</"))(e=e.substring(2)).indexOf("<")>0?(e=e.substring(e.indexOf("<")),a.pop()):e="";else{var n={type:(e=e.substring(e.indexOf("<"))).substring(1,e.indexOf(" ")),children:[]},r=(e=e.substring(e.indexOf(" "))).substring(0,e.indexOf(">")),i=r.indexOf("/>")>=0;for(e=e.substring(e.indexOf(">")+1).trim();r.length>0;){var o=r.substring(0,r.indexOf("=")).trim(),c=(r=r.substring(r.indexOf('"')+1)).substring(0,r.indexOf('"')).trim();r=r.substring(r.indexOf('"')+1).trim(),n[o]=c}0===a.length?t.push(n):a[a.length-1].children.push(n),i||a.push(n)}return t[0]}(e.icon);t=r.a.createElement("svg",{"data-testid":e.datatestid||"svg",height:a.height,width:a.width,viewBox:a.viewBox,className:e.className},a.children.map(function(e,t){return function e(t,a){switch(t.type){case"path":return r.a.createElement("path",{key:a,d:t.d,fill:t.fill},t.children.map(function(t,a){return e(t,a)}));case"g":return r.a.createElement("g",{key:a,fill:t.fill},t.children.map(function(t,a){return e(t,a)}));default:return}}(e,t)}))}return t},w=new y.a,O=Object(f.g)(Object(u.b)(function(e){return{lastUrl:e.lastUrl}})(function(e){var t=Object(n.useState)(!1),a=Object(g.a)(t,2),i=a[0],o=a[1],c=Object(n.useState)(!1),l=Object(g.a)(c,2),s=l[0],u=l[1];Object(n.useEffect)(function(){p()});var d="?rememberme=false";i&&(d="?rememberme=true");var m="&redirect=/login";e.lastUrl&&(m="&redirect="+e.lastUrl);var p=function(){w.get("cookies_consent")&&u(!0)},f="https://getreward.herokuapp.com/api/auth/";return console.log(s),r.a.createElement("div",{className:b.a.Container},s?r.a.createElement(r.a.Fragment,null,r.a.createElement("h1",null,"Continue with:"),r.a.createElement("div",{className:b.a.socialButtons},r.a.createElement("a",{href:f+"google/start".concat(d)},r.a.createElement(k,{icon:'<svg width="50" height="50" viewBox="0 0 24 24"><path fill="#4285F4" d="M12.24 10.285V14.4h6.806c-.275 1.765-2.056 5.174-6.806 5.174-4.095 0-7.439-3.389-7.439-7.574s3.345-7.574 7.439-7.574c2.33 0 3.891.989 4.785 1.849l3.254-3.138C18.189 1.186 15.479 0 12.24 0c-6.635 0-12 5.365-12 12s5.365 12 12 12c6.926 0 11.52-4.869 11.52-11.726 0-.788-.085-1.39-.189-1.989H12.24z"></path></svg>'}),r.a.createElement("div",null,"GOOGLE")),r.a.createElement("a",{href:f+"facebook/start".concat(d)},r.a.createElement(k,{icon:'<svg width="50" height="50" viewBox="0 0 24 24"><path fill="#1877F2" d="M23.9981 11.9991C23.9981 5.37216 18.626 0 11.9991 0C5.37216 0 0 5.37216 0 11.9991C0 17.9882 4.38789 22.9522 10.1242 23.8524V15.4676H7.07758V11.9991H10.1242V9.35553C10.1242 6.34826 11.9156 4.68714 14.6564 4.68714C15.9692 4.68714 17.3424 4.92149 17.3424 4.92149V7.87439H15.8294C14.3388 7.87439 13.8739 8.79933 13.8739 9.74824V11.9991H17.2018L16.6698 15.4676H13.8739V23.8524C19.6103 22.9522 23.9981 17.9882 23.9981 11.9991Z"></path></svg>'}),r.a.createElement("div",null,"FACEBOOK")),r.a.createElement("a",{href:f+"github/start".concat(d,"&").concat(m)},r.a.createElement(k,{icon:'<svg width="50" height="50" viewBox="0 0 16 16"><path fill="#333" d="M8 0C3.58 0 0 3.58 0 8C0 11.54 2.29 14.53 5.47 15.59C5.87 15.66 6.02 15.42 6.02 15.21C6.02 15.02 6.01 14.39 6.01 13.72C4 14.09 3.48 13.23 3.32 12.78C3.23 12.55 2.84 11.84 2.5 11.65C2.22 11.5 1.82 11.13 2.49 11.12C3.12 11.11 3.57 11.7 3.72 11.94C4.44 13.15 5.59 12.81 6.05 12.6C6.12 12.08 6.33 11.73 6.56 11.53C4.78 11.33 2.92 10.64 2.92 7.58C2.92 6.71 3.23 5.99 3.74 5.43C3.66 5.23 3.38 4.41 3.82 3.31C3.82 3.31 4.49 3.1 6.02 4.13C6.66 3.95 7.34 3.86 8.02 3.86C8.7 3.86 9.38 3.95 10.02 4.13C11.55 3.09 12.22 3.31 12.22 3.31C12.66 4.41 12.38 5.23 12.3 5.43C12.81 5.99 13.12 6.7 13.12 7.58C13.12 10.65 11.25 11.33 9.47 11.53C9.76 11.78 10.01 12.26 10.01 13.01C10.01 14.08 10 14.94 10 15.21C10 15.42 10.15 15.67 10.55 15.59C13.71 14.53 16 11.53 16 8C16 3.58 12.42 0 8 0Z"></path></svg>'}),r.a.createElement("div",null,"GITHUB"))),r.a.createElement(h.a,{checked:i,onChange:function(){return o(!i)}},"Remember me")):r.a.createElement(r.a.Fragment,null,r.a.createElement("div",null,"We use cookies only for login purposes. In order to proceed you need to agree with the use of cookies."),r.a.createElement(v.a,{onClick:function(){w.set("cookies_consent","true",{path:"/",maxAge:3153e4}),p()}},"Agree"),r.a.createElement(v.a,{onClick:function(){window.open("https://websiter.dev","_self")}},"Return to the homepage")))})),_=a(10),x=a(37),D=(new y.a,a(119),a(91),a(202),a(506),a(257),a(258),a(511),a(259),a(514),a(260),a(261),a(203),a(519),a(521),a(523),a(771),a(527),a(529),a(531),a(262),a(150),a(263),a(772),a(773),a(539),a(541),a(543),a(545),a(547),a(550),a(552),a(774),a(143)),S=a(36),j=a(46),C=a(30),I=a(182),T=a(54),A=a(331),P=a.n(A),F=a(192),R=a.n(F),N=a(333),M=a.n(N),z=a(332),B=a.n(z),L=a(225),U=a.n(L),V=a(227),G=a.n(V),H=a(224),J=a.n(H),q=a(226),W=a.n(q),K=a(96),Q=function(e,t){return e?"https://websiter.s3.us-east-2.amazonaws.com/"+e+"/avatar?v="+(t||0):""},Y=D.a.Header,Z=D.a.Content,$=Object(f.g)(Object(u.b)(function(e){return{account:e.account,pageTitle:e.pageTitle,isAuthed:e.isAuthed}})(function(e){var t=e.account,a=Object(n.useState)(),i=Object(g.a)(a,2),o=i[0],c=i[1],l=function(){c(!o)},s=e.history.location.pathname.split("/")[1]||void 0,u={type:"link",size:"large",className:T.Button},d=function(e){return s===e?{ghost:!1,type:"primary"}:{}},m=function(t){return e.history.push("/"+t)},p="/activate-account"===e.history.location.pathname;return e.isAuthed&&t?r.a.createElement(r.a.Fragment,null,r.a.createElement(D.a,{className:T.Layout},r.a.createElement(Y,{className:T.Header},r.a.createElement("div",{className:T.TopHeader},r.a.createElement("div",{className:T.MenuButtonContiner},!p&&r.a.createElement(v.a,Object.assign({},u,{icon:r.a.createElement(J.a,null),onClick:l}))),r.a.createElement("div",{className:T.QuickButtonContiner},p?r.a.createElement(S.a,{title:"Logout",placement:"bottomRight",mouseEnterDelay:.3},r.a.createElement(v.a,Object.assign({},u,d("friends"),{icon:r.a.createElement(R.a,null),onClick:function(){return e.history.push("/logout")}}),"Logout")):r.a.createElement(r.a.Fragment,null,r.a.createElement(S.a,{title:"Progresses",placement:"bottomRight",mouseEnterDelay:.3},r.a.createElement(v.a,Object.assign({},u,d("progresses"),{icon:r.a.createElement(U.a,null),onClick:function(){return m("progresses")}}))),r.a.createElement(S.a,{title:"Shop",placement:"bottomRight",mouseEnterDelay:.3},r.a.createElement(v.a,Object.assign({},u,d("shop"),{icon:r.a.createElement(W.a,null),onClick:function(){return m("shop")}}))),r.a.createElement(S.a,{title:"Friends",placement:"bottomRight",mouseEnterDelay:.3},r.a.createElement(v.a,Object.assign({},u,d("friends"),{icon:r.a.createElement(G.a,null),onClick:function(){return m("friends")}}))),r.a.createElement(S.a,{title:"Account",placement:"bottomRight",mouseEnterDelay:.3},r.a.createElement("span",{onClick:function(){return m("account")},style:{margin:"0px 10px",cursor:"pointer"}},r.a.createElement(C.a,{src:Q(t._id,t.image)})))))),r.a.createElement("div",{className:T.BottomHeader},r.a.createElement(K.a,{className:"site-page-header",onBack:function(){return e.history.goBack()},title:p?"Activate your account":e.pageTitle&&e.pageTitle.main,subTitle:e.pageTitle&&e.pageTitle.sub||""}))),r.a.createElement(Z,{className:T.Main},r.a.createElement("div",null,e.children)),!p&&r.a.createElement(I.a,{title:"Menu",closable:!0,onClose:l,visible:o,placement:"left"},r.a.createElement(j.a,{theme:"light",mode:"vertical",selectedKeys:[s],onClick:function(t){var a=t.key;e.history.push("/"+a),l()},overflowedIndicator:r.a.createElement(J.a,null)},r.a.createElement(j.a.Item,{key:"progresses",icon:r.a.createElement(U.a,null)},"Progresses"),r.a.createElement(j.a.Item,{key:"shop",icon:r.a.createElement(W.a,null)},"Shop"),r.a.createElement(j.a.Item,{key:"friends",icon:r.a.createElement(G.a,null)},"Friends"),r.a.createElement(j.a.Item,{key:"goals",icon:r.a.createElement(P.a,null)},"Goals"),r.a.createElement(j.a.Item,{key:"wishlist",icon:r.a.createElement(B.a,null)},"Wishlist"),r.a.createElement(j.a.Item,{key:"account",icon:r.a.createElement(M.a,null)},"Account"),r.a.createElement(j.a.Item,{key:"logout",icon:r.a.createElement(R.a,null)},"Logout"))))):["/login","logout"].includes(e.history.location.pathname)?e.children:r.a.createElement(r.a.Fragment,null,r.a.createElement(D.a,{className:T.Layout},r.a.createElement(Y,{className:T.Header},r.a.createElement("div",{className:T.TopHeader},r.a.createElement("div",{className:T.MenuButtonContiner}),r.a.createElement("div",{className:T.QuickButtonContiner},r.a.createElement(S.a,{title:"Sign in or Sign up",placement:"bottomRight",mouseEnterDelay:.3},r.a.createElement(v.a,Object.assign({},u,d("friends"),{icon:r.a.createElement(R.a,null),onClick:function(){return e.history.push("/login")}}),"Sign in or Sign up")))),r.a.createElement("div",{className:T.BottomHeader},r.a.createElement(K.a,{className:"site-page-header",onBack:function(){return e.history.goBack()},title:e.pageTitle&&e.pageTitle.main,subTitle:e.pageTitle&&e.pageTitle.sub||""}))),r.a.createElement(Z,{className:T.Main},r.a.createElement("div",null,e.children))))})),X=a(334),ee=a.n(X),te=a(41),ae=function(e,t){if(e.data.logout&&t.history.push("/logout"),!1===e.data.success)if(e.data.errorCode)switch(e.data.errorCode){case"no account":te.a.warning("Account is not found. Please login.");break;case"bad data":te.a.error("Error. Please try one more time with correct data.");break;case"progress exist":te.a.warning("This progress already exists.");break;default:te.a.warning("Something wrong has happened... Try again!")}else te.a.error("Something failed");else if(e.data.successCode)switch(e.data.successCode){case"avatar saved":te.a.success("The avatar image has been updated.");break;case"success":te.a.success("Success!");break;case"item saved":te.a.success("Item is saved");break;case"prgress created":te.a.success("Progress has started!");break;default:te.a.success("Success!")}e.data.status&&"no account"===e.data.status&&t.history.push("/activate-account")},ne=new y.a,re=function(e,t){return function(a){sessionStorage.setItem("systemRefresh","0");var n=ne.get("auth_token"),r=ne.get("rememberme");r&&(ne.remove("rememberme",{path:"/"}),"false"===r&&ne.remove("auth_token",{path:"/"}));var i=ee.a.decode(n);s.a.defaults.headers.post["Content-Type"]="application/json",s.a.defaults.headers.put["Content-Type"]="application/json",s.a.defaults.headers.delete["Content-Type"]="application/json",s.a.defaults.headers.common.Accept="application/json",n&&i?(s.a.defaults.headers.common["x-auth-token"]=n,s.a.defaults.headers.post["x-auth-token"]=n,s.a.defaults.headers.get["x-auth-token"]=n,s.a.defaults.headers.delete["x-auth-token"]=n,s.a.defaults.headers.put["x-auth-token"]=n,a(oe(i._id))):(a(oe(!1)),a(ie(e.history.location.pathname)),t&&e.history.push("/logout"))}},ie=function(e){return{type:"SAVE_LAST_URL",url:e}},oe=function(e){return{type:"SET_IS_AUTHED",id:e}},ce=function(e){return{type:"SET_DATA",data:e}},le=function(e){return{type:"SET_PAGE_TITLE",title:e}},se=function(e){return{type:"SET_FRIEND_SEARCH_RESULT",data:e}},ue=a(133),de=a(134),me=a(135),pe=a(141),fe=a(136),ge=a(142),he=a(27),ye=function(e){var t=e.store,a={user:[],account:[],progress:[],post:[],group:[],progressData:[],friendData:[],postData:[],groupData:[],transactionData:[]},n={user:[],account:[],progress:[],post:[],group:[],progressData:[],friendData:[],postData:[],groupData:[],transactionData:[]};if(t.isAuthed)if(t.user){if(n.user.push(t.user._id),t.currentAccount)if(t.account._id!==t.currentAccount)a.account.push(t.currentAccount);else{n.account.push(t.account._id);var r=!0,i=!1,o=void 0;try{for(var c,l=t.account.progresses[Symbol.iterator]();!(r=(c=l.next()).done);r=!0){var s=c.value;t.progressData[s]||a.progressData.push(s),n.progressData.push(s)}}catch(Ke){i=!0,o=Ke}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}var u=!0,d=!1,m=void 0;try{for(var p,f=t.account.groups[Symbol.iterator]();!(u=(p=f.next()).done);u=!0){var g=p.value;t.groupData[g]||a.groupData.push(g),n.groupData.push(g)}}catch(Ke){d=!0,m=Ke}finally{try{u||null==f.return||f.return()}finally{if(d)throw m}}var h=!0,y=!1,v=void 0;try{for(var E,b=t.account.followPosts[Symbol.iterator]();!(h=(E=b.next()).done);h=!0){var k=E.value;t.postData[k]||a.postData.push(k),n.postData.push(k)}}catch(Ke){y=!0,v=Ke}finally{try{h||null==b.return||b.return()}finally{if(y)throw v}}var w=!0,O=!1,_=void 0;try{for(var x,D=t.account.transactions[Symbol.iterator]();!(w=(x=D.next()).done);w=!0){var S=x.value;t.transactionData[S]||a.transactionData.push(S),n.transactionData.push(S)}}catch(Ke){O=!0,_=Ke}finally{try{w||null==D.return||D.return()}finally{if(O)throw _}}var j=!0,C=!1,I=void 0;try{for(var T,A=t.account.friends[Symbol.iterator]();!(j=(T=A.next()).done);j=!0){var P=T.value;t.friendData[P.friend]||a.friendData.push(P.friend),n.friendData.push(P.friend)}}catch(Ke){C=!0,I=Ke}finally{try{j||null==A.return||A.return()}finally{if(C)throw I}}}if(t.currentProfile)if(t.profile._id!==t.currentProfile)a.account.push(t.currentProfile);else{n.account.push(t.profile._id);var F=!0,R=!1,N=void 0;try{for(var M,z=t.profile.progresses[Symbol.iterator]();!(F=(M=z.next()).done);F=!0){var B=M.value;t.progressData[B]||a.progressData.push(B),n.progressData.push(B)}}catch(Ke){R=!0,N=Ke}finally{try{F||null==z.return||z.return()}finally{if(R)throw N}}var L=!0,U=!1,V=void 0;try{for(var G,H=t.profile.groups[Symbol.iterator]();!(L=(G=H.next()).done);L=!0){var J=G.value;t.groupData[J]||a.groupData.push(J),n.groupData.push(J)}}catch(Ke){U=!0,V=Ke}finally{try{L||null==H.return||H.return()}finally{if(U)throw V}}var q=!0,W=!1,K=void 0;try{for(var Q,Y=t.profile.friends[Symbol.iterator]();!(q=(Q=Y.next()).done);q=!0){var Z=Q.value;t.friendData[Z.friend]||a.friendData.push(Z.friend),n.friendData.push(Z)}}catch(Ke){W=!0,K=Ke}finally{try{q||null==Y.return||Y.return()}finally{if(W)throw K}}}if(t.currentGroup)if(t.group._id!==t.currentGroup)a.group.push(t.currentGroup);else{n.group.push(t.group._id);var $=!0,X=!1,ee=void 0;try{for(var te,ae=t.group.users[Symbol.iterator]();!($=(te=ae.next()).done);$=!0){var ne=te.value;t.friendData[ne]||a.friendData.push(ne),n.friendData.push(ne)}}catch(Ke){X=!0,ee=Ke}finally{try{$||null==ae.return||ae.return()}finally{if(X)throw ee}}var re=!0,ie=!1,oe=void 0;try{for(var ce,le=t.group.progresses[Symbol.iterator]();!(re=(ce=le.next()).done);re=!0){var se=ce.value;t.progressData[se]||a.progressData.push(se),n.progressData.push(se)}}catch(Ke){ie=!0,oe=Ke}finally{try{re||null==le.return||le.return()}finally{if(ie)throw oe}}var ue=!0,de=!1,me=void 0;try{for(var pe,fe=t.group.posts[Symbol.iterator]();!(ue=(pe=fe.next()).done);ue=!0){var ge=pe.value;t.postData[ge]||a.postData.push(ge),n.postData.push(ge)}}catch(Ke){de=!0,me=Ke}finally{try{ue||null==fe.return||fe.return()}finally{if(de)throw me}}}if(t.currentProgress)if(t.progress._id!==t.currentProgress)a.progress.push(t.currentProgress);else{n.progress.push(t.progress._id);var ye=[];t.progress.owner&&ye.push(t.progress.owner),t.progress.worker&&ye.push(t.progress.worker),ye=[].concat(Object(he.a)(ye),Object(he.a)(t.progress.experts||[]),Object(he.a)(t.progress.supporters||[]));var ve=!0,Ee=!1,be=void 0;try{for(var ke,we=ye[Symbol.iterator]();!(ve=(ke=we.next()).done);ve=!0){var Oe=ke.value;t.friendData[Oe]||a.friendData.push(Oe),n.friendData.push(Oe)}}catch(Ke){Ee=!0,be=Ke}finally{try{ve||null==we.return||we.return()}finally{if(Ee)throw be}}var _e=!0,xe=!1,De=void 0;try{for(var Se,je=t.progress.posts[Symbol.iterator]();!(_e=(Se=je.next()).done);_e=!0){var Ce=Se.value;t.postData[Ce]||a.postData.push(Ce),n.postData.push(Ce)}}catch(Ke){xe=!0,De=Ke}finally{try{_e||null==je.return||je.return()}finally{if(xe)throw De}}}if(t.currentPosts){var Ie=!0,Te=!1,Ae=void 0;try{for(var Pe,Fe=t.currentPosts[Symbol.iterator]();!(Ie=(Pe=Fe.next()).done);Ie=!0){var Re=Pe.value,Ne=t.post[Re];if(Ne){n.post.push(Re);var Me=!0,ze=!1,Be=void 0;try{for(var Le,Ue=Ne.users[Symbol.iterator]();!(Me=(Le=Ue.next()).done);Me=!0){var Ve=Le.value;t.friendData[Ve]||a.friendData.push(Ve),n.friendData.push(Ve)}}catch(Ke){ze=!0,Be=Ke}finally{try{Me||null==Ue.return||Ue.return()}finally{if(ze)throw Be}}}else a.post.push(Re)}}catch(Ke){Te=!0,Ae=Ke}finally{try{Ie||null==Fe.return||Fe.return()}finally{if(Te)throw Ae}}}}else a.user.push(t.isAuthed);var Ge=function(e){for(var t in e)e[t]&&(e[t]=Array.from(new Set(e[t])))};Ge(n);var He,Je={user:[],account:[],progress:[],post:[],group:[],progressData:[],friendData:[],postData:[],groupData:[],transactionData:[]};Je.profile=[];var qe=function(e,a){t[a]._id&&!n[e].includes(t[a]._id)&&(Je[a].push(t[a]._id),He=!0)},We=function(e){for(var a in t[e])n[e].includes(a)||(Je[e].push(a),He=!0)};return qe("account","account"),qe("account","profile"),qe("group","group"),qe("progress","progress"),We("post"),We("friendData"),We("progressData"),We("transactionData"),We("postData"),We("groupData"),He&&(console.log(Je),e.removeData(Je)),Ge(a),a},ve=function(e,t,a,n){var r={user:[],account:[],progress:[],post:[],group:[],progressData:[],friendData:[],postData:[],groupData:[],transactionData:[]},i=function(n){for(var i in e[n])"undefined"!==typeof e[n][i]&&(a[n][i]?a[n][i]!==e[n][i]&&Oe("postData",[i],t):r[n].push(i))},o=function(n){for(var i in e[n])"undefined"!==typeof e[n][i]&&(a[n]._id===i?(a[n].__v!==e[n][i]&&Oe("progress",[i],t),a[n]._id||r[n].push(i)):r[n].push(i))};for(var c in e.user)"undefined"!==typeof e.user[c]&&(a.user._id===c?a.user.__v!==e.user[c]&&Oe("user",[c],t):r.user.push(c));for(var l in e.account)"undefined"!==typeof e.account[l]&&(a.account._id===l&&a.account.__v!==e.account[l]&&Oe("account",[l],t),a.profile._id===l&&(a.profile.__v!==e.profile[l]&&Oe("account",[l],t),a.account._id||r.account.push(l)),a.account._id!==l&&a.profile._id!==l&&r.account.push(l));if(o("progress"),o("group"),i("post"),i("friendData"),i("progressData"),i("postData"),i("groupData"),i("transactionData"),r.user.length>0||r.account.length>0||r.progress.length>0||r.post.length>0||r.group.length>0||r.friendData.length>0||r.progressData.length>0||r.postData.length>0||r.groupData.length>0||r.transactionData.length>0)return r},Ee=function(e){var t=e.store,a={user:{},account:{},progress:{},post:{},group:{},transactionData:{},friendData:{},progressData:{},groupData:{},postData:{}};t.user&&t.user._id&&(a.user[t.user._id]=t.user.__v),t.account._id&&(a.account[t.account._id]=t.account.__v),t.profile._id&&(a.account[t.profile._id]=t.profile.__v),t.progress._id&&(a.progress[t.progress._id]=t.progress.__v),t.group._id&&(a.group[t.group._id]=t.group.__v);var n=function(e){for(var n in t[e])"undefined"!==typeof t[e][n]&&t[e][n]._id&&(a[e][t[e][n]._id]=t[e][n].__v)};return n("post"),n("friendData"),n("postData"),n("groupData"),n("progressData"),n("TransactionData"),a},be=(a(697).create({propertyFilter:function(e,t){return"patch"!==e}}),!1),ke=function(e){function t(){var e,a;Object(de.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(pe.a)(this,(e=Object(fe.a)(t)).call.apply(e,[this].concat(r)))).state={user:[],account:[],progress:[],post:[],group:[],friendData:[],progressData:[],postData:[],groupData:[],transactionData:[]},a.start=function(){var e;be=new WebSocket("wss://getreward.herokuapp.com");var t=function(t){var n;t&&(n=ve(t,a.state,a.props.store,be)),clearTimeout(e),e=setTimeout(function(){be.close()},31e3),be.send(JSON.stringify({messageCode:"heartbeat",notNeededResources:n}))};be.onopen=function(e){var n=Ee(a.props);be.send(JSON.stringify({messageCode:"auth",user:s.a.defaults.headers.common["x-auth-token"],resourcesToMonitor:n})),a.initializeRequestResources(a.props),t()},be.onmessage=function(e){var n=JSON.parse(e.data);switch(n.messageCode){case"heartbeat":t(n.versions);break;case"logout":a.props.logout();break;case"successMessage":te.a.success(n.messageText);break;case"errorMessage":te.a.error(n.messageText);break;case"friendsData":a.props.setFriendsData(n.friendsData);break;case"redirectToProgresses":a.props.history.push("/progresses");break;case"addResource":a.props.saveResource(n.resources,n.type);break;case"updateResource":a.props.updateResource(n.code,n.id,n.update,a.state);break;case"friendSearchResult":a.props.setFriendSearchResult(n.data);break;case"error":te.a.error(n.text)}},be.onclose=function(t){clearTimeout(e)}},a.checkInterval=null,a.check=function(){be&&3!==be.readyState||(clearInterval(a.checkInterval),a.checkInterval=setInterval(a.check,5e3),a.start())},a.reRequestResourcesInterval=null,a.reRequestResources=function(){for(var e=0,t=["user","account","progress","post","group","postData","groupData","progressData","friendData","transactionData"];e<t.length;e++){var n=t[e];a.state[n].length>0&&be&&1===be.readyState&&be.send(JSON.stringify({messageCode:"requestResource",ids:a.state[n],type:n}))}},a.initializeRequestResources=function(e){console.log("init");for(var t=ye(e),n=function(){var e=i[r];t[e].length>0&&be&&1===be.readyState&&(console.log("init send"),be.send(JSON.stringify({messageCode:"requestResource",ids:t[e].filter(function(t){return!a.state[e].includes(t)}),type:e})))},r=0,i=["user","account","progress","post","group","postData","groupData","progressData","friendData","transactionData"];r<i.length;r++)n();a.setState(function(){return t}),clearInterval(a.reRequestResourcesInterval),a.reRequestResourcesInterval=setInterval(a.reRequestResources,3e3)},a}return Object(ge.a)(t,e),Object(me.a)(t,[{key:"componentWillMount",value:function(){this.checkInterval=setInterval(this.check,50)}},{key:"componentWillUnmount",value:function(){clearInterval(this.checkInterval),be&&be.close()}},{key:"componentWillReceiveProps",value:function(e){console.log("willrecpro"),this.initializeRequestResources(e)}},{key:"render",value:function(){return null}}]),t}(n.Component),we=Object(f.g)(Object(u.b)(function(e){return{store:e}},function(e){return{setData:function(t,a){return e(ce(t))},removeData:function(t){return e(function(e){return{type:"REMOVE_DATA",data:e}}(t))},saveResource:function(t,a){return e(function(e,t){return function(a,n){if(e.length>0){var r=n();switch(t){case"user":var i=e[0],o=i.currentAccount;o||(o=i.myAccount),a(ce({user:i,currentAccount:o}));break;case"account":var c=e.find(function(e){return e._id===r.currentAccount});c&&a(ce({account:c}));var l=e.find(function(e){return e._id===r.currentProfile});l&&a(ce({profile:l}));break;case"progress":var s=e.find(function(e){return e._id===r.currentProgress});s&&a(ce({progress:s}));break;case"group":var u=e.find(function(e){return e._id===r.currentGroup});u&&a(ce({group:u}));break;case"post":var d={},m=!0,p=!1,f=void 0;try{for(var g,h=e[Symbol.iterator]();!(m=(g=h.next()).done);m=!0){var y=g.value;d[y._id]=y}}catch(X){p=!0,f=X}finally{try{m||null==h.return||h.return()}finally{if(p)throw f}}a(ce({post:d}));break;case"friendData":var v={},E=!0,b=!1,k=void 0;try{for(var w,O=e[Symbol.iterator]();!(E=(w=O.next()).done);E=!0){var _=w.value;v[_._id]=_}}catch(X){b=!0,k=X}finally{try{E||null==O.return||O.return()}finally{if(b)throw k}}a(ce({friendData:v}));break;case"progressData":var x={},D=!0,S=!1,j=void 0;try{for(var C,I=e[Symbol.iterator]();!(D=(C=I.next()).done);D=!0){var T=C.value;x[T._id]=T}}catch(X){S=!0,j=X}finally{try{D||null==I.return||I.return()}finally{if(S)throw j}}a(ce({progressData:x}));break;case"transactionData":var A={},P=!0,F=!1,R=void 0;try{for(var N,M=e[Symbol.iterator]();!(P=(N=M.next()).done);P=!0){var z=N.value;A[z._id]=z}}catch(X){F=!0,R=X}finally{try{P||null==M.return||M.return()}finally{if(F)throw R}}a(ce({transactionData:A}));break;case"postData":var B={},L=!0,U=!1,V=void 0;try{for(var G,H=e[Symbol.iterator]();!(L=(G=H.next()).done);L=!0){var J=G.value;B[J._id]=J}}catch(X){U=!0,V=X}finally{try{L||null==H.return||H.return()}finally{if(U)throw V}}a(ce({postData:B}));break;case"groupData":var q={},W=!0,K=!1,Q=void 0;try{for(var Y,Z=e[Symbol.iterator]();!(W=(Y=Z.next()).done);W=!0){var $=Y.value;q[$._id]=$}}catch(X){K=!0,Q=X}finally{try{W||null==Z.return||Z.return()}finally{if(K)throw Q}}a(ce({groupData:q}))}}}}(t,a))},setFriendsData:function(t){return e(function(e){return{type:"SET_FRIENDS_DATA",data:e}}(t))},tryAuth:function(t,a){return e(re(t,a))},updateResource:function(t,a,n,r){return e(Se(t,a,n,r))},setFriendSearchResult:function(t){return e(se(t))}}})(ke)),Oe=function(e,t,a){var n=t.filter(function(t){return!a[e].includes(t)});be&&1===be.readyState&&be.send(JSON.stringify({messageCode:"requestResource",ids:n,type:e}))},_e=a(229),xe=a.n(_e),De=function(e,t,a){console.log("---------------------------APLY DELTA------------------------"),console.log("----------------source----------------"),console.log(e),console.log("----------------delta-------------------"),console.log(t);var n=xe()(e);!function(e,t,a){var n=function e(t,a,n){a.length>1?e(t[a.shift()],a,n):"array"===typeof t?t.push(n):t[a[0]]=n};for(var r in t){var i=r.split(".");a&&!a.includes(i[0])||"undefined"!==typeof t[r]&&n(e,i,t[r])}}(n,t.updatedFields,a);var r=function e(t,a){a.length>1?e(t[a.shift()],a):"object"===typeof t?delete t[a[0]]:"array"===typeof t&&t.splice(a[0],1)},i=!0,o=!1,c=void 0;try{for(var l,s=t.removedFields[Symbol.iterator]();!(i=(l=s.next()).done);i=!0){var u=l.value;if(u.indexOf(".")>-1){var d=u.split(".");a&&!a.includes(d[0])||r(n,d)}else delete n[u]}}catch(m){o=!0,c=m}finally{try{i||null==s.return||s.return()}finally{if(o)throw c}}return n},Se=function(e,t,a,n){return function(r,i){if(a&&t&&e){var o=i(),c=function(i){if(o[i]._id===t)if(o[i].__v===a.updatedFields.__v-1){var c=De(o[i],a);r(ce(Object(ue.a)({},i,c)))}else o[i].id&&Oe(e,[t],n)},l=function(i,c){var l=Object(ue.a)({},i,xe()(o[i])),s=l[i][t];s&&(s.__v===a.updatedFields.__v-1?(l[i][t]=De(s,a,c),r(ce(l))):Oe(e,[t],n))};switch(e){case"user":c("user");break;case"account":c("account"),c("profile");break;case"progress":c("progress");break;case"group":c("group");break;case"post":r(ce(l(e)));break;case"friendData":r(ce(l(e,["name","image","notifications","__v"])));break;case"progressData":r(ce(l(e,["owner","worker","goal","notifications","__v"])));break;case"postData":case"groupData":r(ce(l(e,["notifications","__v"])));break;case"transactionData":r(ce(l(e)))}}}},je=a(35),Ce=a(12),Ie=a(230),Te=a.n(Ie),Ae=a(336),Pe=function(e,t,a,n){if(null==e)return alert("No file selected.");var r=new FileReader;r.onload=function(){var r=Object(Ae.a)(Te.a.mark(function r(i){return Te.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:Re(e,{width:t,height:t},function(e){Fe(e,"/120").then(function(e){Me(e,a,n)})});case 1:case"end":return r.stop()}},r)}));return function(e){return r.apply(this,arguments)}}(),r.readAsArrayBuffer(e)},Fe=function(e,t,a){return a=a||(e.match(/^data:([^;]+);/)||"")[1],fetch(e).then(function(e){return e.arrayBuffer()}).then(function(e){return new File([e],t,{type:a})})},Re=function(e,t,a){if(e){var n=new FileReader;n.onload=function(e){Ne(e.target.result,t,a)},n.readAsDataURL(e)}},Ne=function(e,t,a){var n,r=new Image;r.onload=function(){var e=r.width/t.width,i=r.height/t.height,o=document.createElement("canvas"),c=o.getContext("2d");o.width=r.width,o.height=r.height,c.drawImage(r,0,0),(e>1||i>1)&&(r.width>r.height?(o.height=r.height/r.width*t.width,o.width=t.width):(o.width=r.width/r.height*t.width,o.height=t.width)),c.drawImage(o,0,0,o.width,o.height),c.drawImage(r,0,0,o.width,o.height),n=o.toDataURL(),a(n)},r.src=e},Me=function(e,t,a){return s.a.post("/api/sign-s3",{fileName:t}).then(function(t){ze(e,t.data,a)}).catch(function(e){})},ze=function(e,t,a){return s.a.put(t.signedRequest,e,{headers:{"Content-Type":"multipart/form-data"}}).then(function(e){a(t.url),te.a.success("The image has been saved.")}).catch(function(e){console.log(e)})},Be=a(187),Le=a(53),Ue=a(68),Ve=a(81),Ge=a.n(Ve),He=a(114),Je=200,qe=1e4,We=1e4,Ke=[{required:!0,message:"Nickname is too short. Minimal length is 2.",whitespace:!0,min:2},{message:"Nickname is too long. Miximum length is ".concat(Je,"."),whitespace:!0,max:Je},{pattern:/^[a-zA-Z0-9_-]*$/,message:"Nickname should contain only letters, numbers, '-' and '_'."}],Qe=[{required:!0,min:1,whitespace:!0,message:"Name is too short. Minimal length is 1."},{max:Je,message:"Name is too long. Miximum length is ".concat(Je,".")}],Ye=[{required:!0,min:2,whitespace:!0,message:"Name is too short. Minimal length is 2."},{max:Je,message:"Name is too long. Miximum length is ".concat(Je,".")}],Ze=[{max:qe,message:"Description is too long. Miximum length is ".concat(qe,".")}],$e=[{min:1,whitespace:!0,message:"Message is too short. Minimal length is 1."},{max:We,message:"Message is too long. Miximum length is ".concat(We,".")}],Xe=[{required:!0,message:"Please input the item price."}],et=function(e){var t=Object(n.useState)(""),a=Object(g.a)(t,2),i=a[0],o=a[1],c=e.connections,l=e.perkId,s=e.perk,u=e.deletePerk,d=e.onFinish,m=e.images,p=e.setImages,f=e.uploadImage,h=r.a.createElement(Le.a,{mode:"multiple",style:{width:"100%"},placeholder:"Please select"},c.map(function(e){return r.a.createElement(Le.a.Option,{key:e._id},r.a.createElement(C.a,{src:Q(e._id,e.image),size:20,style:{marginRight:"10px"}}),e.name," - (",e._id,")")})),y=_.a.useForm(),E=Object(g.a)(y,1)[0];return!e.perkId||s?r.a.createElement(r.a.Fragment,null,r.a.createElement(_.a,Object.assign({form:E,name:"dynamic_form_nest_item",onFinish:d,autoComplete:"off",initialValues:s||{}},{labelCol:{span:8},wrapperCol:{span:16}}),r.a.createElement(_.a.Item,{name:"images",label:"Images",valuePropName:"images",getValueFromEvent:function(e){return Array.isArray(e)?e:e&&e.fileList.map(function(e){return e.url})}},r.a.createElement(Ue.a,{listType:"picture-card",fileList:m.map(function(e,t){return Object(Ce.a)({},e,{uid:t})}),onPreview:function(e){o(e.url)},onChange:function(e){var t=e.fileList;return p(t)},customRequest:function(e){var t=e.file;f(t)}},m.length>=8?null:r.a.createElement("div",null,r.a.createElement(Ge.a,null),r.a.createElement("div",{className:"ant-upload-text"},"Upload")))),r.a.createElement(_.a.Item,{label:"Name",name:"name",rules:Qe},r.a.createElement(x.a,{placeholder:"New item"})),r.a.createElement(_.a.Item,{label:"Description",name:"description",rules:Ze},r.a.createElement(x.a.TextArea,{placeholder:"Write a few words about this item."})),"shop"===e.mode&&r.a.createElement(_.a.Item,{label:"Available for",name:"users"},h),"shop"===e.mode&&r.a.createElement(_.a.Item,{label:"Price",name:"price",rules:Xe},r.a.createElement(Be.a,null)),r.a.createElement(_.a.Item,{wrapperCol:{offset:8,span:16}},r.a.createElement(v.a,{type:"primary",htmlType:"submit",size:"large"},"Save"),l&&r.a.createElement(He.a,{title:"Are you sure you want to delete this item?",onConfirm:u,onCancel:function(){},okText:"Confirm",cancelText:"Cancel"},r.a.createElement(v.a,{type:"link",danger:!0,size:"large"},"Delete")))),r.a.createElement(je.a,{visible:i,footer:null,onCancel:function(){return o("")}},r.a.createElement("img",{alt:"example",style:{width:"100%"},src:i}))):null},tt=function(e,t,a,n,r,i){be&&1===be.readyState&&be.send(JSON.stringify({messageCode:"sendMessage",messageValue:a,imageUrl:n,postId:t,accountId:e,replyToMessage:r,editedMessage:i}))},at=function(e,t,a,n){be&&1===be.readyState&&be.send(JSON.stringify({messageCode:e,messageId:t,accountId:a,postId:n}))},nt=function(e,t,a,n,r){be&&1===be.readyState&&be.send(JSON.stringify({messageCode:"addPost",accountId:e,parentId:t,parentType:a,messageValue:n,imageUrl:r}))},rt=function(e,t,a){a&&e&&t&&be&&1===be.readyState&&be.send(JSON.stringify({messageCode:"buyPerk"===mode,perkId:a,buyer:e,seller:t}))},it=function(e,t){be&&1===be.readyState&&be.send(JSON.stringify({messageCode:"unfriend",accountId:e,friendId:t}))},ot=Object(f.g)(Object(u.b)(function(e){return{account:e.account,friendData:e.friendData}})(function(e){var t=Object(n.useState)(),a=Object(g.a)(t,2),i=a[0],o=a[1],c=Object(n.useState)([]),l=Object(g.a)(c,2),s=l[0],u=l[1],d=e.account,m=e.mode,p=e.perkId||"";Object(n.useEffect)(function(){if(p){var e="wishlist"===m?d.wishlist.find(function(e){return e.itemId===p}):"goals"===m?d.goals.find(function(e){return e.goalId===p}):d.perks.find(function(e){return e.perkId===p});e&&(o(e),u(e.images.map(function(e,t){return{url:e,uid:t}})))}},[]);var f=d.friends.filter(function(e){return"friend"===e.status}).map(function(t){return e.friendData[t.friend]});return!e.perkId||i?r.a.createElement(et,{connections:f,perkId:p,perk:i,deletePerk:function(){!function(e,t,a){e&&t&&be&&1===be.readyState&&be.send(JSON.stringify({messageCode:"wishlist"===a?"deleteWishlistItem":"goals"===a?"deleteGoal":"deletePerk",id:t,accountId:e}))}(d._id,p,m),e.setEditPerkOpen(!1)},onFinish:function(t){var a=Object(Ce.a)({},t,{images:s.map(function(e){return e.url})});!function(e,t,a,n){e&&be&&1===be.readyState&&be.send(JSON.stringify({messageCode:"wishlist"===n?"saveWishlistItem":"goals"===n?"saveGoal":"savePerk",id:t,value:a,accountId:e}))}(d._id,p,a,m),e.setEditPerkOpen(!1)},images:s,setImages:u,uploadImage:function(e){Pe(e,800,void 0,function(e){u([].concat(Object(he.a)(s),[{url:e}]).map(function(e,t){return Object(Ce.a)({},e,{uid:t})}))})},mode:e.mode}):null})),ct=a(15),lt=a(348),st=a.n(lt),ut=a(349),dt=a.n(ut),mt=ct.a.Meta,pt=Object(f.g)(function(e){var t=e.perk,a=e.perkId,n=e.owner,i=e.account,o=e.setEditedPerk,c=e.setEditPerkOpen,l=e.mode;return r.a.createElement(ct.a,{type:"inner",style:{width:200,display:"inline-block",margin:"4px 8px"},hoverable:!0,cover:r.a.createElement("div",{onClick:function(){return e.history.push("/".concat(l||"shop","/").concat(n._id,"/").concat(a))},style:{backgroundImage:"url("+(t.images.length>0&&t.images[0])+")",height:200,width:200,backgroundSize:"cover"}}),actions:[].concat(Object(he.a)(n._id!==i._id||e.onlyBuy?[]:[r.a.createElement(S.a,{title:"Edit"},r.a.createElement("span",{key:"1",onClick:function(){o(a),c(!0)}},r.a.createElement(st.a,{style:{fontSize:"18px"}})))]),Object(he.a)("shop"===e.mode?[r.a.createElement(S.a,{title:"Buy"},r.a.createElement("span",{key:"1",onClick:function(){return rt(i._id,n._id,a)}},r.a.createElement(dt.a,{style:{fontSize:"18px"}})))]:[]))},r.a.createElement(mt,{title:t.name,description:t.price}))}),ft=a(137),gt=a.n(ft),ht=a(173),yt=function(e){return r.a.createElement("span",{onClick:e.action},r.a.createElement(ct.a,{type:"inner",style:{width:200,display:"inline-block",margin:"4px 8px"},hoverable:!0,cover:r.a.createElement("div",{style:{height:200,width:200,backgroundSize:"cover",display:"flex",alignItems:"center",justifyContent:"center"},onClick:e.action},r.a.createElement(gt.a,{style:{fontSize:"60px"}})),actions:[r.a.createElement(S.a,{title:"Add item"},r.a.createElement("span",{key:"3",onClick:e.action},r.a.createElement(gt.a,{style:{fontSize:"18px"}})))]},r.a.createElement(ht.a,{title:r.a.createElement("span",{onClick:e.action,style:{cursor:"pointer"}},e.title),description:"undefined"!==typeof e.sub&&e.sub})))},vt=function(e){var t=Object(n.useState)(""),a=Object(g.a)(t,2),i=a[0],o=a[1],c=Object(n.useState)(),l=Object(g.a)(c,2),s=l[0],u=l[1],d=e.account,m=r.a.createElement(je.a,{title:"Add item",visible:s,maskClosable:!0,closable:!0,onCancel:function(){return u(!1)},width:"90%",footer:r.a.createElement(v.a,{key:"back",onClick:function(){return u(!1)}},"Close"),destroyOnClose:!0},r.a.createElement(ot,{setEditPerkOpen:u,perkId:i,mode:e.mode}));return d._id?r.a.createElement(r.a.Fragment,null,r.a.createElement(yt,{action:function(){o(""),u(!0)},title:"Add item",sub:"shop"===e.mode&&"Set price"}),d[e.listKey||e.mode]&&d[e.listKey||e.mode].map(function(t,a){return r.a.createElement(pt,{key:a,perk:t,perkId:"wishlist"===e.mode||"goals"===e.mode?t.itemId:t.perkId,owner:d,account:d,setEditedPerk:o,setEditPerkOpen:u,mode:e.mode})}),m):null},Et=Object(f.g)(Object(u.b)(function(e){return{account:e.account}},function(e){return{setPageTitle:function(t){return e(le(t))}}})(function(e){return Object(n.useEffect)(function(){e.setPageTitle({main:"Goals",sub:""})},[]),e.account._id?r.a.createElement(vt,{mode:"goals",account:e.account}):r.a.createElement("span",null)})),bt=function(e,t,a,n,r){console.log("reqas"),s.a.get("/api"+e.history.location.pathname).then(function(t){ae(t,e),a(t.data),r(t.data)}).catch(function(e){})},kt=a(109),wt=a(185),Ot=a(350),_t=a.n(Ot),xt=a(351),Dt=a.n(xt),St=a(175),jt=a.n(St),Ct=a(110),It=a.n(Ct),Tt=a(174),At=a.n(Tt),Pt=Object(f.g)(function(e){var t=Object(n.useState)(!1),a=Object(g.a)(t,2),i=a[0],o=a[1],c=e.post,l=e.account,s=Object(n.useState)(e.content||(e.replyToUser?"@"+e.replyToUser+" ":"")),u=Object(g.a)(s,2),d=u[0],m=u[1];return Object(n.useEffect)(function(){console.log(e.replyToUser),m(e.content||(e.replyToUser?"@"+e.replyToUser+" ":""))},[e.replyToUser,e.content]),c&&l._id?r.a.createElement("div",{style:Object(Ce.a)({background:"#fff",padding:"0px 10px",boxShadow:"0 4px 5px 0 rgba(0, 0, 0, 0.14), 0 -1px 10px 0 rgba(0, 0, 0, 0.12), 0 2px 4px -1px rgba(0, 0, 0, 0.2)"},e.replyTo?{}:{width:"100%",bottom:"-200px",left:"0px",position:"absolute"})},r.a.createElement(kt.a,{avatar:r.a.createElement(C.a,{src:Q(l._id,l.image)}),content:r.a.createElement(r.a.Fragment,null,r.a.createElement(_.a.Item,{rules:$e},r.a.createElement(x.a.TextArea,{autoSize:{minRows:1,maxRows:3},rows:1,onChange:function(e){return m(e.target.value)},value:d})),r.a.createElement(_.a.Item,null,r.a.createElement(v.a,{htmlType:"submit",onClick:function(){tt(l._id,c._id,d,!1,e.replyTo,e.editingMessage),m(""),e.onSend&&e.onSend()},icon:r.a.createElement(At.a,null),size:"large",type:"link"}),r.a.createElement(Ue.a,{showUploadList:!1,customRequest:function(t){var a=t.file;o(!0),Pe(a,800,void 0,function(t){o(!1),tt(state,e,"",t,e.replyTo,e.editingMessage),e.onSend&&e.onSend()})}},r.a.createElement(v.a,{size:"large",type:"link",icon:i?r.a.createElement(It.a,null):r.a.createElement(jt.a,null)}))))})):null}),Ft=Object(f.g)(function e(t){var a=t.account,i=t.state,o=t.setState,c=t.message,l=t.friendData,s=t.post,u=t.replies,d=Object(n.useState)(!1),m=Object(g.a)(d,2),p=m[0],f=m[1],h=Object(n.useState)(""),y=Object(g.a)(h,2),v=y[0],E=y[1],b=Object(n.useState)(""),k=Object(g.a)(b,2),w=k[0],O=k[1],_={actions:!t.isStart&&[r.a.createElement("span",{key:"comment-basic-like"},r.a.createElement(S.a,{title:"Like"},c.likes.includes(a._id)?r.a.createElement(_t.a,{onClick:function(){return at("dislikeMessage",c.messageId,a._id,s._id)}}):r.a.createElement(Dt.a,{onClick:function(){return at("likeMessage",c.messageId,a._id,s._id)}})),r.a.createElement("span",{style:{paddingLeft:"8px"}},c.likes.length)),r.a.createElement("span",{key:"comment-basic-reply-to",onClick:function(){t.setReplyVisible?(t.setReplyVisible(!0),t.setReplyToUser(t.message.author)):(f(!0),E(""))}},"Reply to"),r.a.createElement("span",{key:"comment-basic-reply-to",onClick:function(){return O(c.messageId)}},"Edit")],author:r.a.createElement("a",null,l[c.author]?l[c.author].name+" ("+c.author+")":c.author),avatar:r.a.createElement(C.a,{src:"https://websiter.s3.us-east-2.amazonaws.com/"+c.author+"/avatar"}),content:"message"===c.action?r.a.createElement("p",null,c.text):"image"===c.action?r.a.createElement("div",{style:{backgroundImage:"url("+c.text+")",width:"200px",height:"200px",backgroundSize:"cover",cursor:"pointer"},onClick:function(){return o(Object(Ce.a)({},i,{previewImage:c.text}))}}):null,datetime:r.a.createElement("span",null,r.a.createElement(wt.a,{datetime:c.date,live:!0}))};return a&&l?a._id===c.author&&w?r.a.createElement(Pt,{post:s,account:a,replyTo:c.messageId,editingMessage:w,content:c.text,onSend:function(){return O("")}}):r.a.createElement(ct.a,null,r.a.createElement(kt.a,_,t.isTop&&u&&u.length?u.map(function(t,n){return r.a.createElement(e,{key:n,message:t,post:s,account:a,friendData:l,setReplyVisible:f,setReplyToUser:E})}):null,t.isTop&&p?r.a.createElement(Pt,{post:s,account:a,replyTo:c.messageId,replyToUser:v}):null)):null}),Rt=a(778),Nt=a(779),Mt=Object(f.g)(function(e){var t=e.post,a=e.account,n=e.friendData;return t?r.a.createElement(r.a.Fragment,null,!e.noStartMessage&&r.a.createElement(Ft,{message:t.startMessage,post:t,account:a,friendData:n,replies:[],isStart:!0}),r.a.createElement("div",{style:{textAlign:"left",marginBottom:"200px",position:"relative"}},r.a.createElement("div",null,r.a.createElement("span",{key:"comment-basic-like"},r.a.createElement(S.a,{title:"Like"},t.startMessage.likes.includes(a._id)?r.a.createElement(Rt.a,{onClick:function(){return at("dislikeMessage",t.startMessage.messageId,a._id,t._id)}}):r.a.createElement(Nt.a,{onClick:function(){return at("likeMessage",t.startMessage.messageId,a._id,t._id)}})),r.a.createElement("span",{style:{paddingLeft:"8px"}},t.startMessage.likes.length)),r.a.createElement("span",null,r.a.createElement("span",{key:"comment-basic-reply-to",onClick:function(){}},"Comment"),r.a.createElement("span",{style:{paddingLeft:"8px"}},function(e){var t=0,a=!0,n=!1,r=void 0;try{for(var i,o=e[Symbol.iterator]();!(a=(i=o.next()).done);a=!0)t=t+1+i.value.replies.length}catch(c){n=!0,r=c}finally{try{a||null==o.return||o.return()}finally{if(n)throw r}}return t}(t.messages)))),t.messages&&t.messages.length?t.messages.map(function(e,i){return r.a.createElement(Ft,{key:i,message:e,post:t,account:a,friendData:n,replies:e.replies,isTop:!0})}):null,r.a.createElement(Pt,{post:t,account:a}))):null}),zt=Object(f.g)(Object(u.b)(function(e){return{isAuthed:e.isAuthed,account:e.account,post:e.post,friendData:e.friendData}},function(e){return{setData:function(t){e(ce(t))},setPageTitle:function(t){return e(le(t))}}})(function(e){var t=Object(n.useState)(""),a=Object(g.a)(t,2),i=a[0],o=a[1],c=Object(n.useState)({}),l=Object(g.a)(c,2),s=l[0],u=l[1];if(Object(n.useEffect)(function(){bt(e,0,u)},[e.isAuthed]),!s.goal)return null;var d=s.goal,m=s.profile;return e.setData({currentPosts:d.post}),d&&e.setPageTitle({main:d.name,sub:m._id}),d?r.a.createElement(ct.a,{title:r.a.createElement("span",null,"Goal from"," ",r.a.createElement(v.a,{type:"link",style:{padding:0},onClick:function(){return e.history.push("/profile/"+m._id)}},r.a.createElement(C.a,{src:Q(m._id,m.image),style:{marginRight:"5px"}}),m.name+" ("+m._id+")")," ","goals")},d.images.map(function(e){return r.a.createElement("span",{onClick:function(){return o(e)}},r.a.createElement(ct.a,{type:"inner",style:{width:200,display:"inline-block"},hoverable:!0,cover:r.a.createElement("div",{style:{backgroundImage:"url("+e+")",height:200,width:200,backgroundSize:"cover"}})}))}),r.a.createElement("h1",null,d.name),r.a.createElement("p",null,d.description),r.a.createElement(Mt,{noStartMessage:!0,post:e.post[d.post],account:e.account,friendData:e.friendData}),r.a.createElement(je.a,{visible:i,footer:null,onCancel:function(){return o("")}},r.a.createElement("img",{alt:"example",style:{width:"100%"},src:i}))):null})),Bt=a(40),Lt=a(72),Ut=ct.a.Meta,Vt=Object(f.g)(function(e){var t=e.progress,a=t.goal;return r.a.createElement("div",{style:{display:"inline-block",margin:"4px 8px"},onClick:function(){return e.history.push("/progresses/"+t._id)}},r.a.createElement(ct.a,{type:"inner",style:{width:200},hoverable:!0,cover:r.a.createElement("div",{onClick:function(){return e.history.push("/progresses/"+t._id)},style:{backgroundImage:a&&"url("+(a.images.length>0&&a.images[0])+")",height:200,width:200,backgroundSize:"cover"}})},a&&r.a.createElement(r.a.Fragment,null,r.a.createElement(Ut,{title:a.name}),r.a.createElement(Ut,{title:"Made by "+t.worker,description:"In goal by "+t.owner}))))}),Gt=a(61),Ht=a(366),Jt=a(86),qt=a(138),Wt=a.n(qt),Kt=a(352),Qt=a.n(Kt),Yt=function(e,t,a,n){return r.a.createElement(Le.a,{mode:"multiple",style:{width:"100%"},placeholder:"Please select",value:a,onSelect:n},[e].concat(Object(he.a)(e.friends.filter(function(e){return"friend"===e.status}).map(function(e){return t[e.friend]}))).map(function(e){return r.a.createElement(Le.a.Option,{key:e._id},r.a.createElement(C.a,{src:Q(e._id,e.image),size:20,style:{marginRight:"10px"}}),e.name," - (",e._id,")")}))},Zt=a(55),$t=Object(f.g)(Object(u.b)(function(e){return{isAuthed:e.isAuthed,account:e.account,friendData:e.friendData,progress:e.progress}})(function(e){var t=Object(n.useState)(""),a=Object(g.a)(t,2),i=a[0],o=a[1],c=Object(n.useState)(),l=Object(g.a)(c,2),s=l[0],u=l[1],d=Object(n.useState)(),m=Object(g.a)(d,2),p=m[0],f=m[1],h=Object(n.useState)(),y=Object(g.a)(h,2),E=y[0],b=y[1],k=e.account,w=e.friendData,O=e.readOnly,D=e.progress,S=e.rewards.findIndex(function(t){return t.key===e.rewardKey});return-1===S&&e.setRewards&&e.setRewards([].concat(Object(he.a)(e.rewards),[{key:e.rewardKey,rewards:[]}])),S>=0?r.a.createElement("div",null,r.a.createElement(_.a.Item,{label:e.label,key:e.rewardKey},r.a.createElement("ol",null,e.rewards[S].rewards.map(function(t,a){return console.log(t),console.log(t.owner),console.log(k._id),console.log(!O),r.a.createElement("li",null,r.a.createElement(v.a,{type:"link",onClick:function(){return u(t)}},"simple"===t.mode?t.simple:"money"===t.mode?t.money+" (money)":"item"===t.mode?t.itemName:""),"for ",t.for," from ",t.owner,t.owner===k._id&&!O&&r.a.createElement(r.a.Fragment,null,r.a.createElement(v.a,{type:"link",onClick:function(){b(a),f(t)}},r.a.createElement(Qt.a,null)),r.a.createElement(He.a,{title:"Are you sure you want to delete this item?",onConfirm:function(){if(e.setRewards){var n=Object(he.a)(e.rewards);n[S]=Object(Ce.a)({},n[S],{rewards:n[S].rewards.filter(function(e,t){return t!==a})}),e.setRewards(n)}else r=k._id,i=D._id,o=e.rewardKey,c=t.rewardId,be&&1===be.readyState&&be.send(JSON.stringify({messageCode:"deleteReward",accountId:r,progressId:i,rewardKey:o,rewardId:c}));var r,i,o,c},onCancel:function(){},okText:"Confirm",cancelText:"Cancel"},r.a.createElement(v.a,{type:"link",danger:!0},r.a.createElement(Wt.a,null)))))})),!O&&r.a.createElement(v.a,{type:"link",onClick:function(){b("new"),f({mode:"simple"})}},r.a.createElement(Ge.a,null),"Add rewards")),r.a.createElement(je.a,{visible:p,title:"new"===p?"Add new reward":"Edit reward",closable:!0,onCancel:function(){return f()},onOk:function(){var t,a,n,r,i={};if("money"===p.mode?(i.money=p.money,i.mode=p.mode,i.for=p.for,i.rewardId=p.rewardId):i=Object(Ce.a)({},p,{money:void 0}),i.owner=k._id,e.setRewards){var o=Object(he.a)(e.rewards);o[S]="new"===E?Object(Ce.a)({},o[S],{rewards:[].concat(Object(he.a)(o[S].rewards),[i])}):Object(Ce.a)({},o[S],{rewards:o[S].rewards.map(function(e,t){return t===E?i:e})}),e.setRewards(o),f(),b()}else t=k._id,a=D._id,n=e.rewardKey,r=i,be&&1===be.readyState&&be.send(JSON.stringify({messageCode:"saveReward",accountId:t,progressId:a,rewardKey:n,reward:r}))},destroyOnClose:!0,okText:"Save"},p&&r.a.createElement(r.a.Fragment,null,r.a.createElement(_.a.Item,{label:"Reward type"},r.a.createElement(Le.a,{placeholder:"Type",value:p.mode,onSelect:function(e){f(Object(Ce.a)({},p,{mode:e}))},style:{width:"100%"}},r.a.createElement(Le.a.Option,{key:"simple",value:"simple"},"Simple reward"),r.a.createElement(Le.a.Option,{key:"item",value:"item"},"Item reward"),r.a.createElement(Le.a.Option,{key:"money",value:"money"},"Money reward"))),r.a.createElement(_.a.Item,{label:"Reward for"},Yt(k,w,p.for,function(e){f(Object(Ce.a)({},p,{for:e}))}),r.a.createElement("p",null,"(leave blank for all)")),r.a.createElement(Jt.a,{type:"horizontal"}),"simple"===p.mode?r.a.createElement(_.a.Item,{label:"Description",rules:[].concat(Object(he.a)(Ze),[{required:!0,min:1,whitespace:!0,message:"Desription is too short. Minimal length is 1."}])},r.a.createElement(x.a.TextArea,{value:p.simple,onChange:function(e){var t=e.target.value;return f(Object(Ce.a)({},p,{simple:t}))},placeholder:"Explain how you will reward"})):"money"===p.mode?r.a.createElement(_.a.Item,{label:"Amount",rules:Xe},r.a.createElement(Be.a,{value:p.money,onChange:function(e){f(Object(Ce.a)({},p,{money:e}))}})):r.a.createElement(r.a.Fragment,null,r.a.createElement(_.a.Item,{label:"Images"},r.a.createElement(Ue.a,{listType:"picture-card",fileList:(p.itemImages||[]).map(function(e,t){return{url:e,uid:t}}),onPreview:function(e){o(e.url)},onChange:function(e){var t=e.fileList;console.log(t),f(Object(Ce.a)({},p,{itemImages:t.map(function(e){return e.url})}))},customRequest:function(e){var t=e.file;Pe(t,800,void 0,function(e){f(Object(Ce.a)({},p,{itemImages:[].concat(Object(he.a)(p.itemImages||[]),[e])}))})}},(p.itemImages||[]).length>=8?null:r.a.createElement("div",null,r.a.createElement(Ge.a,null),r.a.createElement("div",{className:"ant-upload-text"},"Upload")))),r.a.createElement(_.a.Item,{label:"Name",rules:Qe},r.a.createElement(x.a,{value:p.itemName,onChange:function(e){var t=e.target.value;return f(Object(Ce.a)({},p,{itemName:t}))}})),r.a.createElement(_.a.Item,{label:"Description",rules:Ze},r.a.createElement(x.a.TextArea,{value:p.itemDescription,onChange:function(e){var t=e.target.value;return f(Object(Ce.a)({},p,{itemDescription:t}))}}))))),r.a.createElement(je.a,{visible:i,footer:null,onCancel:function(){return o("")}},r.a.createElement("img",{alt:"example",style:{width:"100%"},src:i})),r.a.createElement(je.a,{visible:s,footer:null,onCancel:function(){return u()},title:"Reward details"},s?r.a.createElement(r.a.Fragment,null,s.itemImages&&s.itemImages.map(function(e,t){return r.a.createElement("span",{key:t,onClick:function(){return o(e)}},r.a.createElement(Card,{type:"inner",style:{width:200,display:"inline-block"},hoverable:!0,cover:r.a.createElement("div",{style:{backgroundImage:"url("+e+")",height:200,width:200,backgroundSize:"cover"}})}))}),r.a.createElement(Zt.a,{title:"Reward description",bordered:!0,column:{xxl:4,xl:3,lg:3,md:3,sm:2,xs:1}},"item"===s.mode&&r.a.createElement(Zt.a.Item,{label:"Name"},s.itemName),"item"===s.mode&&r.a.createElement(Zt.a.Item,{label:"Description"},s.itemDescription),"simple"===s.mode&&r.a.createElement(Zt.a.Item,{label:"Description"},s.simple),"money"===s.mode&&r.a.createElement(Zt.a.Item,{label:"Money"},s.money))):null)):null})),Xt=a(232),ea=a(777),ta=a(367),aa=function(e){function t(){return Object(de.a)(this,t),Object(pe.a)(this,Object(fe.a)(t).apply(this,arguments))}return Object(ge.a)(t,e),Object(me.a)(t,[{key:"render",value:function(){var e=this.props;return(0,e.connectDragSource)((0,e.connectDropTarget)(e.children))}}]),t}(r.a.Component),na=Object(Xt.DropTarget)("DND_NODE",{drop:function(e,t){var a=t.getItem().index,n=e.index;a!==n&&(e.moveTabNode(a,n),t.getItem().index=n)}},function(e){return{connectDropTarget:e.dropTarget()}})(Object(Xt.DragSource)("DND_NODE",{beginDrag:function(e){return{id:e.id,index:e.index}}},function(e,t){return{connectDragSource:e.dragSource(),isDragging:t.isDragging()}})(aa)),ra=function(e){function t(){var e,a;Object(de.a)(this,t);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(a=Object(pe.a)(this,(e=Object(fe.a)(t)).call.apply(e,[this].concat(i)))).state={order:[]},a.moveTabNode=function(e,t){var n=a.state.order.slice(),i=a.props.children;r.a.Children.forEach(i,function(e){-1===n.indexOf(e.key)&&n.push(e.key)});var o=n.indexOf(e),c=n.indexOf(t);n.splice(o,1),n.splice(c,0,e),a.setState({order:n})},a.renderTabBar=function(e,t){return r.a.createElement(t,e,function(e){return r.a.createElement(na,{key:e.key,index:e.key,moveTabNode:a.moveTabNode},e)})},a}return Object(ge.a)(t,e),Object(me.a)(t,[{key:"render",value:function(){var e=this.state.order,t=this.props.children,a=[];r.a.Children.forEach(t,function(e){a.push(e)});var n=a.slice().sort(function(t,n){var r=e.indexOf(t.key),i=e.indexOf(n.key);return-1!==r&&-1!==i?r-i:-1!==r?-1:-1!==i?1:a.indexOf(t)-a.indexOf(n)});return r.a.createElement(ea.a,{backend:ta.a},r.a.createElement(Bt.a,Object.assign({renderTabBar:this.renderTabBar},this.props),n))}}]),t}(r.a.Component),ia=function(e){var t=e.goal,a=e.account,i=e.friendData,o=Object(n.useState)(t&&t.milestones||[{name:"Milestone 1",key:"mile1"}]),c=Object(g.a)(o,2),l=c[0],s=c[1],u=Object(n.useState)("mile1"),d=Object(g.a)(u,2),m=d[0],p=d[1],f=Object(n.useState)(t&&t.images.map(function(e,t){return{url:e,uid:t}})||[]),h=Object(g.a)(f,2),y=h[0],E=h[1],b=Object(n.useState)(t&&t.withMilestones),k=Object(g.a)(b,2),w=k[0],O=k[1],D=Object(n.useState)(""),S=Object(g.a)(D,2),j=S[0],C=S[1],I=Object(n.useState)(t&&t.newTabIndex||2),T=Object(g.a)(I,2),A=T[0],P=T[1],F=Object(n.useState)(t&&t.rewardsGroups||[]),R=Object(g.a)(F,2),N=R[0],M=R[1],z=function(){var e=Object(he.a)(l),t="mile".concat(A);e.push({key:t,name:"New milestone"}),s(e),p(t),P(A+1)},B=function(e){var t,a=m;l.forEach(function(a,n){a.key===e&&(t=n-1)});var n=l.filter(function(t){return t.key!==e});n.length&&a===e&&(a=t>=0?n[t].key:n[0].key),s(n),p(a)},L=_.a.useForm(),U=Object(g.a)(L,1)[0];return!e.goalId||t?r.a.createElement(r.a.Fragment,null,r.a.createElement(_.a,Object.assign({form:U,name:"dynamic_form_nest_item",onFinish:function(t){var a=[],n=!0,r=!1,i=void 0;try{for(var o,c=l[Symbol.iterator]();!(n=(o=c.next()).done);n=!0){var s=o.value;a.push(Object(Ce.a)({},t[s.key],{key:s.key,name:s.name}))}}catch(u){r=!0,i=u}finally{try{n||null==c.return||c.return()}finally{if(r)throw i}}e.onFinish(Object(Ce.a)({},t,{images:y.map(function(e){return e.url}),milestones:l,milestonesValues:a,newTabIndex:A,rewardsGroups:N}))},autoComplete:"off",initialValues:t||{name:"New goal",mile1:{name:"Milestone 1",key:"mile1"}}},{labelCol:{span:8},wrapperCol:{span:16}},{onValuesChange:function(e){var t=function(t){var a=l.findIndex(function(e){return e.key===t});if(a>-1&&e[t].name){var n=Object(he.a)(l);n[a]=Object(Ce.a)({},n[a],{name:e[t].name}),s(n)}"withMilestones"===t&&O(e[t])};for(var a in e)t(a)}}),r.a.createElement(_.a.Item,{name:"images",label:"Images",valuePropName:"images",getValueFromEvent:function(e){return Array.isArray(e)?e:e&&e.fileList.map(function(e){return e.url})}},r.a.createElement(Ue.a,{listType:"picture-card",fileList:y.map(function(e,t){return Object(Ce.a)({},e,{uid:t})}),onPreview:function(e){C(e.url)},onChange:function(e){var t=e.fileList;return E(t)},customRequest:function(e){var t=e.file;Pe(t,800,void 0,function(e){E([].concat(Object(he.a)(y),[{url:e}]).map(function(e,t){return Object(Ce.a)({},e,{uid:t})}))})}},y.length>=8?null:r.a.createElement("div",null,r.a.createElement(Ge.a,null),r.a.createElement("div",{className:"ant-upload-text"},"Upload")))),r.a.createElement(_.a.Item,{label:"Name",name:"name",rules:Qe},r.a.createElement(x.a,null)),r.a.createElement(_.a.Item,{label:"Description",name:"description",rules:Ze},r.a.createElement(x.a.TextArea,{autoSize:{minRows:4,maxRows:20},placeholder:"Write a few words about why this goal is important and how to achieve it."})),r.a.createElement(_.a.Item,{label:"Achievers",name:"users"},Yt(a,i)),r.a.createElement(_.a.Item,{label:"Experts",name:"experts"},Yt(a,i)),r.a.createElement(_.a.Item,{label:"Supporters",name:"supporters"},Yt(a,i)),r.a.createElement($t,{rewardKey:"start",label:"Start rewards",rewards:N,setRewards:M}),r.a.createElement($t,{rewardKey:"finish",label:"Finish rewards",rewards:N,setRewards:M}),r.a.createElement(_.a.Item,{label:"Milestones",name:"withMilestones",valuePropName:"checked"},r.a.createElement(Ht.a,null)),w&&r.a.createElement(r.a.Fragment,null,r.a.createElement(Jt.a,null,"Milestones"),r.a.createElement(ra,{tabPosition:"left",type:"editable-card",onChange:function(e){p(e)},activeKey:m||"mile1",onEdit:function(e,t){"add"===t?z(e):B(e)}},l.map(function(e){return r.a.createElement(Bt.a.TabPane,{tab:e.name,key:e.key},r.a.createElement(_.a.Item,{label:"Name",name:[e.key,"name"],rules:Qe},r.a.createElement(x.a,null)),r.a.createElement(_.a.Item,{label:"Description",name:[e.key,"description"],rules:Ze},r.a.createElement(x.a.TextArea,{placeholder:"Write a few words about why this milestone is important and how to achieve it."})),r.a.createElement($t,{rewardKey:e.key,label:"Rewards",rewards:N,setRewards:M}))}))),r.a.createElement(_.a.Item,{wrapperCol:{offset:8,span:16}},r.a.createElement(v.a,{type:"primary",htmlType:"submit",size:"large"},"Save"))),r.a.createElement(je.a,{visible:j,footer:null,onCancel:function(){return C("")}},r.a.createElement("img",{alt:"example",style:{width:"100%"},src:j}))):null},oa=function(e){return e.account._id?r.a.createElement(ia,{onFinish:function(t){!function(e,t){be&&1===be.readyState&&be.send(JSON.stringify({messageCode:"startProgress",accountId:e,value:t}))}(e.account._id,t),e.setStartProgressVisible(!1)},account:e.account,friendData:e.friendData}):null},ca=Bt.a.TabPane,la=Object(f.g)(Object(u.b)(function(e){return{account:e.account,isAuthed:e.isAuthed,progressData:e.progressData,groupData:e.groupData}},function(e){return{setData:function(t,a){return e(ce(t))},setPageTitle:function(t){return e(le(t))},tryAuth:function(t,a){return e(re(t,a))}}})(function(e){e.setPageTitle({main:"Progresses",sub:""});var t,a,i=e.progressData,o=e.account,c=e.groupData,l=o.progresses,s=o.groups,u=Object(n.useState)(!1),d=Object(g.a)(u,2),m=d[0],p=d[1];l&&(t=l.filter(function(e){return i[e]}).map(function(e){return i[e]}),a=s.filter(function(e){return c[e]&&c[e].active}).map(function(e){return c[e]}));var f=r.a.createElement(Gt.a,{title:"Add goal",visible:m,maskClosable:!0,closable:!0,onCancel:function(){return p(!1)},width:"90%",footer:r.a.createElement(v.a,{key:"back",onClick:function(){return p(!1)}},"Close"),destroyOnClose:!0},r.a.createElement(oa,{setStartProgressVisible:p,account:o,friendData:e.friendData}));return t&&a?r.a.createElement(Bt.a,{style:{background:"transparent",boxShadow:"none",margin:"0",marginTop:"-15px"}},r.a.createElement(ca,{tab:"Progresses",key:"1"},r.a.createElement(yt,{title:"Start a new progress",sub:"Rich your goals or help others!",action:function(){p(!0)}}),t.map(function(e,t){return r.a.createElement(Vt,{key:t,progress:e})}),f),r.a.createElement(ca,{tab:"Groups",key:"2"},a.length>0?a.map(function(e,t){return r.a.createElement(Vt,{key:t,group:e})}):r.a.createElement(Lt.a,{imageStyle:{height:160},description:r.a.createElement("span",null,"Here you will find your groups. Groups can be created in existing progresses.")}))):null})),sa=a(181),ua=Zt.a.Item,da=function(e){var t=e.progress,a=e.account,n=e.state,i=e.setState,o=t.goal,c=o.rewardsGroups,l=function(t){var a=t.checked,n=t.milestoneId,i=t.disabled;return r.a.createElement(h.a,{checked:a,onChange:function(t){return function(e,t,a){be&&1===be.readyState&&be.send(JSON.stringify({messageCode:"changeStage",milestoneId:a,value:t,progressId:e.progress._id,accountId:e.account._id}))}(e,t.target.checked,n)},disabled:i})},s=[{title:"Milestone",dataIndex:"name",key:"name",render:function(e){return r.a.createElement(v.a,{type:"link",onClick:function(){return i(Object(Ce.a)({},n,{previewMilestone:e}))}},e.name)}},{title:"Rewards",dataIndex:"rewards",key:"rewards",render:function(e){return r.a.createElement($t,{rewardKey:e,rewards:c})}},{title:"Status",dataIndex:"status",key:"status",render:function(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",null,e?"Paid:":"Not finished"),e&&r.a.createElement($t,{rewardKey:1,rewards:[{rewards:e,key:1}],readOnly:!0}))}}].concat(Object(he.a)(o.users.map(function(e){return{title:e+" (ach)",dataIndex:e,key:e,render:l}})),[{title:t.owner+" (own)",dataIndex:"owner",key:"owner",render:l}],Object(he.a)(o.experts.map(function(e){return{title:e+" (exp)",dataIndex:e,key:e,render:l}}))),u=function(e,t,n){return{checked:t.approvedBy.find(function(t){return t.accountId===e}),milestoneId:n.key,disabled:e!==a._id}},d=function(e,a){var n=t.stages.find(function(t){return t.milestoneId===e.key})||{approvedBy:[]},r={},i=!0,c=!1,l=void 0;try{for(var s,d=o.experts[Symbol.iterator]();!(i=(s=d.next()).done);i=!0){var m=s.value;r[m]=u(m,n,e)}}catch(b){c=!0,l=b}finally{try{i||null==d.return||d.return()}finally{if(c)throw l}}var p={},f=!0,g=!1,h=void 0;try{for(var y,v=o.users[Symbol.iterator]();!(f=(y=v.next()).done);f=!0){var E=y.value;p[E]=u(E,n,e)}}catch(b){g=!0,h=b}finally{try{f||null==v.return||v.return()}finally{if(g)throw h}}return Object(Ce.a)({key:a,name:e,rewards:e.key,status:n.paid},p,{owner:u(t.owner,n,e)},r)},m=[d({key:"start",name:"Start",description:"At this stage owner and user should agree to start this progress."},"start")].concat(Object(he.a)(o.withMilestones?o.milestonesValues.map(d):[]),[d({key:"finish",name:"Finish",description:"At this stage owner and user should agree to finish this progress."},"finish")]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(sa.a,{columns:s,dataSource:m}),r.a.createElement(je.a,{visible:n.previewMilestone,footer:null,onCancel:function(){return i(Object(Ce.a)({},n,{previewMilestone:""}))},closable:!0},n.previewMilestone?r.a.createElement(r.a.Fragment,null,r.a.createElement("h2",null,n.previewMilestone.name),r.a.createElement("p",null,n.previewMilestone.description),r.a.createElement(Zt.a,{title:"Milestone description",bordered:!0,column:{xxl:4,xl:3,lg:3,md:3,sm:2,xs:1}},r.a.createElement(ua,{label:"Rewards"},r.a.createElement($t,{rewardKey:n.previewMilestone.key,rewards:c,readOnly:!0})))):null))},ma=function(e){var t=e.progress,a=e.account,n=e.state,i=e.setState,o={},c=!0,l=!1,s=void 0;try{for(var u,d=t.goal.milestonesValues[Symbol.iterator]();!(c=(u=d.next()).done);c=!0){var m=u.value;o[m.key]=m}}catch(f){l=!0,s=f}finally{try{c||null==d.return||d.return()}finally{if(l)throw s}}var p=Object(Ce.a)({},t.goal,o);return p?r.a.createElement(ia,{goal:p,onFinish:function(t){!function(e,t){be&&1===be.readyState&&be.send(JSON.stringify({messageCode:"editGoalInProgress",progressId:e.progress._id,accountId:e.account._id,value:t}))}(e,t),i(Object(Ce.a)({},n,{editProgressOpen:!1}))},account:a}):null},pa=Zt.a.Item,fa=Object(f.g)(function(e){var t=e.account,a=e.progress,n=e.state,i=e.setState,o=a.goal;return o?r.a.createElement(r.a.Fragment,null,o.images.map(function(e,t){return r.a.createElement("span",{key:t,onClick:function(){return i(Object(Ce.a)({},n,{previewImage:e}))}},r.a.createElement(ct.a,{type:"inner",style:{width:200,display:"inline-block"},hoverable:!0,cover:r.a.createElement("div",{style:{backgroundImage:"url("+e+")",height:200,width:200,backgroundSize:"cover"}})}))}),r.a.createElement("h1",null,o.name),r.a.createElement("p",null,o.description),r.a.createElement(Zt.a,{title:"Goal description",bordered:!0,column:{xxl:4,xl:3,lg:3,md:3,sm:2,xs:1}},r.a.createElement(pa,{label:"Status"},a.status),r.a.createElement(pa,{label:"Worker"},o.users),r.a.createElement(pa,{label:"Owner"},a.owner),r.a.createElement(pa,{label:"Supporters"},o.supporters),r.a.createElement(pa,{label:"Experts"},o.experts),r.a.createElement(pa,{label:"With milestones"},o.withMilestones?"Yes":"No")),r.a.createElement(Jt.a,{orientation:"center",type:"horizontal"},"Milestones"),r.a.createElement(da,{progress:a,account:t,state:n,setState:i}),t._id===a.owner&&r.a.createElement(v.a,{style:{margin:"0px 20px 50px 0px"},type:"primary",onClick:function(){i(Object(Ce.a)({},n,{editProgressOpen:!0}))}},"Edit progress"),t._id===a.owner&&r.a.createElement(He.a,{title:"Create a group if you want to have more similar prgresses with the same people.",onConfirm:function(){return e=t._id,n=a._id,void(be&&1===be.readyState&&be.send(JSON.stringify({messageCode:"createGroup",progressId:n,accountId:e})));var e,n}},r.a.createElement(v.a,{style:{margin:"0px 20px 50px 0px"},type:"primary"},"Create a group")),t.progresses&&t.progresses.includes(a._id.toString())&&r.a.createElement(v.a,{danger:!0,onClick:function(){var t;t=e,be&&1===be.readyState&&be.send(JSON.stringify({messageCode:"leaveProgress",progressId:t.progress._id,accountId:t.account._id}))}},"Leave the progress"),r.a.createElement(je.a,{visible:n.editProgressOpen,footer:null,onCancel:function(){return i(Object(Ce.a)({},n,{editProgressOpen:!1}))},closable:!0,destroyOnClose:!0,width:"80%"},r.a.createElement(ma,{progress:a,account:t,state:n,setState:i}))):null}),ga=a(361),ha=a.n(ga),ya=Object(f.g)(function(e){var t=Object(n.useState)(!1),a=Object(g.a)(t,2),i=a[0],o=a[1],c=e.parent,l=e.account,s=e.parentType,u=Object(n.useState)(e.content||(e.replyToUser?"@"+e.replyToUser+" ":"")),d=Object(g.a)(u,2),m=d[0],p=d[1];return Object(n.useEffect)(function(){console.log(e.replyToUser),p(e.content||(e.replyToUser?"@"+e.replyToUser+" ":""))},[e.replyToUser,e.content]),l._id?r.a.createElement("div",{style:{background:"#fff",padding:"0px 10px",boxShadow:"0 4px 5px 0 rgba(0, 0, 0, 0.14), 0 -1px 10px 0 rgba(0, 0, 0, 0.12), 0 2px 4px -1px rgba(0, 0, 0, 0.2)",bottom:"0px",left:"0px",zIndex:1e3}},r.a.createElement("h2",null,"Post something new"),r.a.createElement(kt.a,{avatar:r.a.createElement(C.a,{src:Q(l._id,l.image)}),content:r.a.createElement(r.a.Fragment,null,r.a.createElement(_.a.Item,{rules:$e},r.a.createElement(x.a.TextArea,{autoSize:{minRows:1,maxRows:3},rows:1,onChange:function(e){return p(e.target.value)},value:m})),r.a.createElement(_.a.Item,null,r.a.createElement(v.a,{htmlType:"submit",onClick:function(){nt(l._id,c,s,m),p(""),e.onSend&&e.onSend()},icon:r.a.createElement(At.a,null),size:"large",type:"link"}),r.a.createElement(Ue.a,{showUploadList:!1,customRequest:function(t){var a=t.file;o(!0),Pe(a,800,void 0,function(t){o(!1),nt(l._id,c,s,m,t),e.onSend&&e.onSend()})}},r.a.createElement(v.a,{size:"large",type:"link",icon:i?r.a.createElement(It.a,null):r.a.createElement(jt.a,null)}))))})):null}),va=Object(f.g)(Object(u.b)(function(e){return{isAuthed:e.isAuthed,account:e.account,posts:e.post,progress:e.progress,friendData:e.friendData}},function(e){return{setData:function(t){e(ce(t))},setPageTitle:function(t){return e(le(t))}}})(function(e){var t=Object(n.useState)({}),a=Object(g.a)(t,2),i=a[0],o=a[1],c=e.history.location.pathname.split("/")[2];Object(n.useEffect)(function(){console.log(c),e.setData({currentProgress:c})},[e.isAuthed]);var l=e.progress,s=e.account,u=(e.profile,e.friendData),d=e.posts;if(!l._id)return null;e.setData({currentPosts:l.posts});var m=l.goal;return m&&e.setPageTitle({main:m.name,sub:l.worker}),m&&u?r.a.createElement(r.a.Fragment,null,r.a.createElement(v.a,{style:{position:"fixed",right:0,zIndex:1e3},type:"primary",onClick:function(){return o(Object(Ce.a)({},i,{activityOpen:!0}))}},"Show activity"),r.a.createElement(ya,{parent:c,account:s,parentType:"progress"}),l.posts.map(function(e){if(d[e]){var t=d[e];return r.a.createElement(ct.a,null,r.a.createElement(Mt,{friendData:u,account:s,post:t}))}return null}),r.a.createElement(I.a,{title:"Progress activity and settings",placement:"right",closable:!0,closeIcon:r.a.createElement(v.a,{type:"primary",icon:r.a.createElement(ha.a,null)},"Go back to posts"),onClose:function(){return o(Object(Ce.a)({},i,{activityOpen:!1}))},visible:i.activityOpen,width:"100%"},r.a.createElement(fa,{state:i,setState:o,progress:l,account:s})),r.a.createElement(je.a,{visible:i.previewImage,footer:null,onCancel:function(){return o(Object(Ce.a)({},i,{previewImage:""}))}},r.a.createElement("img",{alt:"example",style:{width:"100%"},src:i.previewImage}))):null})),Ea=ct.a.Meta,ba=Object(f.g)(Object(u.b)(function(e){return{account:e.account,isAuthed:e.isAuthed}},function(e){return{setPageTitle:function(t){return e(le(t))}}})(function(e){e.keepPageTitle||e.setPageTitle({main:"Shop",sub:"Wallet"});var t=e.pulledProfile||e.account;return t.wallet?t.wallet.map(function(t,a){return r.a.createElement("div",{onClick:function(){return e.history.push("/profile/"+t.user)},style:{display:"inline-block",margin:"4px 8px"}},r.a.createElement(ct.a,{key:a,type:"inner",style:{width:200},cover:r.a.createElement("span",{style:{padding:"25px"}},r.a.createElement(C.a,{src:Q(t.user),size:150})),hoverable:!0,actions:[r.a.createElement(v.a,{key:"1",icon:r.a.createElement(gt.a,null)},"Go to the shop")]},r.a.createElement(Ea,{title:t.user,description:t.amount})))}):null})),ka=a(368),wa=Object(u.b)(function(e){return{account:e.account,aTransactionData:e.aTransactionData,friendData:e.friendData}},function(e){return{setPageTitle:function(t){return e(le(t))}}})(function(e){e.setPageTitle({main:"Shop",sub:"Transactions"});var t=e.account,a=e.aTransactionData,n=e.friendData;if(!t||!t._id)return null;var i=t.transactions.filter(function(e){return a[e]}).map(function(e){return a[e]}),o=[{title:"Type",dataIndex:"types",key:"types",render:function(e){return r.a.createElement(r.a.Fragment,null,e.map(function(e){var t=e.length>5?"geekblue":"green";return"loser"===e&&(t="volcano"),r.a.createElement(ka.a,{color:t,key:e},e.toUpperCase())}))}},{title:"With",dataIndex:"user",key:"user",render:function(t){var a=n[t];return a?r.a.createElement(v.a,{type:"link",style:{padding:0},onClick:function(){return e.history.push("/profile/"+t)}},r.a.createElement(C.a,{src:Q(t,a.image),style:{marginRight:"5px"}}),a.name+" ("+a._id+")"):t}},{title:"Item",dataIndex:"perk",key:"perk",render:function(e){return e.simple||r.a.createElement($t,{rewardKey:1,label:"Rewards",rewards:[{rewards:[e],key:1}],readOnly:!0})}},{title:"Amount",dataIndex:"amount",key:"amount",render:function(e){return e>0?e:""}},{title:"Date",dataIndex:"date",key:"date",render:function(e){return r.a.createElement(wt.a,{datetime:e,live:!0})}},{title:"Progress",dataIndex:"progress",key:"progress",render:function(t){return r.a.createElement(v.a,{type:"link",onClick:function(){return e.history.push("/progresses/"+t)}},t)}},{title:"Status",key:"status",dataIndex:"status",render:function(e,a){return"Not confirmed"===e?r.a.createElement(r.a.Fragment,null,r.a.createElement(v.a,{danger:!0,type:"link",onClick:function(){return wsActions.cancelTransaction(t._id,a.transaction._id)}},"Cancel"),a.transaction.from===t._id&&r.a.createElement(v.a,{type:"link",onClick:function(){return wsActions.confirmTransaction(t._id,a.transaction._id)}},"Confirm")):e}}],c=[],l=Object(he.a)(i);l=l.sort(function(e,t){return new Date(e.date).getTime()<new Date(t.date).getTime()?1:-1});var s=!0,u=!1,d=void 0;try{for(var m,p=l[Symbol.iterator]();!(s=(m=p.next()).done);s=!0){var f=m.value,g=[];f.from===t._id&&f.to===t.id&&g.push("internal"),f.to===t._id?f.progress?(g.push("earn"),f.amount?g.push("money"):g.push("item")):f.item&&f.amount?(g.push("buy"),g.push("item")):(g.push("recieve gift"),f.amount?g.push("money"):g.push("item")):f.from===t._id&&(f.progress?(g.push("pay"),f.amount?g.push("money"):g.push("item")):f.item&&f.amount?(g.push("sell"),g.push("item")):(g.push("send gift"),f.amount?g.push("money"):g.push("item")));var h=f.to!==t._id?f.to:f.from;c.push({key:c.length,types:g,user:h,perk:f.item,amount:f.amount,date:f.date,progress:f.progress,status:f.status,transaction:f})}}catch(y){u=!0,d=y}finally{try{s||null==p.return||p.return()}finally{if(u)throw d}}return r.a.createElement(ct.a,null,r.a.createElement(sa.a,{columns:o,dataSource:c}))}),Oa=Object(u.b)(function(e){return{account:e.account}},function(e){return{setPageTitle:function(t){return e(le(t))}}})(function(e){return Object(n.useEffect)(function(){e.setPageTitle({main:"Shop",sub:"My items"})},[]),e.account._id?r.a.createElement(Bt.a,{style:{background:"transparent",boxShadow:"none",margin:"0",marginTop:"-15px"}},r.a.createElement(Bt.a.TabPane,{tab:"My shop",key:1},r.a.createElement(vt,{mode:"shop",listKey:"perks",account:e.account})),r.a.createElement(Bt.a.TabPane,{tab:"Wallet",key:3},r.a.createElement(ba,null)),r.a.createElement(Bt.a.TabPane,{tab:"Transactions",key:4},r.a.createElement(wa,null))):r.a.createElement("span",null)}),_a=a(363),xa=a.n(_a),Da=a(362),Sa=a.n(Da),ja=a(234),Ca=a.n(ja),Ia=function(e){var t=e.invitingFriends,a=e.invitedFriends,n=e.realFriends,i=e._id,o=e.accountId;if(!o)return[];if(o===i)return[e.additionalButton];var c=e.asIcons,l=function(e){return c?r.a.createElement(S.a,{title:e.text},r.a.createElement("span",{type:"link",key:e.key,onClick:e.onClick,style:{fontSize:"18px"}},e.icon)):r.a.createElement(v.a,e,e.text)};return[e.additionalButton].concat(Object(he.a)(t.find(function(e){return e.friend===i})?[r.a.createElement(l,{text:"Accept",key:"0",onClick:function(){return function(e,t){be&&1===be.readyState&&be.send(JSON.stringify({messageCode:"acceptFriend",accountId:e,friendId:t}))}(o,i)},icon:r.a.createElement(Ca.a,null),type:"primary"}),r.a.createElement(l,{text:"Decline",key:"1",onClick:function(){return it(o,i)},icon:r.a.createElement(Wt.a,null),danger:!0})]:a.find(function(e){return e.friend===i})?[r.a.createElement(l,{text:"Cancel invitation",key:"2",onClick:function(){return it(o,i)},icon:r.a.createElement(Wt.a,null),danger:!0})]:n.find(function(e){return e.friend===i})?[r.a.createElement(l,{key:"3",onClick:function(){return it(o,i)},icon:r.a.createElement(Sa.a,null),text:"Unfriend",danger:!0})]:[r.a.createElement(l,{text:"Become friends",key:"4",onClick:function(){return function(e,t){be&&1===be.readyState&&be.send(JSON.stringify({messageCode:"addFriend",accountId:e,friendId:t}))}(o,i)},icon:r.a.createElement(Ca.a,null),type:"primary"})]))},Ta=ct.a.Meta,Aa=Object(f.g)(Object(u.b)(function(e){return{account:e.account,isAuthed:e.isAuthed}},function(e){return{setData:function(t,a){return e(ce(t))},tryAuth:function(t,a){return e(re(t,a))}}})(function(e){var t=Ia({accountId:e.account?e.account._id:"",realFriends:e.realFriends,invitedFriends:e.invitedFriends,invitingFriends:e.invitingFriends,_id:e.friend._id,asIcons:!0,additionalButton:r.a.createElement(S.a,{title:"See profile"},r.a.createElement("span",{type:"link",key:"100",onClick:function(){return e.history.push("/profile/"+e.friend._id)},style:{fontSize:"18px"}},r.a.createElement(xa.a,null)))});return r.a.createElement(ct.a,{type:"inner",style:{width:200,display:"inline-block",margin:"4px 8px"},cover:r.a.createElement("span",{style:{padding:"25px",cursor:"pointer"},onClick:function(){return e.history.push("/profile/"+e.friend._id)}},r.a.createElement(C.a,{src:Q(e.friend._id,e.friend.image),size:150})),actions:t},r.a.createElement(Ta,{title:r.a.createElement("span",{style:{cursor:"pointer"},onClick:function(){return e.history.push("/profile/"+e.friend._id)}},e.friend.name),description:r.a.createElement("span",{style:{cursor:"pointer"},onClick:function(){return e.history.push("/profile/"+e.friend._id)}},e.friend._id)}))})),Pa=Object(u.b)(function(e){return{searchResult:e.friendSearchResult}},function(e){return{setFriendSearchResult:function(t){return e(se(t))}}})(function(e){Object(n.useEffect)(function(){e.setFriendSearchResult(null)},[e.addFriendOpen]);var t=e.addFriendOpen,a=e.setAddFriendOpen,i=e.searchResult,o=e.realFriends,c=e.invitedFriends,l=e.invitingFriends;return r.a.createElement(je.a,{title:"Add friend",visible:t,maskClosable:!0,closable:!0,onCancel:function(){return a(!1)},footer:r.a.createElement(v.a,{key:"back",onClick:function(){return a(!1)}},"Return"),destroyOnClose:!0},r.a.createElement("p",null,"To find a friend you need to enter your friend's nickname."),r.a.createElement(_.a,Object.assign({name:"dynamic_form_nest_item",onFinish:function(e){return t=e.search,void(be&&1===be.readyState&&be.send(JSON.stringify({messageCode:"searchFriends",search:t})));var t},autoComplete:"off"},{labelCol:{span:8},wrapperCol:{span:16}}),r.a.createElement(_.a.Item,{label:"Search",name:"search",rules:Ke},r.a.createElement(x.a,{placeholder:"Must be more than 2 characters long"})),r.a.createElement(_.a.Item,{wrapperCol:{offset:8,span:16}},r.a.createElement(v.a,{type:"primary",htmlType:"submit",size:"large"},"Search"))),i&&r.a.createElement(ct.a,{title:"Search result"},r.a.createElement(Aa,Object.assign({},e,{friend:i,realFriends:o,invitingFriends:l,invitedFriends:c}))))}),Fa=Object(f.g)(function(e){var t=e.pendingFriendsOpen,a=e.setPendingFriendsOpen,n=e.realFriends,i=e.invitedFriends,o=e.invitingFriends;return r.a.createElement(je.a,{title:"Pending friends",visible:t,maskClosable:!0,closable:!0,width:"90%",onCancel:function(){return a(!1)},footer:r.a.createElement(v.a,{key:"back",onClick:function(){return a(!1)}},"Return")},o.length>0&&r.a.createElement(ct.a,{title:"People invited me to be friends"},o.map(function(t){return r.a.createElement(Aa,Object.assign({key:t._id},e,{friend:t,realFriends:n,invitingFriends:o,invitedFriends:i}))})),i.length>0&&r.a.createElement(ct.a,{title:"I invited these people"},i.map(function(t){return r.a.createElement(Aa,Object.assign({key:t._id},e,{friend:t,realFriends:n,invitingFriends:o,invitedFriends:i}))})))}),Ra=Object(f.g)(Object(u.b)(function(e){return{account:e.account,friendData:e.friendData}},function(e){return{setPageTitle:function(t){return e(le(t))}}})(function(e){var t=Object(n.useState)(),a=Object(g.a)(t,2),i=a[0],o=a[1],c=Object(n.useState)(),l=Object(g.a)(c,2),s=l[0],u=l[1];Object(n.useEffect)(function(){e.setPageTitle({main:"Friends",sub:""})},[]);var d=e.account,m=e.friendData;if(!d._id)return null;var p=[],f=[],h=[];if(d.friends){var y=!0,E=!1,b=void 0;try{for(var k,w=d.friends[Symbol.iterator]();!(y=(k=w.next()).done);y=!0){var O=k.value,_=Object(Ce.a)({},m[O.friend],O);_&&("friend"===_.status?p.push(_):"invited"===_.status?f.push(_):"inviting"===_.status&&h.push(_))}}catch(x){E=!0,b=x}finally{try{y||null==w.return||w.return()}finally{if(E)throw b}}}return r.a.createElement(r.a.Fragment,null,(f.length>0||h.length>0)&&r.a.createElement(r.a.Fragment,null,r.a.createElement(v.a,{style:{margin:"30px 0px "},type:"primary",onClick:function(){return u(!0)}},"Show pending friends"),r.a.createElement(Jt.a,{type:"horizontal"})),r.a.createElement(yt,{title:"Add friend",sub:"Find by nickname",action:function(){return o(!0)}}),p.map(function(t){return r.a.createElement(Aa,Object.assign({key:t._id},e,{friend:t,realFriends:p,invitingFriends:h,invitedFriends:f}))}),r.a.createElement(Pa,{addFriendOpen:i,setAddFriendOpen:o,realFriends:p,invitedFriends:f,invitingFriends:h,account:d}),r.a.createElement(Fa,{pendingFriendsOpen:s,setPendingFriendsOpen:u,realFriends:p,invitedFriends:f,invitingFriends:h}))})),Na=a(364),Ma=Object(f.g)(Object(u.b)(function(e){return{account:e.account}},function(e){return{setPageTitle:function(t){return e(le(t))},increaseAvatarV:function(){return e({type:"INCREASE_AVATAR_V"})}}})(function(e){var t=Object(n.useState)(),a=Object(g.a)(t,2),i=a[0],o=a[1],c=Object(n.useState)(""),l=Object(g.a)(c,2),s=l[0],u=l[1],d=e.account;Object(n.useEffect)(function(){e.setPageTitle({main:"Account",sub:""})},[]);var m={wrapperCol:{offset:8,span:0}};return d&&d.name?r.a.createElement(ct.a,null,r.a.createElement(K.a,{className:"site-page-header",title:"My account",backIcon:!1}),r.a.createElement(Ue.a,{name:"avatar",listType:"picture-card",className:Na.Avatar,showUploadList:!1,customRequest:function(t){var a=t.file;Pe(a,800,"avatar",function(){e.increaseAvatarV()})}},d.image?r.a.createElement(C.a,{src:Q(d._id,d.image),size:150,style:{margin:"25px"}}):r.a.createElement("div",null,r.a.createElement(Ge.a,null),r.a.createElement("div",{className:"ant-upload-text"},"Upload"))),r.a.createElement(_.a,Object.assign({name:"dynamic_form_nest_item",onFinish:function(e){return function(e,t){be&&1===be.readyState&&be.send(JSON.stringify({messageCode:"editAccount",name:e.name,accountId:t}))}(e,d._id)},autoComplete:"off"},{labelCol:{span:8},wrapperCol:{span:16}},{initialValues:{name:d.name,nickname:d._id}}),r.a.createElement(_.a.Item,{label:"Name",name:"name",rules:Ye},r.a.createElement(x.a,{placeholder:"Must be more than 1 character long"})),r.a.createElement(_.a.Item,{label:"Nickname",name:"nickname"},r.a.createElement(x.a,{disabled:!0})),r.a.createElement(_.a.Item,Object.assign({},m,{style:{flex:"none",maxWidth:" 100%",overflow:"hidden"}}),r.a.createElement(v.a,{type:"primary",htmlType:"submit",size:"large"},"Save")),r.a.createElement(_.a.Item,Object.assign({},m,{style:{flex:"none",maxWidth:" 100%",overflow:"hidden"}}),r.a.createElement(v.a,{type:"dashed",onClick:function(){return o(!0)},danger:!0,size:"large"},"Delete account"))),r.a.createElement(je.a,{title:"Delete account",visible:i,onOk:function(){var e;s!==d._id?te.a.warning("The nickmanme is not correct."):(e=d._id,be&&1===be.readyState&&be.send(JSON.stringify({messageCode:"deleteAccount",accountId:e})))},onCancel:function(){o(!1),u("")}},r.a.createElement("p",null,"Please enter your nickname and press Ok to delete your account."),r.a.createElement(x.a,{onChange:function(e){return u(e.target.value)}}))):null})),za=Object(f.g)(Object(u.b)(function(e){return{account:e.account,profile:e.profile,isAuthed:e.isAuthed,pulledFrom:e.pulledFrom}},function(e){return{setData:function(t,a){return e(ce(t))},setPageTitle:function(t){return e(le(t))},tryAuth:function(t,a){return e(re(t,a))}}})(function(e){if(Object(n.useEffect)(function(){bt(e)},[e.history.location.pathname]),"profile"!==e.pulledFrom)return null;var t=e.profile,a=e.account;if(!t._id||!t.goals)return null;e.setPageTitle({main:t.name,sub:t._id});var i=[],o=[],c=[];if(a&&a.friends){var l=!0,s=!1,u=void 0;try{for(var d,m=a.friends[Symbol.iterator]();!(l=(d=m.next()).done);l=!0){var p=d.value;"friend"===p.status?i.push(p):"invited"===p.status?o.push(p):"inviting"===p.status&&c.push(p)}}catch(g){s=!0,u=g}finally{try{l||null==m.return||m.return()}finally{if(s)throw u}}}var f=Ia({accountId:a?a._id:"",realFriends:i,invitedFriends:o,invitingFriends:c,_id:t._id,additionalButton:null});return r.a.createElement(ct.a,null,r.a.createElement("div",{style:{textAlign:"center",marginBottom:"50px"}},r.a.createElement(C.a,{src:Q(t._is,t.image),size:200}),r.a.createElement("h1",null,t.name),r.a.createElement("h3",null,"(",t._id,")"),f),r.a.createElement(Bt.a,null,r.a.createElement(Bt.a.TabPane,{tab:"Friends",key:1},r.a.createElement(ct.a,{title:"Friends"},t.friends.filter(function(e){return"friend"===e.status}).map(function(n){var l=Object(Ce.a)({},t.friendsData.find(function(e){return e._id.toString()===n.friend.toString()}),n.friend);return r.a.createElement(Aa,Object.assign({key:l._id},e,{account:a,friend:l,realFriends:i,invitingFriends:c,invitedFriends:o}))}))),r.a.createElement(Bt.a.TabPane,{tab:"Progresses",key:2},r.a.createElement(ct.a,{title:"Progresses"},r.a.createElement(la,{pulledProfile:t,progressesData:t.progressesData,keepPageTitle:!0,noPullData:!0}))),r.a.createElement(Bt.a.TabPane,{tab:"Goals",key:3},r.a.createElement(ct.a,{title:"Goals"},t.goals.map(function(e,n){return r.a.createElement(pt,{key:n,perk:e,perkId:e.goalId,owner:t,account:a,setEditedPerk:function(){},setEditPerkOpen:function(){},mode:"goals"})}))),r.a.createElement(Bt.a.TabPane,{tab:"Shop",key:4},r.a.createElement(ct.a,{title:"Shop"},t.perks&&t.perks.map(function(e,n){return r.a.createElement(pt,{key:n,perk:e,perkId:e.perkId,owner:t,account:a,onlyBuy:!0,mode:"shop"})}))),r.a.createElement(Bt.a.TabPane,{tab:"Wallet",key:5},r.a.createElement(ct.a,{title:"Wallet"},r.a.createElement(ba,{keepPageTitle:!0,pulledProfile:t,account:t}))),r.a.createElement(Bt.a.TabPane,{tab:"Wishlist",key:6},r.a.createElement(ct.a,{title:"Wishlist"},t.wishlist.map(function(e,n){return r.a.createElement(pt,{key:n,perk:e,perkId:e.itemId,owner:t,account:a,setEditedPerk:function(){},setEditPerkOpen:function(){},mode:"wishlist"})})))))})),Ba=Object(f.g)(Object(u.b)(function(e){return{isAuthed:e.isAuthed,user:e.user,account:e.account}},function(e){return{setPageTitle:function(t){return e(le(t))},setAccountActivated:function(t){return e(function(e){return{type:"SET_ACCOUNT_ACTIVATED",value:e}}(t))}}})(function(e){console.log("here"),e.isAuthed||e.history.push("/logout");return r.a.createElement(r.a.Fragment,null,r.a.createElement(K.a,{className:"site-page-header",title:"Activate your account",backIcon:!1}),r.a.createElement(_.a,Object.assign({name:"dynamic_form_nest_item",onFinish:function(t){s.a.post("/api/activate-account",Object(Ce.a)({},t)).then(function(t){t.data.success?(te.a.success("Your account has been activated!"),e.setAccountActivated(!1),e.history.push("/account")):(t.data.nicknameNotUnique&&te.a.warning("The nickname is taken. Choose another nickname please."),t.data.errorCode&&te.a.error("Something is wrong with the data. Please try one more time with new data."))}).catch(function(e){})},autoComplete:"off"},{labelCol:{span:8},wrapperCol:{span:16}}),r.a.createElement(_.a.Item,{label:"Name",name:"name",rules:Ye},r.a.createElement(x.a,{placeholder:"Must be more than 1 character long"})),r.a.createElement(_.a.Item,{label:"Nickname",name:"nickname",rules:Ke},r.a.createElement(x.a,{placeholder:"Must be more than 1 character long"})),r.a.createElement(_.a.Item,{wrapperCol:{offset:8,span:16}},r.a.createElement(v.a,{type:"primary",htmlType:"submit",size:"large"},"Save"))))})),La=Zt.a.Item,Ua=Object(f.g)(Object(u.b)(function(e){return{isAuthed:e.isAuthed,account:e.account,post:e.post,friendData:e.friendData}},function(e){return{setData:function(t){e(ce(t))},setPageTitle:function(t){return e(le(t))}}})(function(e){var t=Object(n.useState)(""),a=Object(g.a)(t,2),i=a[0],o=a[1],c=Object(n.useState)({}),l=Object(g.a)(c,2),s=l[0],u=l[1];if(Object(n.useEffect)(function(){bt(e,0,u)},[e.isAuthed]),!s.perk)return null;var d=s.perk,m=s.profile;e.setData({currentPosts:d.post}),d&&e.setPageTitle({main:d.name,sub:m._id});var p;return d?r.a.createElement(ct.a,{title:r.a.createElement("span",null,"Item from"," ",r.a.createElement(v.a,{type:"link",style:{padding:0},onClick:function(){return e.history.push("/profile/"+m._id)}},r.a.createElement(C.a,{src:Q(m._id,m.image),style:{marginRight:"5px"}}),m.name+" ("+m._id+")")," ","shop")},d.images.map(function(e){return r.a.createElement("span",{onClick:function(){return o(e)}},r.a.createElement(ct.a,{type:"inner",style:{width:200,display:"inline-block"},hoverable:!0,cover:r.a.createElement("div",{style:{backgroundImage:"url("+e+")",height:200,width:200,backgroundSize:"cover"}})}))}),r.a.createElement("p",null,d.description),r.a.createElement(Zt.a,{title:"Goal description",bordered:!0,column:{xxl:4,xl:3,lg:3,md:3,sm:2,xs:1}},r.a.createElement(La,{label:"Available for"},(p=d.users,m&&e.friendData?p.map(function(t){var a=e.friendData.find(function(e){return e._id===t});return a?r.a.createElement("span",{style:{cursor:"pointer"},onClick:function(){return e.history.push("/profile/"+t)}},r.a.createElement(C.a,{src:Q(t,a.image),size:20,style:{marginRight:"10px"}}),a.name," - (",t,")"):t}):p)),r.a.createElement(La,{label:"Price"},d.price)),r.a.createElement(Mt,{noStartMessage:!0,post:e.post[d.post],account:e.account,friendData:e.friendData}),r.a.createElement(je.a,{visible:i,footer:null,onCancel:function(){return o("")}},r.a.createElement("img",{alt:"example",style:{width:"100%"},src:i}))):null})),Va=Object(f.g)(Object(u.b)(function(e){return{isAuthed:e.isAuthed,account:e.account,post:e.post,friendData:e.friendData}},function(e){return{setData:function(t){e(ce(t))},setPageTitle:function(t){return e(le(t))}}})(function(e){var t=Object(n.useState)(""),a=Object(g.a)(t,2),i=a[0],o=a[1],c=Object(n.useState)({}),l=Object(g.a)(c,2),s=l[0],u=l[1];if(Object(n.useEffect)(function(){bt(e,0,u)},[e.isAuthed]),!s.wishlistItem)return null;var d=s.wishlistItem,m=s.profile;return e.setData({currentPosts:d.post}),d&&e.setPageTitle({main:d.name,sub:m._id}),d?r.a.createElement(ct.a,{title:r.a.createElement("span",null,"Item from"," ",r.a.createElement(v.a,{type:"link",style:{padding:0},onClick:function(){return e.history.push("/profile/"+m._id)}},r.a.createElement(C.a,{src:Q(m._id,m.image),style:{marginRight:"5px"}}),m.name+" ("+m._id+")")," ","wishlist")},d.images.map(function(e){return r.a.createElement("span",{onClick:function(){return o(e)}},r.a.createElement(ct.a,{type:"inner",style:{width:200,display:"inline-block"},hoverable:!0,cover:r.a.createElement("div",{style:{backgroundImage:"url("+e+")",height:200,width:200,backgroundSize:"cover"}})}))}),r.a.createElement("h1",null,d.name),r.a.createElement("p",null,d.description),r.a.createElement(Mt,{noStartMessage:!0,post:e.post[d.post],account:e.account,friendData:e.friendData}),r.a.createElement(je.a,{visible:i,footer:null,onCancel:function(){return o("")}},r.a.createElement("img",{alt:"example",style:{width:"100%"},src:i}))):null})),Ga=Object(f.g)(Object(u.b)(function(e){return{account:e.account}},function(e){return{setPageTitle:function(t){return e(le(t))}}})(function(e){return Object(n.useEffect)(function(){e.setPageTitle({main:"Wishlist",sub:""})},[]),e.account._id?r.a.createElement(vt,{mode:"wishlist",account:e.account}):r.a.createElement("span",null)})),Ha=new y.a,Ja=Object(f.g)(Object(u.b)(function(e){return{isAuthed:e.isAuthed,user:e.user,account:e.account,accountNotActive:e.accountNotActive}},function(e){return{tryAuth:function(t,a){return e(re(t,a))},logout:function(){return e(function(e){ne.remove("rememberme",{path:"/"}),ne.remove("auth_token",{path:"/"}),delete s.a.defaults.headers.common["x-auth-token"],delete s.a.defaults.headers.post["x-auth-token"],delete s.a.defaults.headers.get["x-auth-token"],delete s.a.defaults.headers.delete["x-auth-token"],delete s.a.defaults.headers.put["x-auth-token"],e(oe(!1))})}}})(function(e){var t=e.isAuthed;Object(n.useEffect)(function(){e.tryAuth(e)});var a=Ha.get("redirectto");a&&Ha.remove("redirectto",{path:"/"});var i=function(){return e.logout(),r.a.createElement(f.a,{to:"/login"})},o=r.a.createElement(f.d,null,r.a.createElement(f.b,{path:"/goals",exact:!0,component:Et}),r.a.createElement(f.b,{path:"/goals",component:zt}),r.a.createElement(f.b,{path:"/progresses",exact:!0,component:la}),r.a.createElement(f.b,{path:"/progresses",component:va}),r.a.createElement(f.b,{path:"/profile",component:za}),r.a.createElement(f.b,{path:"/friends",exact:!0,component:Ra}),r.a.createElement(f.b,{path:"/account",exact:!0,component:Ma}),r.a.createElement(f.b,{path:"/shop",exact:!0,component:Oa}),r.a.createElement(f.b,{path:"/shop",component:Ua}),r.a.createElement(f.b,{path:"/wishlist",exact:!0,component:Ga}),r.a.createElement(f.b,{path:"/wishlist",component:Va}),!t&&r.a.createElement(f.b,{path:"/login",exact:!0,component:O}),r.a.createElement(f.b,{path:"/logout",exact:!0,component:i}),r.a.createElement(f.b,{path:"/activate-account",exact:!0,component:Ba}),!1,t?r.a.createElement(f.a,{to:"/progresses"}):r.a.createElement(f.a,{to:"/login"}));return e.accountNotActive&&(o=r.a.createElement(f.d,null,!t&&r.a.createElement(f.b,{path:"/login",exact:!0,component:O}),r.a.createElement(f.b,{path:"/logout",exact:!0,component:i}),r.a.createElement(f.b,{path:"/activate-account",exact:!0,component:Ba}),!1,t?r.a.createElement(f.a,{to:"/activate-account"}):r.a.createElement(f.a,{to:"/login"}))),a?r.a.createElement(f.a,{to:a}):r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:{height:"100%"}},r.a.createElement($,null,o),t&&r.a.createElement(we,null)))})),qa=a(369),Wa=Object(qa.a)({isAuthed:!1,user:null,currentAccount:"",account:{},friendData:{},transactionData:{},progressData:{},currentProfile:"",profile:{},currentProgress:"",currentGroup:"",currentPosts:[],progress:{},post:{},postData:{},group:{},groupData:{},pageTitle:{},lastUrl:"",friendSearchResult:null,accountNotActive:!1},{SET_DATA:function(e,t){if(t.data){for(var a=0,n=["user","account","isAuthed","currentAccount","currentProfile","currentPosts","currentGroup","profile","group","currentProgress","progress"];a<n.length;a++){var r=n[a];"undefined"!==typeof t.data[r]&&(e[r]=t.data[r])}for(var i=0,o=["friendData","progressData","post","postData","groupData","transactionData"];i<o.length;i++){var c=o[i];if("undefined"!==typeof t.data[c])for(var l in t.data[c])t.data[c][l]&&(e[c][l]=t.data[c][l])}}e.user&&(e.user.currentAccount?(e.currentAccount=e.user.currentAccount,e.accountNotActive=!1):e.user.myAccount?(e.currentAccount=e.user.myAccount,e.accountNotActive=!1):e.accountNotActive=!0)},REMOVE_DATA:function(e,t){if(t.data){for(var a=0,n=["user","account","profile","progress","group"];a<n.length;a++){var r=n[a],i=!0,o=!1,c=void 0;try{for(var l,s=t.data[r][Symbol.iterator]();!(i=(l=s.next()).done);i=!0){var u=l.value;e[r]._id===u&&(e[r]={})}}catch(b){o=!0,c=b}finally{try{i||null==s.return||s.return()}finally{if(o)throw c}}}for(var d=0,m=["post","friendData","progressData","postData","groupData","transactionData"];d<m.length;d++){var p=m[d],f=!0,g=!1,h=void 0;try{for(var y,v=t.data[p][Symbol.iterator]();!(f=(y=v.next()).done);f=!0){var E=y.value;delete e[p][E]}}catch(b){g=!0,h=b}finally{try{f||null==v.return||v.return()}finally{if(g)throw h}}}}},SET_FRIEND_SEARCH_RESULT:function(e,t){e.friendSearchResult=t.data},SET_FRIENDS_DATA:function(e,t){t.data&&(e.account.friendsData=t.data),t.data.perk&&(e.perk=t.data.perk)},SET_AVATAR_V:function(e,t){e.account.image=t.v},INCREASE_AVATAR_V:function(e){e.account.image=e.account.image+1},SET_IS_AUTHED:function(e,t){e.isAuthed=t.id},SET_PAGE_TITLE:function(e,t){e.pageTitle=t.title},SAVE_LAST_URL:function(e,t){"/login"!==t.url&&"/logout"!==t.url&&(e.lastUrl=t.url)},SET_ACCOUNT_ACTIVATED:function(e,t){e.accountNotActive=t.value}});a.d(t,"store",function(){return Ka}),s.a.defaults.baseURL="https://getreward.herokuapp.com";var Ka=Object(d.createStore)(Wa,Object(p.composeWithDevTools)(Object(d.applyMiddleware)(m.a))),Qa=r.a.createElement(u.a,{store:Ka},r.a.createElement(c.a,null,r.a.createElement(Ja,null))),Ya=document.getElementById("root");o.a.render(Qa,Ya)}},[[377,1,2]]]);
//# sourceMappingURL=main.c0853f5d.chunk.js.map