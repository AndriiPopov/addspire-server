(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{186:function(e,t,a){e.exports={Container:"Auth_Container__1KNy7",socialButtons:"Auth_socialButtons__2wwH9",Background:"Auth_Background__39m_a"}},350:function(e,t,a){e.exports={Avatar:"Account_Avatar__l4shx"}},362:function(e,t,a){e.exports=a(782)},391:function(e,t,a){},40:function(e,t,a){e.exports={Layout:"Layout_Layout__3t6t4",Header:"Layout_Header__3lh1Y",Footer:"Layout_Footer__1Dfqu",HideHeader:"Layout_HideHeader__2WRsh",FooterButton:"Layout_FooterButton__1lZv2",TopHeader:"Layout_TopHeader__3_LuK",BottomHeader:"Layout_BottomHeader__3DOBo",Main:"Layout_Main__3usmk",Button:"Layout_Button__1O5Hm",MenuButtonContiner:"Layout_MenuButtonContiner__PpulB",QuickButtonContiner:"Layout_QuickButtonContiner__4d4Lg",PageTitle:"Layout_PageTitle__368dw"}},595:function(e,t){},597:function(e,t){},634:function(e,t){},635:function(e,t){},782:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),i=a(6),o=a.n(i),s=a(28),c=a(33),l=a.n(c),u=a(9),d=a(54),m=a(133),p=a(308),f=(a(391),a(41)),g=a(7),h=a(83),y=a(90),E=a(186),v=a.n(E),b=a(35),k=a(187),w=new y.a,O=Object(f.g)(Object(u.b)(function(e){return{lastUrl:e.lastUrl}})(function(e){var t=Object(n.useState)(!1),a=Object(g.a)(t,2),i=a[0],o=a[1],s=Object(n.useState)(!1),c=Object(g.a)(s,2),l=c[0],u=c[1];Object(n.useEffect)(function(){m()});var d="?rememberme=false";i&&(d="?rememberme=true");e.lastUrl&&e.lastUrl;var m=function(){w.get("cookies_consent")&&u(!0)},p="https://getreward.herokuapp.com/api/auth/";return l?r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:v.a.Container},r.a.createElement("h1",null,"Welcome to Websiter!"),r.a.createElement("h2",null,"This is where great progresses live."),r.a.createElement("h1",null,"Continue with:"),r.a.createElement("div",{className:v.a.socialButtons},r.a.createElement(k.FacebookLoginButton,{onClick:function(){return window.location=p+"facebook/start".concat(d)}}),r.a.createElement(k.GoogleLoginButton,{onClick:function(){return window.location=p+"google/start".concat(d)}}),r.a.createElement(k.GithubLoginButton,{onClick:function(){return window.location=p+"github/start".concat(d)}})),r.a.createElement(h.a,{checked:i,onChange:function(){return o(!i)}},"Remember me")),r.a.createElement("div",{className:v.a.Background})):r.a.createElement(b.a,{title:"Cookies consent",visible:!l,onOk:function(){w.set("cookies_consent","true",{path:"/",maxAge:3153e4}),m()},onCancel:function(){window.open("https://websiter.dev","_self")},destroyOnClose:!0,maskClosable:!1},r.a.createElement("p",null,"We use cookies only for login purposes. "),r.a.createElement("p",null,"In order to proceed you need to agree with the use of cookies."))})),D=a(10),_=a(34),j=a(4),I=(new y.a,a(121),a(91),a(197),a(505),a(249),a(250),a(510),a(251),a(513),a(252),a(253),a(198),a(518),a(520),a(522),a(783),a(526),a(528),a(530),a(254),a(145),a(255),a(785),a(784),a(539),a(541),a(543),a(545),a(547),a(550),a(552),a(554),a(556),a(558),a(116)),S=a(55),x=a(16),C=a(36),T=a(354),A=a(98),P=a(40),N=a(321),F=a.n(N),R=a(188),M=a.n(R),L=a(323),B=a.n(L),z=a(322),U=a.n(z),V=a(220),G=a.n(V),J=a(222),W=a.n(J),q=a(218),H=a.n(q),K=a(221),$=a.n(K),Q=a(219),Y=a.n(Q),Z=function(e,t){return e?"https://websiter.s3.us-east-2.amazonaws.com/"+e+"/avatar?v="+(t||0):""},X=I.a.Header,ee=I.a.Content,te=I.a.Footer,ae=Object(f.g)(Object(u.b)(function(e){return{account:e.account,pageTitle:e.pageTitle,isAuthed:e.isAuthed,lastNotifications:e.lastNotifications}})(function(e){var t=e.account,a=Object(n.useState)(),i=Object(g.a)(a,2),o=i[0],s=i[1],c=Object(n.useState)(0),l=Object(g.a)(c,2),u=l[0],d=l[1],m=Object(n.useState)(!0),p=Object(g.a)(m,2),f=p[0],h=p[1];Object(n.useEffect)(function(){var e=function(){var e=window.scrollY;h(!(e>u)),d(e)};return window.removeEventListener("scroll",e),window.addEventListener("scroll",e),function(){return window.removeEventListener("scroll",e)}},[u]);var y=function(){s(!o)},E=e.history.location.pathname.split("/")[1]||void 0,v={type:"link",size:"large",className:P.Button},b=function(e){return E===e?{ghost:!1,type:"link"}:{type:"text"}},k=function(t){return e.history.push("/"+t)},w="/activate-account"===e.history.location.pathname,O=0,D=!0,_=!1,N=void 0;try{for(var R,L=e.lastNotifications[Symbol.iterator]();!(D=(R=L.next()).done);D=!0){var z=R.value;parseInt(z.notId)>parseInt(t.lastSeenNot||0)&&O++}}catch(V){_=!0,N=V}finally{try{D||null==L.return||L.return()}finally{if(_)throw N}}return e.isAuthed&&t._id?r.a.createElement(r.a.Fragment,null,r.a.createElement(I.a,{className:P.Layout},r.a.createElement(X,{className:f?P.Header:[P.Header,P.HideHeader].join(" ")},r.a.createElement("div",{className:P.TopHeader},r.a.createElement("div",{className:P.MenuButtonContiner},!w&&r.a.createElement(j.a,Object.assign({},v,{icon:r.a.createElement(H.a,null),onClick:y})),r.a.createElement("div",{className:P.PageTitle},w?"Activate your account":e.pageTitle.main)),r.a.createElement("div",{className:P.QuickButtonContiner},w?r.a.createElement(j.a,Object.assign({},v,b("friends"),{icon:r.a.createElement(M.a,null),onClick:function(){return e.history.push("/logout")}}),"Logout"):r.a.createElement("span",{onClick:function(){return k("account")},style:{margin:"0px 10px",cursor:"pointer"}},r.a.createElement(C.a,{style:{border:"1px solid white"},src:Z(t._id,t.image)}))))),r.a.createElement(ee,{className:P.Main},r.a.createElement("div",null,e.children)),!w&&r.a.createElement(te,{className:P.Footer},r.a.createElement(j.a,Object.assign({},v,b("dashboard"),{onClick:function(){return k("dashboard")}}),r.a.createElement(A.a,{count:O},r.a.createElement(Y.a,null)," ",r.a.createElement("div",{className:P.FooterButton},"Dashboard"))),r.a.createElement(j.a,Object.assign({},v,b("progresses"),{onClick:function(){return k("progresses")}}),r.a.createElement(A.a,{count:0},r.a.createElement(G.a,null),r.a.createElement("div",{className:P.FooterButton},"Progresses"))),r.a.createElement(j.a,Object.assign({},v,b("shop"),{onClick:function(){return k("shop")}}),r.a.createElement(A.a,{count:0},r.a.createElement($.a,null),r.a.createElement("div",{className:P.FooterButton},"Shop"))),r.a.createElement(j.a,Object.assign({},v,b("friends"),{onClick:function(){return k("friends")}}),r.a.createElement(A.a,{count:t.friends.filter(function(e){return"inviting"===e.status}).length},r.a.createElement(W.a,null),r.a.createElement("div",{className:P.FooterButton},"Friends")))),!w&&r.a.createElement(T.a,{title:"Menu",closable:!0,onClose:y,visible:o,placement:"left"},r.a.createElement(x.a,{theme:"light",mode:"vertical",selectedKeys:[E],onClick:function(t){var a=t.key;e.history.push("/"+a),y()},overflowedIndicator:r.a.createElement(H.a,null)},r.a.createElement(x.a.Item,{key:"dashboard",icon:r.a.createElement(Y.a,null)},"Dashboard"),r.a.createElement(x.a.Item,{key:"progresses",icon:r.a.createElement(G.a,null)},"Progresses"),r.a.createElement(x.a.Item,{key:"shop",icon:r.a.createElement($.a,null)},"Shop"),r.a.createElement(x.a.Item,{key:"friends",icon:r.a.createElement(W.a,null)},"Friends"),r.a.createElement(x.a.Item,{key:"goals",icon:r.a.createElement(F.a,null)},"Goals"),r.a.createElement(x.a.Item,{key:"wishlist",icon:r.a.createElement(U.a,null)},"Wishlist"),r.a.createElement(x.a.Item,{key:"account",icon:r.a.createElement(B.a,null)},"Account"),r.a.createElement(x.a.Item,{key:"logout",icon:r.a.createElement(M.a,null)},"Logout"))))):["/login","logout"].includes(e.history.location.pathname)?e.children:r.a.createElement(r.a.Fragment,null,r.a.createElement(I.a,{className:P.Layout},r.a.createElement(X,{className:P.Header},r.a.createElement("div",{className:P.TopHeader},r.a.createElement("div",{className:P.MenuButtonContiner}),r.a.createElement("div",{className:P.QuickButtonContiner},r.a.createElement(S.a,{title:"Sign in or Sign up",placement:"bottomRight",mouseEnterDelay:.3},r.a.createElement(j.a,Object.assign({},v,b("friends"),{icon:r.a.createElement(M.a,null),onClick:function(){return e.history.push("/login")}}),"Sign in or Sign up"))))),r.a.createElement(ee,{className:P.Main},r.a.createElement("div",null,e.children))))})),ne=a(324),re=a.n(ne),ie=a(38),oe=function(e,t){if(e.data.logout&&t.history.push("/logout"),!1===e.data.success)if(e.data.errorCode)switch(e.data.errorCode){case"no account":ie.b.warning("Account is not found. Please login.");break;case"bad data":ie.b.error("Error. Please try one more time with correct data.");break;case"progress exist":ie.b.warning("This progress already exists.");break;default:ie.b.warning("Something wrong has happened... Try again!")}else ie.b.error("Something failed");else if(e.data.successCode)switch(e.data.successCode){case"avatar saved":ie.b.success("The avatar image has been updated.");break;case"success":ie.b.success("Success!");break;case"item saved":ie.b.success("Item is saved");break;case"prgress created":ie.b.success("Progress has started!");break;default:ie.b.success("Success!")}e.data.status&&"no account"===e.data.status&&t.history.push("/activate-account")},se=new y.a,ce=function(e,t){return function(a){sessionStorage.setItem("systemRefresh","0");var n=se.get("auth_token"),r=se.get("rememberme");r&&(se.remove("rememberme",{path:"/"}),"false"===r&&se.remove("auth_token",{path:"/"}));var i=re.a.decode(n);l.a.defaults.headers.post["Content-Type"]="application/json",l.a.defaults.headers.put["Content-Type"]="application/json",l.a.defaults.headers.delete["Content-Type"]="application/json",l.a.defaults.headers.common.Accept="application/json",n&&i?(l.a.defaults.headers.common["x-auth-token"]=n,l.a.defaults.headers.post["x-auth-token"]=n,l.a.defaults.headers.get["x-auth-token"]=n,l.a.defaults.headers.delete["x-auth-token"]=n,l.a.defaults.headers.put["x-auth-token"]=n,a(ue(i._id))):(a(ue(!1)),a(le(e.history.location.pathname)),t&&e.history.push("/logout"))}},le=function(e){return{type:"SAVE_LAST_URL",url:e}},ue=function(e){return{type:"SET_IS_AUTHED",id:e}},de=function(e){return{type:"SET_DATA",data:e}},me=function(e){return{type:"SET_PAGE_TITLE",title:e}},pe=function(e){return{type:"SET_FRIEND_SEARCH_RESULT",data:e}},fe=a(59),ge=a(326),he=a(327),ye=a(357),Ee=a(328),ve=a(358),be=a(11),ke=function(e){var t=e.store,a={user:[],account:[],progress:[],post:[],group:[],progressData:[],friendData:[],postData:[],groupData:[],transactionData:[]},n={user:[],account:[],progress:[],post:[],group:[],progressData:[],friendData:[],postData:[],groupData:[],transactionData:[]};if(t.isAuthed)if(t.user){if(n.user.push(t.user._id),t.currentAccount)if(t.account._id!==t.currentAccount)a.account.push(t.currentAccount);else{n.account.push(t.account._id);var r=!0,i=!1,o=void 0;try{for(var s,c=t.account.progresses[Symbol.iterator]();!(r=(s=c.next()).done);r=!0){var l=s.value;t.progressData[l]||a.progressData.push(l),n.progressData.push(l)}}catch(et){i=!0,o=et}finally{try{r||null==c.return||c.return()}finally{if(i)throw o}}var u=!0,d=!1,m=void 0;try{for(var p,f=t.account.groups[Symbol.iterator]();!(u=(p=f.next()).done);u=!0){var g=p.value;t.groupData[g]||a.groupData.push(g),n.groupData.push(g)}}catch(et){d=!0,m=et}finally{try{u||null==f.return||f.return()}finally{if(d)throw m}}var h=!0,y=!1,E=void 0;try{for(var v,b=t.account.followPosts[Symbol.iterator]();!(h=(v=b.next()).done);h=!0){var k=v.value;t.postData[k]||a.postData.push(k),n.postData.push(k)}}catch(et){y=!0,E=et}finally{try{h||null==b.return||b.return()}finally{if(y)throw E}}var w=!0,O=!1,D=void 0;try{for(var _,j=t.account.myPosts[Symbol.iterator]();!(w=(_=j.next()).done);w=!0){var I=_.value;t.postData[I]||a.postData.push(I),n.postData.push(I)}}catch(et){O=!0,D=et}finally{try{w||null==j.return||j.return()}finally{if(O)throw D}}var S=!0,x=!1,C=void 0;try{for(var T,A=t.account.transactions[Symbol.iterator]();!(S=(T=A.next()).done);S=!0){var P=T.value;t.transactionData[P]||a.transactionData.push(P),n.transactionData.push(P)}}catch(et){x=!0,C=et}finally{try{S||null==A.return||A.return()}finally{if(x)throw C}}var N=!0,F=!1,R=void 0;try{for(var M,L=t.account.friends[Symbol.iterator]();!(N=(M=L.next()).done);N=!0){var B=M.value;t.friendData[B.friend]||a.friendData.push(B.friend),n.friendData.push(B.friend)}}catch(et){F=!0,R=et}finally{try{N||null==L.return||L.return()}finally{if(F)throw R}}}if(t.currentProfile)if(t.profile._id!==t.currentProfile)a.account.push(t.currentProfile);else{n.account.push(t.profile._id);var z=!0,U=!1,V=void 0;try{for(var G,J=t.profile.progresses[Symbol.iterator]();!(z=(G=J.next()).done);z=!0){var W=G.value;t.progressData[W]||a.progressData.push(W),n.progressData.push(W)}}catch(et){U=!0,V=et}finally{try{z||null==J.return||J.return()}finally{if(U)throw V}}var q=!0,H=!1,K=void 0;try{for(var $,Q=t.profile.groups[Symbol.iterator]();!(q=($=Q.next()).done);q=!0){var Y=$.value;t.groupData[Y]||a.groupData.push(Y),n.groupData.push(Y)}}catch(et){H=!0,K=et}finally{try{q||null==Q.return||Q.return()}finally{if(H)throw K}}var Z=!0,X=!1,ee=void 0;try{for(var te,ae=t.profile.friends[Symbol.iterator]();!(Z=(te=ae.next()).done);Z=!0){var ne=te.value;t.friendData[ne.friend]||a.friendData.push(ne.friend),n.friendData.push(ne.friend)}}catch(et){X=!0,ee=et}finally{try{Z||null==ae.return||ae.return()}finally{if(X)throw ee}}}if(t.currentGroup)if(t.group._id!==t.currentGroup)a.group.push(t.currentGroup);else{n.group.push(t.group._id);var re=!0,ie=!1,oe=void 0;try{for(var se,ce=t.group.users[Symbol.iterator]();!(re=(se=ce.next()).done);re=!0){var le=se.value;t.friendData[le]||a.friendData.push(le),n.friendData.push(le)}}catch(et){ie=!0,oe=et}finally{try{re||null==ce.return||ce.return()}finally{if(ie)throw oe}}var ue=!0,de=!1,me=void 0;try{for(var pe,fe=t.group.progresses[Symbol.iterator]();!(ue=(pe=fe.next()).done);ue=!0){var ge=pe.value;t.progressData[ge]||a.progressData.push(ge),n.progressData.push(ge)}}catch(et){de=!0,me=et}finally{try{ue||null==fe.return||fe.return()}finally{if(de)throw me}}var he=!0,ye=!1,Ee=void 0;try{for(var ve,ke=t.group.posts[Symbol.iterator]();!(he=(ve=ke.next()).done);he=!0){var we=ve.value;t.postData[we]||a.postData.push(we),n.postData.push(we)}}catch(et){ye=!0,Ee=et}finally{try{he||null==ke.return||ke.return()}finally{if(ye)throw Ee}}}if(t.currentProgress)if(t.progress._id!==t.currentProgress)a.progress.push(t.currentProgress);else{n.progress.push(t.progress._id);var Oe=[];t.progress.owner&&Oe.push(t.progress.owner),t.progress.worker&&Oe.push(t.progress.worker),Oe=[].concat(Object(be.a)(Oe),Object(be.a)(t.progress.experts||[]),Object(be.a)(t.progress.supporters||[]));var De=!0,_e=!1,je=void 0;try{for(var Ie,Se=Oe[Symbol.iterator]();!(De=(Ie=Se.next()).done);De=!0){var xe=Ie.value;t.friendData[xe]||a.friendData.push(xe),n.friendData.push(xe)}}catch(et){_e=!0,je=et}finally{try{De||null==Se.return||Se.return()}finally{if(_e)throw je}}var Ce=!0,Te=!1,Ae=void 0;try{for(var Pe,Ne=t.progress.posts[Symbol.iterator]();!(Ce=(Pe=Ne.next()).done);Ce=!0){var Fe=Pe.value;t.postData[Fe]||a.postData.push(Fe),n.postData.push(Fe)}}catch(et){Te=!0,Ae=et}finally{try{Ce||null==Ne.return||Ne.return()}finally{if(Te)throw Ae}}}if(t.currentPosts){var Re=!0,Me=!1,Le=void 0;try{for(var Be,ze=t.currentPosts[Symbol.iterator]();!(Re=(Be=ze.next()).done);Re=!0){var Ue=Be.value,Ve=t.post[Ue];if(Ve){n.post.push(Ue);var Ge=!0,Je=!1,We=void 0;try{for(var qe,He=Ve.users[Symbol.iterator]();!(Ge=(qe=He.next()).done);Ge=!0){var Ke=qe.value;t.friendData[Ke]||a.friendData.push(Ke),n.friendData.push(Ke)}}catch(et){Je=!0,We=et}finally{try{Ge||null==He.return||He.return()}finally{if(Je)throw We}}Ue.parent&&("progress"===Ue.parent.parentType?n.progressData.push(Ue.parent.parentId):"group"===Ue.parent.parentType&&n.groupData.push(Ue.parent.parentId))}else a.post.push(Ue)}}catch(et){Me=!0,Le=et}finally{try{Re||null==ze.return||ze.return()}finally{if(Me)throw Le}}}}else a.user.push(t.isAuthed);var $e=function(e){for(var t in e)e[t]&&(e[t]=Array.from(new Set(e[t])))};$e(n);var Qe,Ye={user:[],account:[],progress:[],post:[],group:[],progressData:[],friendData:[],postData:[],groupData:[],transactionData:[]};Ye.profile=[];var Ze=function(e,a){t[a]._id&&!n[e].includes(t[a]._id)&&(Ye[a].push(t[a]._id),Qe=!0)},Xe=function(e){for(var a in t[e])n[e].includes(a)||(Ye[e].push(a),Qe=!0)};return Ze("account","account"),Ze("account","profile"),Ze("group","group"),Ze("progress","progress"),Xe("post"),Xe("friendData"),Xe("progressData"),Xe("transactionData"),Xe("postData"),Xe("groupData"),Qe&&e.removeData(Ye),$e(a),a},we=function(e,t,a,n){var r={user:[],account:[],progress:[],post:[],group:[],progressData:[],friendData:[],postData:[],groupData:[],transactionData:[]},i=function(n){for(var i in e[n])"undefined"!==typeof e[n][i]&&(a[n][i]?a[n][i]!==e[n][i]&&Ie(n,[i],t):r[n].push(i))},o=function(n){for(var i in e[n])"undefined"!==typeof e[n][i]&&(a[n]._id===i?(a[n].__v!==e[n][i]&&Ie(n,[i],t),a[n]._id||r[n].push(i)):r[n].push(i))};for(var s in e.user)"undefined"!==typeof e.user[s]&&(a.user._id===s?a.user.__v!==e.user[s]&&Ie("user",[s],t):r.user.push(s));for(var c in e.account)"undefined"!==typeof e.account[c]&&(a.account._id===c&&a.account.__v!==e.account[c]&&Ie("account",[c],t),a.profile._id===c&&(a.profile.__v!==e.account[c]&&Ie("account",[c],t),a.account._id||r.account.push(c))),a.account._id!==c&&a.profile._id!==c&&r.account.push(c);if(o("progress"),o("group"),i("post"),i("friendData"),i("progressData"),i("postData"),i("groupData"),i("transactionData"),r.user.length>0||r.account.length>0||r.progress.length>0||r.post.length>0||r.group.length>0||r.friendData.length>0||r.progressData.length>0||r.postData.length>0||r.groupData.length>0||r.transactionData.length>0)return r},Oe=function(e){var t=e.store,a={user:{},account:{},progress:{},post:{},group:{},transactionData:{},friendData:{},progressData:{},groupData:{},postData:{}};t.user&&t.user._id&&(a.user[t.user._id]=t.user.__v),t.account._id&&(a.account[t.account._id]=t.account.__v),t.profile._id&&(a.account[t.profile._id]=t.profile.__v),t.progress._id&&(a.progress[t.progress._id]=t.progress.__v),t.group._id&&(a.group[t.group._id]=t.group.__v);var n=function(e){for(var n in t[e])"undefined"!==typeof t[e][n]&&t[e][n]._id&&(a[e][t[e][n]._id]=t[e][n].__v)};return n("post"),n("friendData"),n("postData"),n("groupData"),n("progressData"),n("TransactionData"),a},De=(a(697).create({propertyFilter:function(e,t){return"patch"!==e}}),!1),_e=function(e){function t(){var e,a;Object(ge.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(ye.a)(this,(e=Object(Ee.a)(t)).call.apply(e,[this].concat(r)))).state={user:[],account:[],progress:[],post:[],group:[],friendData:[],progressData:[],postData:[],groupData:[],transactionData:[]},a.start=function(){var e;De=new WebSocket("wss://getreward.herokuapp.com");var t=function(t){var n;t&&(n=we(t,a.state,a.props.store,De)),clearTimeout(e),e=setTimeout(function(){De.close()},31e3),De.send(JSON.stringify({messageCode:"heartbeat",notNeededResources:n}))};De.onopen=function(e){var n=Oe(a.props);De.send(JSON.stringify({messageCode:"auth",user:l.a.defaults.headers.common["x-auth-token"],resourcesToMonitor:n})),a.initializeRequestResources(a.props),t()},De.onmessage=function(e){var n=JSON.parse(e.data);switch(n.messageCode){case"heartbeat":t(n.versions);break;case"logout":a.props.logout();break;case"successMessage":ie.b.success(n.messageText);break;case"errorMessage":ie.b.error(n.messageText);break;case"friendsData":a.props.setFriendsData(n.friendsData);break;case"redirectToProgresses":a.props.history.push("/progresses");break;case"addResource":a.props.saveResource(n.resources,n.type);break;case"updateResource":a.props.updateResource(n.code,n.id,n.update,a.state);break;case"friendSearchResult":a.props.setFriendSearchResult(n.data);break;case"error":ie.b.error(n.text)}},De.onclose=function(t){clearTimeout(e)}},a.checkInterval=null,a.check=function(){De&&3!==De.readyState||(clearInterval(a.checkInterval),a.checkInterval=setInterval(a.check,5e3),a.start())},a.reRequestResourcesInterval=null,a.reRequestResources=function(){for(var e=0,t=["user","account","progress","post","group","postData","groupData","progressData","friendData","transactionData"];e<t.length;e++){var n=t[e];a.state[n].length>0&&De&&1===De.readyState&&De.send(JSON.stringify({messageCode:"requestResource",ids:a.state[n],type:n}))}},a.initializeRequestResources=function(e){for(var t=ke(e),n=function(){var e=i[r];t[e].length>0&&De&&1===De.readyState&&(console.log("init send"),De.send(JSON.stringify({messageCode:"requestResource",ids:t[e].filter(function(t){return!a.state[e].includes(t)}),type:e})))},r=0,i=["user","account","progress","post","group","postData","groupData","progressData","friendData","transactionData"];r<i.length;r++)n();a.setState(function(){return t}),clearInterval(a.reRequestResourcesInterval),a.reRequestResourcesInterval=setInterval(a.reRequestResources,3e3)},a}return Object(ve.a)(t,e),Object(he.a)(t,[{key:"componentWillMount",value:function(){this.checkInterval=setInterval(this.check,50)}},{key:"componentWillUnmount",value:function(){clearInterval(this.checkInterval),De&&De.close()}},{key:"componentWillReceiveProps",value:function(e){this.initializeRequestResources(e)}},{key:"render",value:function(){return null}}]),t}(n.Component),je=Object(f.g)(Object(u.b)(function(e){return{store:e}},function(e){return{setData:function(t,a){return e(de(t))},removeData:function(t){return e(function(e){return{type:"REMOVE_DATA",data:e}}(t))},saveResource:function(t,a){return e(function(e,t){return function(a,n){if(e.length>0){var r=n();switch(t){case"user":var i=e[0],o=i.currentAccount;o||(o=i.myAccount),a(de({user:i,currentAccount:o}));break;case"account":var s=e.find(function(e){return e._id===r.currentAccount});s&&a(de({account:s}));var c=e.find(function(e){return e._id===r.currentProfile});c&&a(de({profile:c}));break;case"progress":var l=e.find(function(e){return e._id===r.currentProgress});l&&a(de({progress:l}));break;case"group":var u=e.find(function(e){return e._id===r.currentGroup});u&&a(de({group:u}));break;case"post":var d={},m=!0,p=!1,f=void 0;try{for(var g,h=e[Symbol.iterator]();!(m=(g=h.next()).done);m=!0){var y=g.value;d[y._id]=y}}catch(X){p=!0,f=X}finally{try{m||null==h.return||h.return()}finally{if(p)throw f}}a(de({post:d}));break;case"friendData":var E={},v=!0,b=!1,k=void 0;try{for(var w,O=e[Symbol.iterator]();!(v=(w=O.next()).done);v=!0){var D=w.value;E[D._id]=D}}catch(X){b=!0,k=X}finally{try{v||null==O.return||O.return()}finally{if(b)throw k}}a(de({friendData:E}));break;case"progressData":var _={},j=!0,I=!1,S=void 0;try{for(var x,C=e[Symbol.iterator]();!(j=(x=C.next()).done);j=!0){var T=x.value;_[T._id]=T}}catch(X){I=!0,S=X}finally{try{j||null==C.return||C.return()}finally{if(I)throw S}}a(de({progressData:_}));break;case"transactionData":var A={},P=!0,N=!1,F=void 0;try{for(var R,M=e[Symbol.iterator]();!(P=(R=M.next()).done);P=!0){var L=R.value;A[L._id]=L}}catch(X){N=!0,F=X}finally{try{P||null==M.return||M.return()}finally{if(N)throw F}}a(de({transactionData:A}));break;case"postData":var B={},z=!0,U=!1,V=void 0;try{for(var G,J=e[Symbol.iterator]();!(z=(G=J.next()).done);z=!0){var W=G.value;B[W._id]=W}}catch(X){U=!0,V=X}finally{try{z||null==J.return||J.return()}finally{if(U)throw V}}a(de({postData:B}));break;case"groupData":var q={},H=!0,K=!1,$=void 0;try{for(var Q,Y=e[Symbol.iterator]();!(H=(Q=Y.next()).done);H=!0){var Z=Q.value;q[Z._id]=Z}}catch(X){K=!0,$=X}finally{try{H||null==Y.return||Y.return()}finally{if(K)throw $}}a(de({groupData:q}))}}}}(t,a))},setFriendsData:function(t){return e(function(e){return{type:"SET_FRIENDS_DATA",data:e}}(t))},tryAuth:function(t,a){return e(ce(t,a))},updateResource:function(t,a,n,r){return e(Te(t,a,n,r))},setFriendSearchResult:function(t){return e(pe(t))}}})(_e)),Ie=function(e,t,a){var n=t.filter(function(t){return!a[e].includes(t)});De&&1===De.readyState&&De.send(JSON.stringify({messageCode:"requestResource",ids:n,type:e}))},Se=a(224),xe=a.n(Se),Ce=function(e,t,a){var n=xe()(e);!function(e,t,a){var n=function e(t,a,n){a.length>1?e(t[a.shift()],a,n):"array"===typeof t?t.push(n):t[a[0]]=n};for(var r in t){var i=r.split(".");a&&!a.includes(i[0])||"undefined"!==typeof t[r]&&n(e,i,t[r])}}(n,t.updatedFields,a);var r=function e(t,a){a.length>1?e(t[a.shift()],a):"object"===typeof t?delete t[a[0]]:"array"===typeof t&&t.splice(a[0],1)},i=!0,o=!1,s=void 0;try{for(var c,l=t.removedFields[Symbol.iterator]();!(i=(c=l.next()).done);i=!0){var u=c.value;if(u.indexOf(".")>-1){var d=u.split(".");a&&!a.includes(d[0])||r(n,d)}else delete n[u]}}catch(m){o=!0,s=m}finally{try{i||null==l.return||l.return()}finally{if(o)throw s}}return n},Te=function(e,t,a,n){return function(r,i){if(a&&t&&e){var o=i(),s=function(i){if(o[i]._id===t)if(o[i].__v===a.updatedFields.__v-1){var s=Ce(o[i],a);r(de(Object(fe.a)({},i,s)))}else o[i].id&&Ie(e,[t],n)},c=function(i,s){var c=Object(fe.a)({},i,xe()(o[i])),l=c[i][t];l&&(l.__v===a.updatedFields.__v-1?(c[i][t]=Ce(l,a,s),r(de(c))):Ie(e,[t],n))};switch(e){case"user":s("user");break;case"account":s("account"),s("profile");break;case"progress":s("progress");break;case"group":s("group");break;case"post":r(de(c(e)));break;case"friendData":r(de(c(e,["name","image","notifications","__v"])));break;case"progressData":r(de(c(e,["owner","worker","goal","notifications","__v"])));break;case"postData":case"groupData":r(de(c(e,["notifications","__v"])));break;case"transactionData":r(de(c(e)))}}}},Ae=a(12),Pe=a(225),Ne=a.n(Pe),Fe=a(329),Re=function(e,t,a,n){if(null==e)return alert("No file selected.");var r=new FileReader;r.onload=function(){var r=Object(Fe.a)(Ne.a.mark(function r(i){return Ne.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:Le(e,{width:t,height:t},function(e){Me(e,"/120").then(function(e){ze(e,a,n)})});case 1:case"end":return r.stop()}},r)}));return function(e){return r.apply(this,arguments)}}(),r.readAsArrayBuffer(e)},Me=function(e,t,a){return a=a||(e.match(/^data:([^;]+);/)||"")[1],fetch(e).then(function(e){return e.arrayBuffer()}).then(function(e){return new File([e],t,{type:a})})},Le=function(e,t,a){if(e){var n=new FileReader;n.onload=function(e){Be(e.target.result,t,a)},n.readAsDataURL(e)}},Be=function(e,t,a){var n,r=new Image;r.onload=function(){var e=r.width/t.width,i=r.height/t.height,o=document.createElement("canvas"),s=o.getContext("2d");o.width=r.width,o.height=r.height,s.drawImage(r,0,0),(e>1||i>1)&&(r.width>r.height?(o.height=r.height/r.width*t.width,o.width=t.width):(o.width=r.width/r.height*t.width,o.height=t.width)),s.drawImage(o,0,0,o.width,o.height),s.drawImage(r,0,0,o.width,o.height),n=o.toDataURL(),a(n)},r.src=e},ze=function(e,t,a){return l.a.post("/api/sign-s3",{fileName:t}).then(function(t){Ue(e,t.data,a)}).catch(function(e){})},Ue=function(e,t,a){return l.a.put(t.signedRequest,e,{headers:{"Content-Type":"multipart/form-data"}}).then(function(e){a(t.url),ie.b.success("The image has been saved.")}).catch(function(e){console.log(e)})},Ve=a(182),Ge=a(50),Je=a(69),We=a(80),qe=a.n(We),He=a(173),Ke=200,$e=1e4,Qe=1e4,Ye=[{required:!0,message:"Nickname is too short. Minimal length is 2.",whitespace:!0,min:2},{message:"Nickname is too long. Miximum length is ".concat(Ke,"."),whitespace:!0,max:Ke},{pattern:/^[a-zA-Z0-9_-]*$/,message:"Nickname should contain only letters, numbers, '-' and '_'."}],Ze=[{required:!0,min:1,whitespace:!0,message:"Name is too short. Minimal length is 1."},{max:Ke,message:"Name is too long. Miximum length is ".concat(Ke,".")}],Xe=[{required:!0,min:2,whitespace:!0,message:"Name is too short. Minimal length is 2."},{max:Ke,message:"Name is too long. Miximum length is ".concat(Ke,".")}],et=[{max:$e,message:"Description is too long. Miximum length is ".concat($e,".")}],tt=[{min:1,whitespace:!0,message:"Message is too short. Minimal length is 1."},{max:Qe,message:"Message is too long. Miximum length is ".concat(Qe,".")}],at=[{required:!0,message:"Please input the item price."}],nt=function(e){var t=Object(n.useState)(""),a=Object(g.a)(t,2),i=a[0],o=a[1],s=e.connections,c=e.perkId,l=e.perk,u=e.deletePerk,d=e.onFinish,m=e.images,p=e.setImages,f=e.uploadImage,h=r.a.createElement(Ge.a,{mode:"multiple",style:{width:"100%"},placeholder:"Please select"},s.map(function(e){return r.a.createElement(Ge.a.Option,{key:e._id},r.a.createElement(C.a,{src:Z(e._id,e.image),size:20,style:{marginRight:"10px"}}),e.name," - (",e._id,")")})),y=D.a.useForm(),E=Object(g.a)(y,1)[0];return!e.perkId||l?r.a.createElement(r.a.Fragment,null,r.a.createElement(D.a,Object.assign({form:E,name:"dynamic_form_nest_item",onFinish:d,autoComplete:"off",initialValues:l||{}},{labelCol:{span:8},wrapperCol:{span:16}}),r.a.createElement(D.a.Item,{name:"images",label:"Images",valuePropName:"images",getValueFromEvent:function(e){return Array.isArray(e)?e:e&&e.fileList.map(function(e){return e.url})}},r.a.createElement(Je.a,{listType:"picture-card",fileList:m.map(function(e,t){return Object(Ae.a)({},e,{uid:t})}),onPreview:function(e){o(e.url)},onChange:function(e){var t=e.fileList;return p(t)},customRequest:function(e){var t=e.file;f(t)}},m.length>=8?null:r.a.createElement("div",null,r.a.createElement(qe.a,null),r.a.createElement("div",{className:"ant-upload-text"},"Upload")))),r.a.createElement(D.a.Item,{label:"Name",name:"name",rules:Ze},r.a.createElement(_.a,{placeholder:"New item"})),r.a.createElement(D.a.Item,{label:"Description",name:"description",rules:et},r.a.createElement(_.a.TextArea,{placeholder:"Write a few words about this item."})),"shop"===e.mode&&r.a.createElement(D.a.Item,{label:"Available for",name:"users"},h),"shop"===e.mode&&r.a.createElement(D.a.Item,{label:"Price",name:"price",rules:at},r.a.createElement(Ve.a,null)),r.a.createElement(D.a.Item,{wrapperCol:{offset:8,span:16}},r.a.createElement(j.a,{type:"primary",htmlType:"submit",size:"large"},"Save"),c&&r.a.createElement(He.a,{title:"Are you sure you want to delete this item?",onConfirm:u,onCancel:function(){},okText:"Confirm",cancelText:"Cancel"},r.a.createElement(j.a,{type:"link",danger:!0,size:"large"},"Delete")))),r.a.createElement(b.a,{visible:i,footer:null,onCancel:function(){return o("")}},r.a.createElement("img",{alt:"example",style:{width:"100%"},src:i}))):null},rt=function(e,t,a,n,r,i){De&&1===De.readyState&&De.send(JSON.stringify({messageCode:"sendMessage",messageValue:a,imageUrl:n,postId:t,accountId:e,replyToMessage:r,editedMessage:i}))},it=function(e,t,a,n){De&&1===De.readyState&&De.send(JSON.stringify({messageCode:e,messageId:t,accountId:a,postId:n}))},ot=function(e,t,a,n,r){De&&1===De.readyState&&De.send(JSON.stringify({messageCode:"addPost",accountId:e,parentId:t,parentType:a,messageValue:n,imageUrl:r}))},st=function(e,t,a){a&&e&&t&&De&&1===De.readyState&&De.send(JSON.stringify({messageCode:"buyPerk"===mode,perkId:a,buyer:e,seller:t}))},ct=function(e,t){De&&1===De.readyState&&De.send(JSON.stringify({messageCode:"unfriend",accountId:e,friendId:t}))},lt=Object(f.g)(Object(u.b)(function(e){return{account:e.account,friendData:e.friendData}})(function(e){var t=Object(n.useState)(),a=Object(g.a)(t,2),i=a[0],o=a[1],s=Object(n.useState)([]),c=Object(g.a)(s,2),l=c[0],u=c[1],d=e.account,m=e.mode,p=e.perkId||"";Object(n.useEffect)(function(){if(p){var e="wishlist"===m?d.wishlist.find(function(e){return e.itemId===p}):"goals"===m?d.goals.find(function(e){return e.goalId===p}):d.perks.find(function(e){return e.perkId===p});e&&(o(e),u(e.images.map(function(e,t){return{url:e,uid:t}})))}},[]);var f=d.friends.filter(function(e){return"friend"===e.status}).map(function(t){return e.friendData[t.friend]});return!e.perkId||i?r.a.createElement(nt,{connections:f,perkId:p,perk:i,deletePerk:function(){!function(e,t,a){e&&t&&De&&1===De.readyState&&De.send(JSON.stringify({messageCode:"wishlist"===a?"deleteWishlistItem":"goals"===a?"deleteGoal":"deletePerk",id:t,accountId:e}))}(d._id,p,m),e.setEditPerkOpen(!1)},onFinish:function(t){var a=Object(Ae.a)({},t,{images:l.map(function(e){return e.url})});!function(e,t,a,n){e&&De&&1===De.readyState&&De.send(JSON.stringify({messageCode:"wishlist"===n?"saveWishlistItem":"goals"===n?"saveGoal":"savePerk",id:t,value:a,accountId:e}))}(d._id,p,a,m),e.setEditPerkOpen(!1)},images:l,setImages:u,uploadImage:function(e){Re(e,800,void 0,function(e){u([].concat(Object(be.a)(l),[{url:e}]).map(function(e,t){return Object(Ae.a)({},e,{uid:t})}))})},mode:e.mode}):null})),ut=a(30),dt=a(336),mt=function(e){return e.images&&e.images.length>0?r.a.createElement(dt.a,{style:{width:e.size||"auto"}},e.images.map(function(t){return t&&r.a.createElement("div",null,r.a.createElement("div",{style:{backgroundImage:'url("'+t+'")',backgroundSize:e.type||"contain",backgroundPosition:"center",width:e.size||"100%",height:e.height||e.size||"300px",backgroundRepeat:"no-repeat"}}))})):null},pt=a(58),ft=a(790),gt=(ut.a.Meta,Object(f.g)(function(e){var t=e.perk,a=e.perkId,n=e.owner,i=e.account,o=e.setEditedPerk,s=e.setEditPerkOpen,c=e.mode;return r.a.createElement(ut.a,{type:"inner",style:{width:"100%"},bordered:!1,extra:r.a.createElement("div",{onClick:function(e){return e.stopPropagation()}},n._id!==i._id||e.onlyBuy||"shop"!==e.mode?"shop"===e.mode?r.a.createElement(j.a,{type:"primary",onClick:function(){return st(i._id,n._id,a)}},"Buy"):n._id!==i._id||e.onlyBuy?null:r.a.createElement(pt.a,{overlay:r.a.createElement(x.a,null,r.a.createElement(x.a.Item,{key:"0",onClick:function(){o(a),s(!0)}},"Edit"))},r.a.createElement(j.a,{type:"link"},r.a.createElement(ft.a,null))):r.a.createElement(pt.a.Button,{type:"primary",key:"1",onClick:function(){return st(i._id,n._id,a)},overlay:r.a.createElement(x.a,null,r.a.createElement(x.a.Item,{key:"0",onClick:function(){o(a),s(!0)}},"Edit"))},"Buy")),title:r.a.createElement("div",{onClick:function(){return e.history.push("/".concat(c||"shop","/").concat(n._id,"/").concat(a))},style:{display:"flex",alignItems:"center"}},r.a.createElement("div",{style:{width:"50px",marginRight:"20px"}},r.a.createElement(mt,{images:t.images,size:50})),t.name,"shop"===c&&" ($".concat(t.price,")"))})})),ht=a(789),yt=function(e){return r.a.createElement(j.a,{onClick:e.action,type:"primary",shape:"round",icon:r.a.createElement(ht.a,null),size:"large"},e.title)},Et=function(e){var t=Object(n.useState)(""),a=Object(g.a)(t,2),i=a[0],o=a[1],s=Object(n.useState)(),c=Object(g.a)(s,2),l=c[0],u=c[1],d=e.account,m=r.a.createElement(b.a,{title:"Add item",visible:l,maskClosable:!0,closable:!0,onCancel:function(){return u(!1)},width:"90%",footer:r.a.createElement(j.a,{key:"back",onClick:function(){return u(!1)}},"Close"),destroyOnClose:!0},r.a.createElement(lt,{setEditPerkOpen:u,perkId:i,mode:e.mode}));return d._id?r.a.createElement(r.a.Fragment,null,r.a.createElement(yt,{action:function(){o(""),u(!0)},title:"Add item",sub:"shop"===e.mode&&"Set price"}),d[e.listKey||e.mode]&&d[e.listKey||e.mode].map(function(t,a){return r.a.createElement(gt,{key:a,perk:t,perkId:"wishlist"===e.mode||"goals"===e.mode?t.itemId:t.perkId,owner:d,account:d,setEditedPerk:o,setEditPerkOpen:u,mode:e.mode})}),m):null},vt=Object(f.g)(Object(u.b)(function(e){return{account:e.account}},function(e){return{setPageTitle:function(t){return e(me(t))}}})(function(e){return Object(n.useEffect)(function(){e.setPageTitle({main:"Goals",sub:""})},[]),e.account._id?r.a.createElement(Et,{mode:"goals",account:e.account}):r.a.createElement("span",null)})),bt=function(e,t,a,n,r){console.log("reqas"),l.a.get("/api"+e.history.location.pathname).then(function(t){oe(t,e),a(t.data),r(t.data)}).catch(function(e){})},kt=a(108),wt=a(139),Ot=a(340),Dt=a.n(Ot),_t=a(341),jt=a.n(_t),It=a(177),St=a.n(It),xt=a(109),Ct=a.n(xt),Tt=a(176),At=a.n(Tt),Pt=Object(f.g)(function(e){var t=Object(n.useState)(!1),a=Object(g.a)(t,2),i=a[0],o=a[1],s=e.post,c=e.account,l=Object(n.useState)(e.content||(e.replyToUser?"@"+e.replyToUser+" ":"")),u=Object(g.a)(l,2),d=u[0],m=u[1];return Object(n.useEffect)(function(){m(e.content||(e.replyToUser?"@"+e.replyToUser+" ":""))},[e.replyToUser,e.content]),s&&c._id?r.a.createElement("div",{style:Object(Ae.a)({background:"#fff"},e.replyTo?{}:{width:"100%",bottom:"-200px",left:"0px"})},r.a.createElement(kt.a,{avatar:r.a.createElement(C.a,{src:Z(c._id,c.image)}),content:r.a.createElement(r.a.Fragment,null,r.a.createElement(D.a.Item,{rules:tt,style:{margin:0}},r.a.createElement(_.a.TextArea,{autoSize:{minRows:1,maxRows:3},rows:1,onChange:function(e){return m(e.target.value)},value:d,placeholder:"Write a comment"})),r.a.createElement(D.a.Item,{style:{margin:0}},r.a.createElement(j.a,{htmlType:"submit",onClick:function(){rt(c._id,s._id,d,!1,e.replyTo,e.editingMessage),m(""),e.onSend&&e.onSend()},icon:r.a.createElement(At.a,null),size:"large",type:"text"},"Send"),r.a.createElement(Je.a,{showUploadList:!1,customRequest:function(t){var a=t.file;o(!0),Re(a,800,void 0,function(t){o(!1),rt(state,e,"",t,e.replyTo,e.editingMessage),e.onSend&&e.onSend()})}},r.a.createElement(j.a,{size:"large",type:"text",icon:i?r.a.createElement(Ct.a,null):r.a.createElement(St.a,null)},"Image"))))})):null}),Nt=Object(f.g)(Object(u.b)(function(e){return{isAuthed:e.isAuthed,account:e.account,profile:e.profile,friendData:e.friendData}})(function(e){var t=e.account,a=e.profile,n=e.friendData,i=e.id,o=function(e){return e===t._id?t:e===a._id?a:n[e]},s=function(e){return o(e)?o(e).name:e},c=function(t){return o(t)?r.a.createElement("span",{onClick:function(a){a.stopPropagation(),e.history.push("/profile/"+t)}},r.a.createElement(C.a,{src:Z(t,o(t).image),size:e.size||(e.noClick?20:30),style:e.group?{}:{margin:" 0 5px"}})):null};return e.group?r.a.createElement(C.a.Group,{style:{margin:" 0 5px"}},e.ids.map(function(e){return c(e)})):e.noClick?r.a.createElement(r.a.Fragment,null,!e.noAva&&c(i),!e.noName&&s(i)):e.span?r.a.createElement("span",{style:Object(Ae.a)({cursor:"pointer"},e.style),onClick:function(){return e.history.push("/profile/"+e.id)}},!e.noAva&&c(i),!e.noName&&s(i)):r.a.createElement(j.a,{type:"link",style:Object(Ae.a)({padding:"0px 5px",height:"auto"},e.style),onClick:function(){return e.history.push("/profile/"+e.id)}},!e.noAva&&c(i),!e.noName&&s(i))})),Ft=Object(f.g)(function e(t){var a=t.account,i=(t.state,t.setState,t.message),o=t.friendData,s=t.progressData,c=(t.groupData,t.post),l=t.replies,u=t.isStart,d=Object(n.useState)(!1),m=Object(g.a)(d,2),p=m[0],f=m[1],h=Object(n.useState)(""),y=Object(g.a)(h,2),E=y[0],v=y[1],b=Object(n.useState)(""),k=Object(g.a)(b,2),w=k[0],O=k[1],D={actions:!t.isStart&&[r.a.createElement("span",null,r.a.createElement(wt.a,{datetime:i.date,live:!0})),r.a.createElement("span",{key:"comment-basic-like"},r.a.createElement(S.a,{title:"Like"},i.likes.includes(a._id)?r.a.createElement(Dt.a,{onClick:function(){return it("dislikeMessage",i.messageId,a._id,c._id)}}):r.a.createElement(jt.a,{onClick:function(){return it("likeMessage",i.messageId,a._id,c._id)}})),r.a.createElement("span",{style:{paddingLeft:"8px"}},i.likes.length)),r.a.createElement("span",{key:"comment-basic-reply-to",onClick:function(){t.setReplyVisible?(t.setReplyVisible(!0),t.setReplyToUser(t.message.author)):(f(!0),v(""))}},"Reply to"),r.a.createElement("span",{key:"comment-basic-reply-to",onClick:function(){return O(i.messageId)}},"Edit")],avatar:r.a.createElement(C.a,{src:Z(i.author,o[i.author]?o[i.author].image:Math.floor(1e6*Math.random()))}),content:u?r.a.createElement(r.a.Fragment,null,"wishlist"===i.messageType&&r.a.createElement(r.a.Fragment,null," ",r.a.createElement("span",{style:{fontWeight:"bold",cursor:"pointer",margin:"10px 0px 0px "},onClick:function(){return t.history.push("/wishlist/".concat(i.details.owner,"/").concat(i.details.itemId))}},i.details.name)),i.text&&r.a.createElement("p",null,i.text)):r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:{background:"#eee",borderRadius:"5px",padding:"3px 10px",display:"inline-block"}},r.a.createElement(Nt,{id:i.author,span:!0,noAva:!0,style:{fontWeight:"bold"}}),i.image&&i.image.length>0&&r.a.createElement(mt,{images:i.image}),i.text&&r.a.createElement("p",null,i.text)),r.a.createElement("div",null)),author:u&&r.a.createElement("span",{style:{color:"#333",fontWeight:"bold",fontSize:"14px"}},r.a.createElement(Nt,{id:i.author,span:!0,noAva:!0})," ","\u21d2"," ",c.parent&&s&&s[c.parent.parentId]&&r.a.createElement("span",{style:{cursor:"pointer"},onClick:function(){return t.history.push("/progresses/"+c.parent.parentId)}},s[c.parent.parentId].goal.name),c.startMessage&&["wishlist","perk","goal"].includes(c.startMessage.messageType)&&r.a.createElement("span",{style:{cursor:"pointer"},onClick:function(){return t.history.push("/profile/"+i.author)}},"wishlist"===c.startMessage.messageType?"Wishlist":"goals"===c.startMessage.messageType?"Goals":"Shop")),datetime:u&&r.a.createElement("span",{style:{color:"#333"}},r.a.createElement(wt.a,{datetime:i.date,live:!0}))};return a&&o?a._id===i.author&&w?r.a.createElement(Pt,{post:c,account:a,replyTo:i.messageId,editingMessage:w,content:i.text,onSend:function(){return O("")}}):r.a.createElement(kt.a,D,t.isTop&&l&&l.length?l.map(function(t,n){return r.a.createElement(e,{key:n,message:t,post:c,account:a,friendData:o,setReplyVisible:f,setReplyToUser:v})}):null,t.isTop&&p?r.a.createElement(Pt,{post:c,account:a,replyTo:i.messageId,replyToUser:E}):null):null}),Rt=a(787),Mt=a(786),Lt=a(72),Bt=Object(f.g)(function(e){var t=e.post,a=e.account,i=e.friendData,o=e.progressData,s=e.groupData,c=Object(n.useState)(e.showReplies),l=Object(g.a)(c,2),u=l[0],d=l[1];return t?r.a.createElement(r.a.Fragment,null,!e.noStartMessage&&r.a.createElement(r.a.Fragment,null,r.a.createElement(Ft,{message:t.startMessage,post:t,account:a,friendData:i,progressData:o,groupData:s,replies:[],isStart:!0}),t.startMessage.image&&t.startMessage.image.length>0&&r.a.createElement(mt,{images:t.startMessage.image,height:"60vw",type:"cover"})),r.a.createElement(Lt.a,{type:"horizontal",style:{margin:"5px 0"}}),r.a.createElement("div",{style:{textAlign:"left",position:"relative"}},r.a.createElement("div",{style:{display:"flex",justifyContent:"space-around"}},r.a.createElement("span",{key:"comment-basic-like"},t.startMessage.likes.includes(a._id)?r.a.createElement(Rt.a,{onClick:function(){return it("dislikeMessage",t.startMessage.messageId,a._id,t._id)}}):r.a.createElement(Mt.a,{onClick:function(){return it("likeMessage",t.startMessage.messageId,a._id,t._id)}}),r.a.createElement("span",{style:{paddingLeft:"8px"}},t.startMessage.likes.length)),r.a.createElement("span",null,r.a.createElement(j.a,{onClick:function(){return d(!0)},type:"text"},"Comment",r.a.createElement("span",{style:{paddingLeft:"8px"}},function(e){var t=0,a=!0,n=!1,r=void 0;try{for(var i,o=e[Symbol.iterator]();!(a=(i=o.next()).done);a=!0)t=t+1+i.value.replies.length}catch(s){n=!0,r=s}finally{try{a||null==o.return||o.return()}finally{if(n)throw r}}return t}(t.messages))))),r.a.createElement(Lt.a,{type:"horizontal",style:{margin:"5px 0"}}),u?r.a.createElement(r.a.Fragment,null,r.a.createElement(Pt,{post:t,account:a}),t.messages&&t.messages.length?t.messages.map(function(e,n){return r.a.createElement(Ft,{key:n,message:e,post:t,account:a,friendData:i,replies:e.replies,isTop:!0})}):null):r.a.createElement(j.a,{onClick:function(){return d(!0)},type:"text"},"Show replies"))):null}),zt=Object(f.g)(Object(u.b)(function(e){return{isAuthed:e.isAuthed,account:e.account,post:e.post,friendData:e.friendData}},function(e){return{setData:function(t){e(de(t))},setPageTitle:function(t){return e(me(t))}}})(function(e){var t=Object(n.useState)({}),a=Object(g.a)(t,2),i=a[0],o=a[1],s=e.account;if(Object(n.useEffect)(function(){var t=e.history.location.pathname.split("/");if(t.length>3){var a=t[2];if(e.isAuthed&&s._id===a){var n=s.goals.find(function(e){return e.itemId===t[3]});o({profile:s,goal:n})}else bt(e,0,o,0,function(t){var a={},n=!0,r=!1,i=void 0;try{for(var o,s=t.friendData[Symbol.iterator]();!(n=(o=s.next()).done);n=!0){var c=o.value;a[c._id]=c}}catch(l){r=!0,i=l}finally{try{n||null==s.return||s.return()}finally{if(r)throw i}}e.setData({post:Object(fe.a)({},t.post._id,t.post),friendData:a})})}},[e.isAuthed]),!i.goal)return null;var c=i.goal,l=i.profile;return e.setData({currentPosts:c.post}),c&&e.setPageTitle({main:c.name,sub:l._id}),c?r.a.createElement(ut.a,{title:r.a.createElement("span",null,"Goal from ",r.a.createElement(Nt,{id:l._id})," goals"),bordered:!1},r.a.createElement(mt,{images:c.images}),r.a.createElement("h1",null,c.name),r.a.createElement("p",{style:{whiteSpace:"pre-wrap"}},c.description),r.a.createElement(Bt,{noStartMessage:!0,post:e.post[c.post],account:e.account,friendData:e.friendData,showReplies:!0})):null})),Ut=a(29),Vt=a(62),Gt=Object(f.g)(function(e){var t=e.progress,a=t.goal;return r.a.createElement(ut.a,{type:"inner",style:{width:"100%"},bordered:!1,title:r.a.createElement("div",{onClick:function(){return e.history.push("/progresses/"+t._id)},style:{display:"flex",alignItems:"center"}},a.images.length>0&&r.a.createElement("div",{style:{width:"50px",marginRight:"20px"}},r.a.createElement(ImageCarousel,{images:a.images,size:50})),a.name," -"," ",r.a.createElement(Nt,{id:t.owner,noName:!0})," =>"," ",r.a.createElement(Nt,{ids:t.goal.users,group:!0}))})}),Jt=a(61),Wt=a(355),qt=a(226),Ht=function(e,t,a,n){return r.a.createElement(Ge.a,{mode:"multiple",style:{width:"100%"},placeholder:"Please select",value:a,onChange:n},[e].concat(Object(be.a)(e.friends.filter(function(e){return"friend"===e.status}).map(function(e){return t[e.friend]}))).map(function(e){return r.a.createElement(Ge.a.Option,{key:e._id},r.a.createElement(Nt,{id:e._id,noClick:!0}))}))},Kt=a(52),$t=Object(f.g)(Object(u.b)(function(e){return{isAuthed:e.isAuthed,account:e.account,friendData:e.friendData,progress:e.progress}})(function(e){var t=Object(n.useState)(""),a=Object(g.a)(t,2),i=a[0],o=a[1],s=Object(n.useState)(),c=Object(g.a)(s,2),l=c[0],u=c[1],d=Object(n.useState)(),m=Object(g.a)(d,2),p=m[0],f=m[1],h=Object(n.useState)(),y=Object(g.a)(h,2),E=y[0],v=y[1],k=e.account,w=e.friendData,O=e.readOnly,I=e.progress,S=e.rewards.findIndex(function(t){return t.key===e.rewardKey});return-1===S&&e.setRewards&&e.setRewards([].concat(Object(be.a)(e.rewards),[{key:e.rewardKey,rewards:[]}])),S>=0?r.a.createElement("div",null,r.a.createElement(D.a.Item,{label:e.label,key:e.rewardKey},r.a.createElement("ol",null,e.rewards[S].rewards.map(function(t,a){return r.a.createElement("li",null,r.a.createElement(j.a,{type:"link",onClick:function(){return u(t)}},"simple"===t.mode?t.simple:"money"===t.mode?t.money+" (money)":"item"===t.mode?t.itemName:""),r.a.createElement(Nt,{id:t.owner,noName:!0})," ","=>",r.a.createElement(Nt,{id:t.for,noName:!0}),t.owner===k._id&&!O&&r.a.createElement(r.a.Fragment,null,r.a.createElement(pt.a,{overlay:r.a.createElement(x.a,null,r.a.createElement(x.a.Item,{onClick:function(){v(a),f(t)}},"Edit"),r.a.createElement(x.a.Item,{onClick:function(){var n,r,i,o;if(window.confirm("Are you sure you want to delete this item?"))if(e.setRewards){var s=Object(be.a)(e.rewards);s[S]=Object(Ae.a)({},s[S],{rewards:s[S].rewards.filter(function(e,t){return t!==a})}),e.setRewards(s)}else n=k._id,r=I._id,i=e.rewardKey,o=t.rewardId,De&&1===De.readyState&&De.send(JSON.stringify({messageCode:"deleteReward",accountId:n,progressId:r,rewardKey:i,rewardId:o}))}},"Delete"))},r.a.createElement(j.a,{type:"link"},r.a.createElement(ft.a,null)))))})),!O&&r.a.createElement(j.a,{type:"link",onClick:function(){v("new"),f({mode:"simple"})}},r.a.createElement(qe.a,null),"Add rewards")),r.a.createElement(b.a,{visible:p,title:"new"===p?"Add new reward":"Edit reward",closable:!0,onCancel:function(){return f()},onOk:function(){var t,a,n,r,i={};if("money"===p.mode?(i.money=p.money,i.mode=p.mode,i.for=p.for,i.rewardId=p.rewardId):i=Object(Ae.a)({},p,{money:void 0}),i.owner=k._id,e.setRewards){var o=Object(be.a)(e.rewards);o[S]="new"===E?Object(Ae.a)({},o[S],{rewards:[].concat(Object(be.a)(o[S].rewards),[i])}):Object(Ae.a)({},o[S],{rewards:o[S].rewards.map(function(e,t){return t===E?i:e})}),e.setRewards(o),f(),v()}else t=k._id,a=I._id,n=e.rewardKey,r=i,De&&1===De.readyState&&De.send(JSON.stringify({messageCode:"saveReward",accountId:t,progressId:a,rewardKey:n,reward:r})),f(),v()},destroyOnClose:!0,okText:"Save"},p&&r.a.createElement(r.a.Fragment,null,r.a.createElement(D.a.Item,{label:"Reward type"},r.a.createElement(Ge.a,{placeholder:"Type",value:p.mode,onSelect:function(e){f(Object(Ae.a)({},p,{mode:e}))},style:{width:"100%"}},r.a.createElement(Ge.a.Option,{key:"simple",value:"simple"},"Simple reward"),r.a.createElement(Ge.a.Option,{key:"item",value:"item"},"Item reward"),r.a.createElement(Ge.a.Option,{key:"money",value:"money"},"Money reward"))),r.a.createElement(D.a.Item,{label:"Reward for"},Ht(k,w,p.for,function(e){f(Object(Ae.a)({},p,{for:e}))}),r.a.createElement("p",null,"(leave blank for all)")),r.a.createElement(Lt.a,{type:"horizontal"}),"simple"===p.mode?r.a.createElement(D.a.Item,{label:"Description",rules:[].concat(Object(be.a)(et),[{required:!0,min:1,whitespace:!0,message:"Desription is too short. Minimal length is 1."}])},r.a.createElement(_.a.TextArea,{value:p.simple,onChange:function(e){var t=e.target.value;return f(Object(Ae.a)({},p,{simple:t}))},placeholder:"Explain how you will reward"})):"money"===p.mode?r.a.createElement(D.a.Item,{label:"Amount",rules:at},r.a.createElement(Ve.a,{value:p.money,onChange:function(e){f(Object(Ae.a)({},p,{money:e}))}})):r.a.createElement(r.a.Fragment,null,r.a.createElement(D.a.Item,{label:"Images"},r.a.createElement(Je.a,{listType:"picture-card",fileList:(p.itemImages||[]).map(function(e,t){return{url:e,uid:t}}),onPreview:function(e){o(e.url)},onChange:function(e){var t=e.fileList;f(Object(Ae.a)({},p,{itemImages:t.map(function(e){return e.url})}))},customRequest:function(e){var t=e.file;Re(t,800,void 0,function(e){f(Object(Ae.a)({},p,{itemImages:[].concat(Object(be.a)(p.itemImages||[]),[e])}))})}},(p.itemImages||[]).length>=8?null:r.a.createElement("div",null,r.a.createElement(qe.a,null),r.a.createElement("div",{className:"ant-upload-text"},"Upload")))),r.a.createElement(D.a.Item,{label:"Name",rules:Ze},r.a.createElement(_.a,{value:p.itemName,onChange:function(e){var t=e.target.value;return f(Object(Ae.a)({},p,{itemName:t}))}})),r.a.createElement(D.a.Item,{label:"Description",rules:et},r.a.createElement(_.a.TextArea,{value:p.itemDescription,onChange:function(e){var t=e.target.value;return f(Object(Ae.a)({},p,{itemDescription:t}))}}))))),r.a.createElement(b.a,{visible:i,footer:null,onCancel:function(){return o("")}},r.a.createElement("img",{alt:"example",style:{width:"100%"},src:i})),r.a.createElement(b.a,{visible:l,footer:null,onCancel:function(){return u()},title:"Reward details"},l?r.a.createElement(r.a.Fragment,null,l.itemImages&&l.itemImages.map(function(e,t){return r.a.createElement("span",{key:t,onClick:function(){return o(e)}},r.a.createElement(Card,{type:"inner",style:{width:200,display:"inline-block"},hoverable:!0,cover:r.a.createElement("div",{style:{backgroundImage:"url("+e+")",height:200,width:200,backgroundSize:"cover"}})}))}),r.a.createElement(Kt.a,{title:"Reward description",bordered:!0,column:{xxl:4,xl:3,lg:3,md:3,sm:2,xs:1}},"item"===l.mode&&r.a.createElement(Kt.a.Item,{label:"Name"},l.itemName),"item"===l.mode&&r.a.createElement(Kt.a.Item,{label:"Description"},l.itemDescription),"simple"===l.mode&&r.a.createElement(Kt.a.Item,{label:"Description"},l.simple),"money"===l.mode&&r.a.createElement(Kt.a.Item,{label:"Money"},l.money))):null)):null})),Qt=a(114),Yt=function(e){var t=e.goal,a=e.account,i=e.friendData,o=Object(n.useState)(t&&t.milestones||[{name:"Milestone 1",key:"mile1"}]),s=Object(g.a)(o,2),c=s[0],l=s[1],u=Object(n.useState)(t&&t.images.map(function(e,t){return{url:e,uid:t}})||[]),d=Object(g.a)(u,2),m=d[0],p=d[1],f=Object(n.useState)(t&&t.withMilestones),h=Object(g.a)(f,2),y=h[0],E=h[1],v=Object(n.useState)(""),k=Object(g.a)(v,2),w=k[0],O=k[1],I=Object(n.useState)(t&&t.newTabIndex||2),S=Object(g.a)(I,2),C=S[0],T=S[1],A=Object(n.useState)(t&&t.rewardsGroups||[]),P=Object(g.a)(A,2),N=P[0],F=P[1],R=function(e){console.log(e);var t=Object(be.a)(c),a="mile".concat(C);if("undefined"!==typeof e){var n=c.findIndex(function(t){return t.key===e});if(n<0)return;t.splice(n+1,0,{key:a,name:"New milestone"})}else console.log("here"),t.push({key:a,name:"New milestone"});l(t),T(C+1),L.setFieldsValue(Object(fe.a)({},a,{key:a,name:"New milestone"}))},M=D.a.useForm(),L=Object(g.a)(M,1)[0],B=Ht(a,i),z=function(e){return r.a.createElement(Qt.a,{overlay:r.a.createElement(x.a,{onClick:function(e){return e.domEvent.stopPropagation()}},r.a.createElement(x.a.Item,{key:"0",onClick:function(){R(e.milestone)}},"Add a milestone below"),r.a.createElement(x.a.Item,{key:"1",onClick:function(){var t=c.findIndex(function(t){return t.key===e.milestone});if(!(t<=0)){var a=Object(be.a)(c);a.splice(t-1,0,a.splice(t,1)[0]),l(a)}}},"Move up"),r.a.createElement(x.a.Item,{key:"2",onClick:function(){var t=c.findIndex(function(t){return t.key===e.milestone});if(!(t<0||t>=c.length-1)){var a=Object(be.a)(c);a.splice(t+1,0,a.splice(t,1)[0]),l(a)}}},"Move down"),r.a.createElement(x.a.Divider,null),r.a.createElement(x.a.Item,{key:"3",danger:!0,onClick:function(){var t=c.filter(function(t){return t.key!==e.milestone});l(t)}},"Delete")),trigger:["click"]},r.a.createElement("a",{className:"ant-dropdown-link",onClick:function(e){e.preventDefault(),e.stopPropagation()}},r.a.createElement(ft.a,null)))};return!e.goalId||t?r.a.createElement(r.a.Fragment,null,r.a.createElement(D.a,Object.assign({form:L,name:"dynamic_form_nest_item",onFinish:function(t){var a=[],n=!0,r=!1,i=void 0;try{for(var o,s=c[Symbol.iterator]();!(n=(o=s.next()).done);n=!0){var l=o.value;a.push(Object(Ae.a)({},t[l.key],{key:l.key,name:l.name}))}}catch(u){r=!0,i=u}finally{try{n||null==s.return||s.return()}finally{if(r)throw i}}e.onFinish(Object(Ae.a)({},t,{images:m.map(function(e){return e.url}),milestones:c,milestonesValues:a,newTabIndex:C,rewardsGroups:N}))},autoComplete:"off",initialValues:t||{name:"New goal",mile1:{name:"Milestone 1",key:"mile1"}}},{labelCol:{span:8},wrapperCol:{span:16}},{onValuesChange:function(e){var t=function(t){var a=c.findIndex(function(e){return e.key===t});if(a>-1&&e[t].name){var n=Object(be.a)(c);n[a]=Object(Ae.a)({},n[a],{name:e[t].name}),l(n)}"withMilestones"===t&&E(e[t])};for(var a in e)t(a)}}),r.a.createElement(D.a.Item,{name:"images",label:"Images",valuePropName:"images",getValueFromEvent:function(e){return Array.isArray(e)?e:e&&e.fileList.map(function(e){return e.url})}},r.a.createElement(Je.a,{listType:"picture-card",fileList:m.map(function(e,t){return Object(Ae.a)({},e,{uid:t})}),onPreview:function(e){O(e.url)},onChange:function(e){var t=e.fileList;return p(t)},customRequest:function(e){var t=e.file;Re(t,800,void 0,function(e){p([].concat(Object(be.a)(m),[{url:e}]).map(function(e,t){return Object(Ae.a)({},e,{uid:t})}))})}},m.length>=8?null:r.a.createElement("div",null,r.a.createElement(qe.a,null),r.a.createElement("div",{className:"ant-upload-text"},"Upload")))),r.a.createElement(D.a.Item,{label:"Name",name:"name",rules:Ze},r.a.createElement(_.a,null)),r.a.createElement(D.a.Item,{label:"Description",name:"description",rules:et},r.a.createElement(_.a.TextArea,{autoSize:{minRows:4,maxRows:20},placeholder:"Write a few words about why this goal is important and how to achieve it."})),r.a.createElement(D.a.Item,{label:"Achievers",name:"users"},B),r.a.createElement(D.a.Item,{label:"Experts",name:"experts"},B),r.a.createElement(D.a.Item,{label:"Supporters",name:"supporters"},B),r.a.createElement($t,{rewardKey:"start",label:"Start rewards",rewards:N,setRewards:F}),r.a.createElement($t,{rewardKey:"finish",label:"Finish rewards",rewards:N,setRewards:F}),r.a.createElement(D.a.Item,{label:"Milestones",name:"withMilestones",valuePropName:"checked"},r.a.createElement(Wt.a,null)),y&&r.a.createElement(r.a.Fragment,null,r.a.createElement(Lt.a,null,"Milestones"),r.a.createElement(qt.a,{expandIconPosition:"right"},c.map(function(e){return r.a.createElement(qt.a.Panel,{header:L.getFieldValue([e.key,"name"]),key:e.key,extra:r.a.createElement(z,{milestone:e.key})},r.a.createElement(D.a.Item,{label:"Name",name:[e.key,"name"],rules:Ze},r.a.createElement(_.a,null)),r.a.createElement(D.a.Item,{label:"Description",name:[e.key,"description"],rules:et},r.a.createElement(_.a.TextArea,{placeholder:"Write a few words about why this milestone is important and how to achieve it."})),r.a.createElement($t,{rewardKey:e.key,label:"Rewards",rewards:N,setRewards:F}))})),r.a.createElement(j.a,{type:"link",onClick:function(){return R()}},r.a.createElement(qe.a,null)," Add a new milestone")),r.a.createElement(D.a.Item,{wrapperCol:{offset:8,span:16}},r.a.createElement(j.a,{type:"primary",htmlType:"submit",size:"large"},"Save"))),r.a.createElement(b.a,{visible:w,footer:null,onCancel:function(){return O("")}},r.a.createElement("img",{alt:"example",style:{width:"100%"},src:w}))):null},Zt=function(e){return e.account._id?r.a.createElement(Yt,{onFinish:function(t){!function(e,t,a){De&&1===De.readyState&&De.send(JSON.stringify({messageCode:"startProgress",accountId:e,value:t,inGroup:a}))}(e.account._id,t,e.inGroup),e.setStartProgressVisible(!1)},account:e.account,friendData:e.friendData}):null},Xt=ut.a.Meta,ea=Object(f.g)(function(e){var t=e.group;return r.a.createElement("div",{style:{display:"inline-block",margin:"4px 8px"},onClick:function(){return e.history.push("/groups/"+t._id)}},r.a.createElement(ut.a,{type:"inner",style:{width:200},hoverable:!0,cover:r.a.createElement("div",{onClick:function(){return e.history.push("/groups/"+t._id)},style:{backgroundImage:"url("+(t.images&&t.images.length>0&&t.images[0])+")",height:200,width:200,backgroundSize:"cover"}})},r.a.createElement(Xt,{title:t.name})))}),ta=Ut.a.TabPane,aa=Object(f.g)(Object(u.b)(function(e){return{account:e.account,profile:e.profile,isAuthed:e.isAuthed,progressData:e.progressData,groupData:e.groupData,friendData:e.friendData}},function(e){return{setData:function(t,a){return e(de(t))},setPageTitle:function(t){return e(me(t))},tryAuth:function(t,a){return e(ce(t,a))}}})(function(e){var t,a,i=e.fromProfile,o=e.progressData,s=e.account,c=e.groupData,l=e.profile,u=i?l:s,d=u.progresses,m=u.groups,p=Object(n.useState)(!1),f=Object(g.a)(p,2),h=f[0],y=f[1];e.setPageTitle({main:"Progresses",sub:""}),d&&(t=d.filter(function(e){return o[e]}).map(function(e){return o[e]}),a=m.filter(function(e){return c[e]&&c[e].active}).map(function(e){return c[e]}));var E=i?null:r.a.createElement(Jt.a,{title:"Add progress",visible:h,maskClosable:!0,closable:!0,onCancel:function(){return y(!1)},width:"90%",footer:r.a.createElement(j.a,{key:"back",onClick:function(){return y(!1)}},"Close"),destroyOnClose:!0},r.a.createElement(Zt,{setStartProgressVisible:y,account:s,friendData:e.friendData}));return t&&a?r.a.createElement(Ut.a,{style:{background:"transparent",boxShadow:"none",margin:"0",marginTop:"-15px"}},r.a.createElement(ta,{tab:"Progresses",key:"1"},!i&&r.a.createElement(r.a.Fragment,null,r.a.createElement(yt,{title:"Start a new progress",sub:"Rich your goals or help others!",action:function(){y(!0)}}),E),t.map(function(e,t){return r.a.createElement(Gt,{key:t,progress:e})})),r.a.createElement(ta,{tab:"Groups",key:"2"},a.length>0?a.map(function(e,t){return r.a.createElement(ea,{key:t,group:e})}):r.a.createElement(Vt.a,{imageStyle:{height:160},description:r.a.createElement("span",null,"Here you will find your groups. Groups can be created in existing progresses.")}))):null})),na=a(180),ra=Kt.a.Item,ia=function(e){var t=e.progress,a=e.account,n=e.state,i=e.setState,o=t.goal,s=o.rewardsGroups,c=function(t){var a=t.checked,n=t.milestoneId,i=t.disabled;return r.a.createElement(h.a,{checked:a,onChange:function(t){return function(e,t,a){De&&1===De.readyState&&De.send(JSON.stringify({messageCode:"changeStage",milestoneId:a,value:t,progressId:e.progress._id,accountId:e.account._id}))}(e,t.target.checked,n)},disabled:i})},l=[{title:"Milestone",dataIndex:"name",key:"name",render:function(e){return r.a.createElement(j.a,{type:"link",onClick:function(){return i(Object(Ae.a)({},n,{previewMilestone:e}))}},e.name)},fixed:"left"},{title:"Rewards",dataIndex:"rewards",key:"rewards",render:function(e){return r.a.createElement($t,{rewardKey:e,rewards:s,readOnly:!a._id})}},{title:"Status",dataIndex:"status",key:"status",render:function(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",null,e?"Paid:":"Not finished"),e&&r.a.createElement($t,{rewardKey:1,rewards:[{rewards:e,key:1}],readOnly:!0}))}}].concat(Object(be.a)(o.users.map(function(e){return{title:r.a.createElement(r.a.Fragment,null,r.a.createElement(Nt,{id:e,noName:!0})," (ach)"),dataIndex:e,key:e,render:c,align:"center"}})),[{title:r.a.createElement(r.a.Fragment,null,r.a.createElement(Nt,{id:t.owner,noName:!0})," (own)"),dataIndex:"owner",key:"owner",render:c,align:"center"}],Object(be.a)(o.experts.map(function(e){return{title:r.a.createElement(r.a.Fragment,null,r.a.createElement(Nt,{id:e,noName:!0})," (exp)"),dataIndex:e,key:e,render:c,align:"center"}}))),u=function(e,t,n){return{checked:t.approvedBy.find(function(t){return t.accountId===e}),milestoneId:n.key,disabled:e!==a._id}},d=function(e,a){var n=t.stages.find(function(t){return t.milestoneId===e.key})||{approvedBy:[]},r={},i=!0,s=!1,c=void 0;try{for(var l,d=o.experts[Symbol.iterator]();!(i=(l=d.next()).done);i=!0){var m=l.value;r[m]=u(m,n,e)}}catch(b){s=!0,c=b}finally{try{i||null==d.return||d.return()}finally{if(s)throw c}}var p={},f=!0,g=!1,h=void 0;try{for(var y,E=o.users[Symbol.iterator]();!(f=(y=E.next()).done);f=!0){var v=y.value;p[v]=u(v,n,e)}}catch(b){g=!0,h=b}finally{try{f||null==E.return||E.return()}finally{if(g)throw h}}return Object(Ae.a)({key:a,name:e,rewards:e.key,status:n.paid},p,{owner:u(t.owner,n,e)},r)},m=[d({key:"start",name:"Start",description:"At this stage owner and user should agree to start this progress."},"start")].concat(Object(be.a)(o.withMilestones?o.milestonesValues.map(d):[]),[d({key:"finish",name:"Finish",description:"At this stage owner and user should agree to finish this progress."},"finish")]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(na.a,{columns:l,dataSource:m,scroll:{x:"max-content"},bordered:!0}),r.a.createElement(b.a,{visible:n.previewMilestone,footer:null,onCancel:function(){return i(Object(Ae.a)({},n,{previewMilestone:""}))},closable:!0},n.previewMilestone?r.a.createElement(r.a.Fragment,null,r.a.createElement("h2",null,n.previewMilestone.name),r.a.createElement("p",null,n.previewMilestone.description),r.a.createElement(Kt.a,{title:"Milestone description",bordered:!0,column:{xxl:4,xl:3,lg:3,md:3,sm:2,xs:1}},r.a.createElement(ra,{label:"Rewards"},r.a.createElement($t,{rewardKey:n.previewMilestone.key,rewards:s,readOnly:!0})))):null))},oa=function(e){var t=e.progress,a=e.account,n=e.state,i=e.setState,o={},s=!0,c=!1,l=void 0;try{for(var u,d=t.goal.milestonesValues[Symbol.iterator]();!(s=(u=d.next()).done);s=!0){var m=u.value;o[m.key]=m}}catch(f){c=!0,l=f}finally{try{s||null==d.return||d.return()}finally{if(c)throw l}}var p=Object(Ae.a)({},t.goal,o);return p?r.a.createElement(Yt,{goal:p,onFinish:function(t){!function(e,t){De&&1===De.readyState&&De.send(JSON.stringify({messageCode:"editGoalInProgress",progressId:e.progress._id,accountId:e.account._id,value:t}))}(e,t),i(Object(Ae.a)({},n,{editProgressOpen:!1}))},account:a}):null},sa=Kt.a.Item,ca=Object(f.g)(function(e){var t=e.account,a=e.progress,n=e.state,i=e.setState,o=a.goal;return o?r.a.createElement(r.a.Fragment,null,o.images.map(function(e,t){return r.a.createElement("span",{key:t,onClick:function(){return i(Object(Ae.a)({},n,{previewImage:e}))}},r.a.createElement(ut.a,{type:"inner",style:{width:200,display:"inline-block"},hoverable:!0,cover:r.a.createElement("div",{style:{backgroundImage:"url("+e+")",height:200,width:200,backgroundSize:"cover"}})}))}),r.a.createElement("h1",null,o.name),r.a.createElement("p",null,o.description),r.a.createElement(Kt.a,{title:"Goal description",bordered:!0,column:{xxl:4,xl:3,lg:3,md:3,sm:2,xs:1}},r.a.createElement(sa,{label:"Status"},a.status),r.a.createElement(sa,{label:"Worker"},o.users&&r.a.createElement(Nt,{ids:o.users,group:!0})),r.a.createElement(sa,{label:"Owner"},r.a.createElement(Nt,{id:a.owner,noName:!0})),r.a.createElement(sa,{label:"Supporters"},o.supporters&&r.a.createElement(Nt,{ids:o.supporters,group:!0})),r.a.createElement(sa,{label:"Experts"},o.experts&&r.a.createElement(Nt,{ids:o.experts,group:!0}))),r.a.createElement(Lt.a,{orientation:"center",type:"horizontal"},"Milestones"),r.a.createElement(ia,{progress:a,account:t,state:n,setState:i}),t._id===a.owner&&r.a.createElement(j.a,{style:{margin:"0px 20px 50px 0px"},type:"primary",onClick:function(){i(Object(Ae.a)({},n,{editProgressOpen:!0}))}},"Edit progress"),t._id===a.owner&&r.a.createElement(He.a,{title:"Create a group if you want to have more similar prgresses with the same people.",onConfirm:function(){return e=t._id,n=a._id,void(De&&1===De.readyState&&De.send(JSON.stringify({messageCode:"createGroup",progressId:n,accountId:e})));var e,n}},r.a.createElement(j.a,{style:{margin:"0px 20px 50px 0px"},type:"primary"},"Create a group")),t.progresses&&t.progresses.includes(a._id.toString())&&r.a.createElement(j.a,{danger:!0,onClick:function(){var t;t=e,De&&1===De.readyState&&De.send(JSON.stringify({messageCode:"leaveProgress",progressId:t.progress._id,accountId:t.account._id}))}},"Leave the progress"),r.a.createElement(b.a,{visible:n.editProgressOpen,footer:null,onCancel:function(){return i(Object(Ae.a)({},n,{editProgressOpen:!1}))},closable:!0,destroyOnClose:!0,width:"80%"},r.a.createElement(oa,{progress:a,account:t,state:n,setState:i}))):null}),la=Object(f.g)(function(e){var t=Object(n.useState)(!1),a=Object(g.a)(t,2),i=a[0],o=a[1],s=e.parent,c=e.account,l=e.parentType,u=Object(n.useState)(e.content||(e.replyToUser?"@"+e.replyToUser+" ":"")),d=Object(g.a)(u,2),m=d[0],p=d[1];return Object(n.useEffect)(function(){p(e.content||(e.replyToUser?"@"+e.replyToUser+" ":""))},[e.replyToUser,e.content]),c._id?r.a.createElement("div",{style:{background:"#fff",padding:"0px 10px",boxShadow:"0 4px 5px 0 rgba(0, 0, 0, 0.14), 0 -1px 10px 0 rgba(0, 0, 0, 0.12), 0 2px 4px -1px rgba(0, 0, 0, 0.2)",bottom:"0px",left:"0px",zIndex:1e3}},r.a.createElement("h2",null,"Post something new"),r.a.createElement(kt.a,{avatar:r.a.createElement(C.a,{src:Z(c._id,c.image)}),content:r.a.createElement(r.a.Fragment,null,r.a.createElement(D.a.Item,{rules:tt},r.a.createElement(_.a.TextArea,{autoSize:{minRows:1,maxRows:3},rows:1,onChange:function(e){return p(e.target.value)},value:m})),r.a.createElement(D.a.Item,null,r.a.createElement(j.a,{htmlType:"submit",onClick:function(){ot(c._id,s,l,m),p(""),e.onSend&&e.onSend()},icon:r.a.createElement(At.a,null),size:"large",type:"link"}),r.a.createElement(Je.a,{showUploadList:!1,customRequest:function(t){var a=t.file;o(!0),Re(a,800,void 0,function(t){o(!1),ot(c._id,s,l,m,t),e.onSend&&e.onSend()})}},r.a.createElement(j.a,{size:"large",type:"link",icon:i?r.a.createElement(Ct.a,null):r.a.createElement(St.a,null)}))))})):null}),ua=Object(f.g)(Object(u.b)(function(e){return{isAuthed:e.isAuthed,account:e.account,posts:e.post,progress:e.progress,friendData:e.friendData}},function(e){return{setData:function(t){e(de(t))},setPageTitle:function(t){return e(me(t))}}})(function(e){var t=Object(n.useState)({}),a=Object(g.a)(t,2),i=a[0],o=a[1],s=Object(n.useState)({}),c=Object(g.a)(s,2),l=c[0],u=c[1],d=e.history.location.pathname.split("/"),m=d.length>2?d[2]:"";if(!m)return null;Object(n.useEffect)(function(){e.isAuthed?e.setData({currentProgress:m}):bt(e,0,u,0,function(t){var a={},n=!0,r=!1,i=void 0;try{for(var o,s=t.friendData[Symbol.iterator]();!(n=(o=s.next()).done);n=!0){var c=o.value;a[c._id]=c}}catch(h){r=!0,i=h}finally{try{n||null==s.return||s.return()}finally{if(r)throw i}}var l={},u=!0,d=!1,m=void 0;try{for(var p,f=t.post[Symbol.iterator]();!(u=(p=f.next()).done);u=!0){var g=p.value;l[g._id]=g}}catch(h){d=!0,m=h}finally{try{u||null==f.return||f.return()}finally{if(d)throw m}}e.setData({friendData:a,posts:l,account:{},progress:t.progress})})},[e.isAuthed,e.history.location.pathname]);var p=e.isAuthed?e:Object(Ae.a)({},l,{account:{}}),f=p.progress,h=p.account,y=p.friendData,E=p.posts;if(!f||!f._id)return null;e.setData({currentPosts:f.posts});var v=f.goal;return v&&e.setPageTitle({main:v.name,sub:f.worker}),v&&y?r.a.createElement(r.a.Fragment,null,r.a.createElement(Ut.a,null,r.a.createElement(Ut.a.TabPane,{tab:"Posts",key:"posts"},h&&r.a.createElement(la,{parent:m,account:h,parentType:"progress"}),f.posts.map(function(e){if(E[e]){var t=E[e];return r.a.createElement(ut.a,null,r.a.createElement(Bt,{friendData:y,account:h,post:t}))}return null})),r.a.createElement(Ut.a.TabPane,{tab:"Details",key:"details"},r.a.createElement(ca,{state:i,setState:o,progress:f,account:h}))),r.a.createElement(b.a,{visible:i.previewImage,footer:null,onCancel:function(){return o(Object(Ae.a)({},i,{previewImage:""}))}},r.a.createElement("img",{alt:"example",style:{width:"100%"},src:i.previewImage}))):null})),da=a(349),ma=a.n(da),pa=Object(f.g)(Object(u.b)(function(e){return{account:e.account,isAuthed:e.isAuthed}})(function(e){var t=e.pulledProfile||e.account;return t.wallet?t.wallet.map(function(t,a){return r.a.createElement("div",{onClick:function(){return e.history.push("/profile/"+t.user)},style:{display:"inline-block",margin:"4px 8px"}},r.a.createElement(ut.a,{key:a,type:"inner",style:{width:200},cover:r.a.createElement("span",{style:{padding:"25px"}},r.a.createElement(C.a,{src:Z(t.user),size:150})),extra:r.a.createElement(j.a,{key:"1",icon:r.a.createElement(ma.a,null)},"Go to the shop")},r.a.createElement(Nt,{id:t.user}),t.amount))}):null})),fa=a(359),ga=Object(u.b)(function(e){return{account:e.account,aTransactionData:e.aTransactionData,friendData:e.friendData}},function(e){return{setPageTitle:function(t){return e(me(t))}}})(function(e){e.setPageTitle({main:"Shop",sub:"Transactions"});var t=e.account,a=e.aTransactionData,n=e.friendData;if(!t||!t._id)return null;var i=t.transactions.filter(function(e){return a[e]}).map(function(e){return a[e]}),o=[{title:"Type",dataIndex:"types",key:"types",render:function(e){return r.a.createElement(r.a.Fragment,null,e.map(function(e){var t=e.length>5?"geekblue":"green";return"loser"===e&&(t="volcano"),r.a.createElement(fa.a,{color:t,key:e},e.toUpperCase())}))}},{title:"With",dataIndex:"user",key:"user",render:function(t){var a=n[t];return a?r.a.createElement(j.a,{type:"link",style:{padding:0},onClick:function(){return e.history.push("/profile/"+t)}},r.a.createElement(C.a,{src:Z(t,a.image),style:{marginRight:"5px"}}),a.name+" ("+a._id+")"):t}},{title:"Item",dataIndex:"perk",key:"perk",render:function(e){return e.simple||r.a.createElement($t,{rewardKey:1,label:"Rewards",rewards:[{rewards:[e],key:1}],readOnly:!0})}},{title:"Amount",dataIndex:"amount",key:"amount",render:function(e){return e>0?e:""}},{title:"Date",dataIndex:"date",key:"date",render:function(e){return r.a.createElement(wt.a,{datetime:e,live:!0})}},{title:"Progress",dataIndex:"progress",key:"progress",render:function(t){return r.a.createElement(j.a,{type:"link",onClick:function(){return e.history.push("/progresses/"+t)}},t)}},{title:"Status",key:"status",dataIndex:"status",render:function(e,a){return"Not confirmed"===e?r.a.createElement(r.a.Fragment,null,r.a.createElement(j.a,{danger:!0,type:"link",onClick:function(){return wsActions.cancelTransaction(t._id,a.transaction._id)}},"Cancel"),a.transaction.from===t._id&&r.a.createElement(j.a,{type:"link",onClick:function(){return wsActions.confirmTransaction(t._id,a.transaction._id)}},"Confirm")):e}}],s=[],c=Object(be.a)(i);c=c.sort(function(e,t){return new Date(e.date).getTime()<new Date(t.date).getTime()?1:-1});var l=!0,u=!1,d=void 0;try{for(var m,p=c[Symbol.iterator]();!(l=(m=p.next()).done);l=!0){var f=m.value,g=[];f.from===t._id&&f.to===t.id&&g.push("internal"),f.to===t._id?f.progress?(g.push("earn"),f.amount?g.push("money"):g.push("item")):f.item&&f.amount?(g.push("buy"),g.push("item")):(g.push("recieve gift"),f.amount?g.push("money"):g.push("item")):f.from===t._id&&(f.progress?(g.push("pay"),f.amount?g.push("money"):g.push("item")):f.item&&f.amount?(g.push("sell"),g.push("item")):(g.push("send gift"),f.amount?g.push("money"):g.push("item")));var h=f.to!==t._id?f.to:f.from;s.push({key:s.length,types:g,user:h,perk:f.item,amount:f.amount,date:f.date,progress:f.progress,status:f.status,transaction:f})}}catch(y){u=!0,d=y}finally{try{l||null==p.return||p.return()}finally{if(u)throw d}}return r.a.createElement(ut.a,null,r.a.createElement(na.a,{columns:o,dataSource:s,scroll:{x:!0}}))}),ha=Object(u.b)(function(e){return{account:e.account}},function(e){return{setPageTitle:function(t){return e(me(t))}}})(function(e){return Object(n.useEffect)(function(){e.setPageTitle({main:"Shop",sub:"My items"})},[]),e.account._id?r.a.createElement(Ut.a,{style:{background:"transparent",boxShadow:"none",margin:"0",marginTop:"-15px"}},r.a.createElement(Ut.a.TabPane,{tab:"My shop",key:1},r.a.createElement(Et,{mode:"shop",listKey:"perks",account:e.account})),r.a.createElement(Ut.a.TabPane,{tab:"Wallet",key:3},r.a.createElement(pa,null)),r.a.createElement(Ut.a.TabPane,{tab:"Transactions",key:4},r.a.createElement(ga,null))):r.a.createElement("span",null)}),ya=a(179),Ea=a.n(ya),va=Object(f.g)(Object(u.b)(function(e){return{isAuthed:e.isAuthed,account:e.account,statePosts:e.post,progress:e.progress,friendData:e.friendData,progressData:e.progressData,groupData:e.groupData,currentPosts:e.currentPosts}},function(e){return{setData:function(t){e(de(t))},setPageTitle:function(t){return e(me(t))}}})(function(e){var t=e.account,a=e.friendData,i=e.statePosts,o=e.progressData,s=e.groupData,c=e.currentPosts,l=Object(n.useState)([]),u=Object(g.a)(l,2),d=u[0],m=u[1],p=Object(n.useState)((new Date).getTime()),f=Object(g.a)(p,1)[0],h=function(e,t){return 0===e.notifications.length&&t.notifications.length>0?1:e.notifications.length>0&&0===t.notifications.length?-1:0===e.notifications.length&&0===t.notifications.length?0:new Date(e.notifications[0].date).getTime()<new Date(t.notifications[0].date).getTime()?1:-1};if(Object(n.useEffect)(function(){if(c){var e=c.filter(function(e){return i[e]}).map(function(e){return i[e]}),t=[],a=[],n=Object(be.a)(d),r=!0,o=!1,s=void 0;try{for(var l,u=function(){var e=l.value,r=n.findIndex(function(t){return t._id.toString()===e._id.toString()});-1===r?e.notifications&&e.notifications.length>0&&new Date(e.notifications[0].date).getTime()>f?t.push(e):a.push(e):n[r]=e},p=e[Symbol.iterator]();!(r=(l=p.next()).done);r=!0)u()}catch(b){o=!0,s=b}finally{try{r||null==p.return||p.return()}finally{if(o)throw s}}for(var g=function(){var e=E[y],t=n.findIndex(function(t){return!!(t&&t.notifications&&t.notifications.length>0)&&new Date(t.notifications[0]).getTime()>new Date(e.notifications[0]).getTime()});-1===t?n.push(e):n.splice(t,0,e)},y=0,E=a;y<E.length;y++)g();var v=[].concat(t,Object(be.a)(n));0===d.length&&(v=v.sort(h)),m(v)}},[c,i]),!t._id)return null;var y=[],E=!0,v=!1,b=void 0;try{for(var k,w=t.progresses[Symbol.iterator]();!(E=(k=w.next()).done);E=!0){var O=k.value;o[O]&&(y=[].concat(Object(be.a)(y),Object(be.a)(o[O].notifications.filter(function(e){return"add post"===e.code}))))}}catch(T){v=!0,b=T}finally{try{E||null==w.return||w.return()}finally{if(v)throw b}}var D=!0,_=!1,j=void 0;try{for(var I,S=t.groups[Symbol.iterator]();!(D=(I=S.next()).done);D=!0){var x=I.value;s[x]&&(y=[].concat(Object(be.a)(y),Object(be.a)(s[x].notifications.filter(function(e){return"add post"===e.code}))))}}catch(T){_=!0,j=T}finally{try{D||null==S.return||S.return()}finally{if(_)throw j}}y=y.sort(h).map(function(e){return e.details.postId}).slice(0,10);var C=Object(be.a)(new Set([].concat(Object(be.a)(t.followPosts),Object(be.a)(t.myPosts),Object(be.a)(d.map(function(e){return e._id})),Object(be.a)(y))));return Ea()(c,C)||e.setData({currentPosts:C}),e.setPageTitle({main:"Dashboard",sub:""}),d.map(function(e){var n=null,i=e.notifications.length>0?e.notifications[0]:null;if(i)switch(i.code){case"edit wishlist item":n="edited item in wishlist.";break;case"edit goal":n="edited goal.";break;case"edit perk":n="edited item in shop.";break;case"comment":n="added a comment.";break;case"edit comment":n="edited a comment.";break;case"like":n="added a like.";break;case"dislike":n="removed a like.";break;default:n=null}return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:{height:"5px",background:"#ddd",width:"calc(100% + 8px)",position:"absolute",left:"-8px"}}),r.a.createElement("div",{style:{marginTop:"10px"}},n&&r.a.createElement(r.a.Fragment,null,r.a.createElement("span",null,r.a.createElement(Nt,{id:i.user,noAva:!0,span:!0,style:{fontWeight:"bold"}})," ",n),r.a.createElement(Lt.a,{type:"horizontal",style:{margin:"5px 0"}})),r.a.createElement(Bt,{friendData:a,account:t,post:e,progressData:o,groupData:s})))})})),ba=Object(f.g)(Object(u.b)(function(e){return{lastNotifications:e.lastNotifications}})(function(e){var t=e.lastNotifications,a=function(e){return e.details.reward.money?"$"+e.details.reward.money:e.details.reward.simple||e.details.reward.itemName};return t.map(function(t){var n=null;switch(t.code){case"change name":n=r.a.createElement("span",null," ",r.a.createElement(Nt,{id:t.user})," changed name.");break;case"delete account":n=r.a.createElement("span",null,t.user,"deleted account.");break;case"friend request":n=r.a.createElement("span",null,r.a.createElement(Nt,{id:t.user})," wants to become friends with you.");break;case"friend add":n=r.a.createElement("span",null,r.a.createElement(Nt,{id:t.user})," and"," ",r.a.createElement(Nt,{id:t.details.friend})," became friends.");break;case"unfriend":n=r.a.createElement("span",null,r.a.createElement(Nt,{id:t.user})," and"," ",r.a.createElement(Nt,{id:t.details.friend})," stopped being friends.");break;case"add wishlist item":case"edit wishlist item":n=r.a.createElement("span",null,r.a.createElement(Nt,{id:t.user})," ","add wishlist item"===t.code?"added to wishlist a new item":"edited in wishlist"," ",r.a.createElement(j.a,{type:"link",onClick:function(){return e.history.push("/wishlist/".concat(t.user,"/").concat(t.details.itemId))}},t.details.itemName)," ",".");break;case"delete wishlist item":n=r.a.createElement("span",null,r.a.createElement(Nt,{id:t.user})," deleted"," ",t.details.itemName," from wishlist.");break;case"add goal":case"edit goal":n=r.a.createElement("span",null,r.a.createElement(Nt,{id:t.user})," ","add goal"===t.code?"added a new goal":"edited goal"," ",r.a.createElement(j.a,{type:"link",onClick:function(){return e.history.push("/goals/".concat(t.user,"/").concat(t.details.itemId))}},t.details.itemName)," ",".");break;case"delete goal":n=r.a.createElement("span",null,r.a.createElement(Nt,{id:t.user})," deleted"," ",t.details.itemName," from goals.");break;case"add perk":case"edit perk":n=r.a.createElement("span",null,r.a.createElement(Nt,{id:t.user})," ","add perk"===t.code?"added to shop a new item":"edited in shop"," ",r.a.createElement(j.a,{type:"link",onClick:function(){return e.history.push("/shop/".concat(t.user,"/").concat(t.details.itemId))}},t.details.itemName)," ",".");break;case"delete perk":n=r.a.createElement("span",null,r.a.createElement(Nt,{id:t.user})," deleted"," ",t.details.itemName," from shop.");break;case"buy perk":n=r.a.createElement("span",null,r.a.createElement(Nt,{id:t.user})," bought",r.a.createElement(j.a,{type:"link",onClick:function(){return e.history.push("/shop/".concat(t.user,"/").concat(t.details.itemId))}},t.details.itemName," ($",t.details.price,")")," ","from ",r.a.createElement(Nt,{id:t.details.owner})," .");break;case"cancel transaction":case"confirm transaction":n=r.a.createElement("span",null,r.a.createElement(Nt,{id:t.user})," ","cancel transaction"===t.code?"cancelled":"confirmed","purchase of",r.a.createElement(j.a,{type:"link",onClick:function(){return e.history.push("/shop/".concat(t.user,"/").concat(t.details.itemId))}},t.details.itemName," ($",t.details.price,")")," ","by ",r.a.createElement(Nt,{id:t.details.buyer})," .");break;case"start progress":n=r.a.createElement("span",null,r.a.createElement(Nt,{id:t.user})," started participating in progress",r.a.createElement(j.a,{type:"link",onClick:function(){return e.history.push("/progresses/".concat(t.details.itemId))}},t.details.itemName)," ","as ",t.details.as,".");break;case"approve milestone":n=r.a.createElement("span",null,r.a.createElement(Nt,{id:t.user})," approved milestone"," ",t.details.itemName," in",r.a.createElement(j.a,{type:"link",onClick:function(){return e.history.push("/progresses/".concat(t.details.progressId))}},t.details.progressName),".");break;case"disapprove milestone":n=r.a.createElement("span",null,r.a.createElement(Nt,{id:t.user})," disapproved milestone"," ",t.details.itemName," in",r.a.createElement(j.a,{type:"link",onClick:function(){return e.history.push("/progresses/".concat(t.details.progressId))}},t.details.progressName),".");break;case"finish progress":n=r.a.createElement("span",null,"Progress"," ",r.a.createElement(j.a,{type:"link",onClick:function(){return e.history.push("/progresses/".concat(t.details.progressId))}},t.details.progressName),"was approved and finished.");break;case"milestone finish":n=r.a.createElement("span",null,"Milestone ",t.details.itemName," in progress"," ",r.a.createElement(j.a,{type:"link",onClick:function(){return e.history.push("/progresses/".concat(t.details.progressId))}},t.details.progressName),"was approved and finished.");break;case"get reward":n=r.a.createElement("span",null,r.a.createElement(Nt,{id:t.user})," recieved"," ",a(t)," as a reward from"," ",r.a.createElement(Nt,{id:t.details.from})," in progress",r.a.createElement(j.a,{type:"link",onClick:function(){return e.history.push("/progresses/".concat(t.details.progressId))}},t.details.progressName),".");break;case"leave progress":n=r.a.createElement("span",null,r.a.createElement(Nt,{id:t.user})," left progress"," ",r.a.createElement(j.a,{type:"link",onClick:function(){return e.history.push("/progresses/".concat(t.details.progressId))}},t.details.progressName),".");break;case"edit progress":n=r.a.createElement("span",null,r.a.createElement(Nt,{id:t.user})," edited progress"," ",r.a.createElement(j.a,{type:"link",onClick:function(){return e.history.push("/progresses/".concat(t.details.progressId))}},t.details.progressName),t.details.addedAccounts.length>0?r.a.createElement(r.a.Fragment,null," ","and added"," ",t.details.addedAccounts.map(function(e){return r.a.createElement(Nt,{id:e})})," "):"",t.details.droppedAccounts.length>0?r.a.createElement(r.a.Fragment,null," ","and removed"," ",t.details.droppedAccounts.map(function(e){return r.a.createElement(Nt,{id:e})})," "):"",".");break;case"remove from progress":n=r.a.createElement("span",null,r.a.createElement(Nt,{id:t.user})," removed"," ",r.a.createElement(Nt,{id:t.details.account})," from progress",r.a.createElement(j.a,{type:"link",onClick:function(){return e.history.push("/progresses/".concat(t.details.progressId))}},t.details.progressName),".");break;case"remove from progress":n=r.a.createElement("span",null,r.a.createElement(Nt,{id:t.user})," added"," ",r.a.createElement(Nt,{id:t.details.account})," to progress",r.a.createElement(j.a,{type:"link",onClick:function(){return e.history.push("/progresses/".concat(t.details.progressId))}},t.details.progressName),".");break;case"add reward":n=r.a.createElement("span",null,r.a.createElement(Nt,{id:t.user})," added"," ",a(t)," as a reward for asdasdasd",t.details.for&&0!==t.details.for.length?t.details.for.map(function(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement(Nt,{id:e}),",")}):"all ","in progress",r.a.createElement(j.a,{type:"link",onClick:function(){return e.history.push("/progresses/".concat(t.details.progressId))}},t.details.progressName),".");break;case"delete reward":n=r.a.createElement("span",null,r.a.createElement(Nt,{id:t.user})," removed"," ",a(t)," as a reward for"," ",t.details.for&&0!==t.details.for.length?t.details.for.map(function(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement(Nt,{id:e}),",")}):"all ","in progress",r.a.createElement(j.a,{type:"link",onClick:function(){return e.history.push("/progresses/".concat(t.details.progressId))}},t.details.progressName),".");break;default:n="New event"}return r.a.createElement(ut.a,null,n)})})),ka=Object(u.b)(function(e){return{account:e.account,lastNotifications:e.lastNotifications}},function(e){return{setPageTitle:function(t){return e(me(t))}}})(function(e){var t=e.account,a=e.lastNotifications;return t._id?(e.setPageTitle({main:"Dashboard",sub:""}),r.a.createElement(Ut.a,{onChange:function(e){var n,r;"events"===e&&a.length>0&&parseInt(t.lastSeenNot)!==parseInt(a[0].notId)&&(n=t._id,r=parseInt(a[0].notId),De&&1===De.readyState&&De.send(JSON.stringify({messageCode:"setLastSeenNot",accountId:n,notId:r})))}},r.a.createElement(Ut.a.TabPane,{tab:"Posts",key:"psts"},r.a.createElement(va,null)),r.a.createElement(Ut.a.TabPane,{tab:"Events",key:"events"},r.a.createElement(ba,null)))):null}),wa=a(788),Oa=function(e){var t=e.invitingFriends,a=e.invitedFriends,n=e.realFriends,i=e._id,o=e.accountId;if(!o)return[];if(o===i)return[e.additionalButton];var s=r.a.createElement(x.a,{onClick:function(e){return e.domEvent.stopPropagation()}},e.additionalButtons&&e.additionalButtons.map(function(e,t){return r.a.createElement(x.a.Item,{key:t+100,onClick:e.onClick},e.title)}),t.find(function(e){return e.friend===i})?r.a.createElement(x.a.Item,{key:"2",onClick:function(){return ct(o,i)},danger:!0},"Decline"):a.find(function(e){return e.friend===i})?r.a.createElement(x.a.Item,{key:"3",onClick:function(){return ct(o,i)},danger:!0},"Cancel invitation"):n.find(function(e){return e.friend===i})?r.a.createElement(x.a.Item,{key:"4",onClick:function(){return ct(o,i)},danger:!0},"Unfriend"):r.a.createElement(x.a.Item,{key:"5",onClick:function(){return function(e,t){De&&1===De.readyState&&De.send(JSON.stringify({messageCode:"addFriend",accountId:e,friendId:t}))}(o,i)},danger:!0},"Become friends"));return t.find(function(e){return e.friend===i})?r.a.createElement(pt.a.Button,{type:"primary",overlay:s,trigger:["click"],onClick:function(e){e.preventDefault(),e.stopPropagation(),function(e,t){De&&1===De.readyState&&De.send(JSON.stringify({messageCode:"acceptFriend",accountId:e,friendId:t}))}(o,i)}},"Accept"):r.a.createElement(pt.a,{overlay:s,trigger:["click"]},r.a.createElement("a",{onClick:function(e){e.preventDefault(),e.stopPropagation()}},r.a.createElement(j.a,{type:"link"},e.asText?r.a.createElement(r.a.Fragment,null,"Actions ",r.a.createElement(wa.a,null)):r.a.createElement(ft.a,null))))},Da=Object(f.g)(Object(u.b)(function(e){return{account:e.account,isAuthed:e.isAuthed}},function(e){return{setData:function(t,a){return e(de(t))},tryAuth:function(t,a){return e(ce(t,a))}}})(function(e){var t=Oa({accountId:e.account?e.account._id:"",realFriends:e.realFriends,invitedFriends:e.invitedFriends,invitingFriends:e.invitingFriends,_id:e.friend._id,asIcons:!0,additionalButtons:[{title:"See profile",onClick:function(){return e.history.push("/profile/"+e.friend._id)}}]});return r.a.createElement(ut.a,{type:"inner",style:{width:"100%"},bordered:!1,extra:t,title:r.a.createElement(Nt,{id:e.friend._id,size:50})})})),_a=Object(u.b)(function(e){return{searchResult:e.friendSearchResult}},function(e){return{setFriendSearchResult:function(t){return e(pe(t))}}})(function(e){Object(n.useEffect)(function(){e.setFriendSearchResult(null)},[e.addFriendOpen]);var t=e.addFriendOpen,a=e.setAddFriendOpen,i=e.searchResult,o=e.realFriends,s=e.invitedFriends,c=e.invitingFriends;return r.a.createElement(b.a,{title:"Add friend",visible:t,maskClosable:!0,closable:!0,onCancel:function(){return a(!1)},footer:r.a.createElement(j.a,{key:"back",onClick:function(){return a(!1)}},"Return"),destroyOnClose:!0},r.a.createElement("p",null,"To find a friend you need to enter your friend's nickname."),r.a.createElement(D.a,Object.assign({name:"dynamic_form_nest_item",onFinish:function(e){return t=e.search,void(De&&1===De.readyState&&De.send(JSON.stringify({messageCode:"searchFriends",search:t})));var t},autoComplete:"off"},{labelCol:{span:8},wrapperCol:{span:16}}),r.a.createElement(D.a.Item,{label:"Search",name:"search",rules:Ye},r.a.createElement(_.a,{placeholder:"Must be more than 2 characters long"})),r.a.createElement(D.a.Item,{wrapperCol:{offset:8,span:16}},r.a.createElement(j.a,{type:"primary",htmlType:"submit",size:"large"},"Search"))),i&&r.a.createElement(ut.a,{title:"Search result"},r.a.createElement(Da,Object.assign({},e,{friend:i,realFriends:o,invitingFriends:c,invitedFriends:s}))))}),ja=Object(f.g)(function(e){var t=e.realFriends,a=e.invitedFriends,n=e.invitingFriends;return r.a.createElement(r.a.Fragment,null,n.length>0&&r.a.createElement(r.a.Fragment,null,r.a.createElement("h2",null,"People invited me to be friends"),n.map(function(i){return r.a.createElement(Da,Object.assign({key:i._id},e,{friend:i,realFriends:t,invitingFriends:n,invitedFriends:a}))})),a.length>0&&r.a.createElement(r.a.Fragment,null,r.a.createElement("h2",null,"I invited these people"),a.map(function(i){return r.a.createElement(Da,Object.assign({key:i._id},e,{friend:i,realFriends:t,invitingFriends:n,invitedFriends:a}))})))}),Ia=Object(f.g)(Object(u.b)(function(e){return{account:e.account,friendData:e.friendData}},function(e){return{setPageTitle:function(t){return e(me(t))}}})(function(e){var t=Object(n.useState)(),a=Object(g.a)(t,2),i=a[0],o=a[1];Object(n.useEffect)(function(){e.setPageTitle({main:"Friends",sub:""})},[]);var s=e.account,c=e.friendData;if(!s._id)return null;var l=[],u=[],d=[];if(s.friends){var m=!0,p=!1,f=void 0;try{for(var h,y=s.friends[Symbol.iterator]();!(m=(h=y.next()).done);m=!0){var E=h.value,v=Object(Ae.a)({},c[E.friend],E);v&&("friend"===v.status?l.push(v):"invited"===v.status?u.push(v):"inviting"===v.status&&d.push(v))}}catch(k){p=!0,f=k}finally{try{m||null==y.return||y.return()}finally{if(p)throw f}}}var b=l.length>0?l.map(function(t){return r.a.createElement(Da,Object.assign({key:t._id},e,{friend:t,realFriends:l,invitingFriends:d,invitedFriends:u}))}):r.a.createElement(Vt.a,{image:"https://websiter.s3.us-east-2.amazonaws.com/image+4.jpg",imageStyle:{height:"250px",marginTop:"50px"},description:!1});return r.a.createElement(r.a.Fragment,null,r.a.createElement(yt,{title:"Add friend",sub:"Find by nickname",action:function(){return o(!0)}}),u.length>0||d.length>0?r.a.createElement(Ut.a,null,r.a.createElement(Ut.a.TabPane,{key:"confirmed",tab:"Confrmed"},b),r.a.createElement(Ut.a.TabPane,{tab:r.a.createElement(A.a,{count:d.length,offset:[10,0]},"Pending"),key:"pending"},r.a.createElement(ja,{realFriends:l,invitedFriends:u,invitingFriends:d}))):b,r.a.createElement(_a,{addFriendOpen:i,setAddFriendOpen:o,realFriends:l,invitedFriends:u,invitingFriends:d,account:s}))})),Sa=a(350),xa=Object(f.g)(Object(u.b)(function(e){return{account:e.account}},function(e){return{setPageTitle:function(t){return e(me(t))},increaseAvatarV:function(){return e({type:"INCREASE_AVATAR_V"})}}})(function(e){var t=Object(n.useState)(),a=Object(g.a)(t,2),i=a[0],o=a[1],s=Object(n.useState)(""),c=Object(g.a)(s,2),l=c[0],u=c[1],d=e.account;Object(n.useEffect)(function(){e.setPageTitle({main:"Account",sub:""})},[]);return d&&d.name?r.a.createElement(ut.a,null,r.a.createElement(Je.a,{name:"avatar",listType:"picture-card",className:Sa.Avatar,showUploadList:!1,customRequest:function(t){var a=t.file;Re(a,800,"avatar",function(){e.increaseAvatarV()})}},d.image?r.a.createElement(C.a,{src:Z(d._id,d.image),size:150,style:{margin:"25px"}}):r.a.createElement("div",null,r.a.createElement(qe.a,null),r.a.createElement("div",{className:"ant-upload-text"},"Upload"))),r.a.createElement(D.a,Object.assign({name:"dynamic_form_nest_item",onFinish:function(e){return function(e,t){De&&1===De.readyState&&De.send(JSON.stringify({messageCode:"editAccount",name:e.name,accountId:t}))}(e,d._id)},autoComplete:"off"},{labelCol:{span:8},wrapperCol:{span:16}},{initialValues:{name:d.name,nickname:d._id}}),r.a.createElement(D.a.Item,{label:"Name",name:"name",rules:Xe},r.a.createElement(_.a,{placeholder:"Must be more than 1 character long"})),r.a.createElement(D.a.Item,{label:"Nickname",name:"nickname"},r.a.createElement(_.a,{disabled:!0})),r.a.createElement(D.a.Item,Object.assign({},{wrapperCol:{offset:8,span:0}},{style:{flex:"none",maxWidth:" 100%",overflow:"hidden"}}),r.a.createElement(pt.a.Button,{type:"primary",htmlType:"submit",size:"large",overlay:r.a.createElement(x.a,null,r.a.createElement(x.a.Item,{danger:!0,onClick:function(){return o(!0)}},"Delete account"))},"Save"))),r.a.createElement(b.a,{title:"Delete account",visible:i,onOk:function(){var e;l!==d._id?ie.b.warning("The nickmanme is not correct."):(e=d._id,De&&1===De.readyState&&De.send(JSON.stringify({messageCode:"deleteAccount",accountId:e})))},onCancel:function(){o(!1),u("")}},r.a.createElement("p",null,"Please enter your nickname and press Ok to delete your account."),r.a.createElement(_.a,{onChange:function(e){return u(e.target.value)}}))):null})),Ca=Object(f.g)(Object(u.b)(function(e){return{account:e.account,profile:e.profile,isAuthed:e.isAuthed,friendData:e.friendData}},function(e){return{setData:function(t){return e(de(t))},setPageTitle:function(t){return e(me(t))},tryAuth:function(t,a){return e(ce(t,a))}}})(function(e){var t=Object(n.useState)({}),a=Object(g.a)(t,2),i=a[0],o=a[1];Object(n.useEffect)(function(){var t=e.history.location.pathname.split("/");if(t.length>2){var a=t[2];e.isAuthed?e.setData({currentProfile:a}):bt(e,0,o,0,function(t){var a={},n=!0,r=!1,i=void 0;try{for(var o,s=t.friendData[Symbol.iterator]();!(n=(o=s.next()).done);n=!0){var c=o.value;a[c._id]=c}}catch(O){r=!0,i=O}finally{try{n||null==s.return||s.return()}finally{if(r)throw i}}var l={},u=!0,d=!1,m=void 0;try{for(var p,f=t.progressData[Symbol.iterator]();!(u=(p=f.next()).done);u=!0){var g=p.value;l[g._id]=g}}catch(O){d=!0,m=O}finally{try{u||null==f.return||f.return()}finally{if(d)throw m}}var h={},y=!0,E=!1,v=void 0;try{for(var b,k=t.groupData[Symbol.iterator]();!(y=(b=k.next()).done);y=!0){var w=b.value;h[w._id]=w}}catch(O){E=!0,v=O}finally{try{y||null==k.return||k.return()}finally{if(E)throw v}}e.setData({profile:t.profile,friendData:a,progressData:l,groupData:h,account:{}})})}},[e.isAuthed,e.history.location.pathname]);var s=e.isAuthed?e:i,c=s.profile,l=s.friendData,u=s.account;if(!c||!c._id)return null;var d=[],m=[],p=[];if(c&&c.friends&&u&&u._id){var f=!0,h=!1,y=void 0;try{for(var E,v=u.friends[Symbol.iterator]();!(f=(E=v.next()).done);f=!0){var b=E.value;"friend"===b.status?d.push(b):"invited"===b.status?m.push(b):"inviting"===b.status&&p.push(b)}}catch(w){h=!0,y=w}finally{try{f||null==v.return||v.return()}finally{if(h)throw y}}}var k=Oa({accountId:u?u._id:"",realFriends:d,invitedFriends:m,invitingFriends:p,_id:c._id,additionalButton:null,asText:!0});return r.a.createElement(ut.a,null,r.a.createElement("div",{style:{textAlign:"center",marginBottom:"50px"}},r.a.createElement(C.a,{src:Z(c._is,c.image),size:200}),r.a.createElement("h1",null,c.name),r.a.createElement("h3",null,"(",c._id,")"),k),r.a.createElement(Ut.a,null,r.a.createElement(Ut.a.TabPane,{tab:"Progresses",key:2},r.a.createElement(aa,{fromProfile:!0})),r.a.createElement(Ut.a.TabPane,{tab:"Friends",key:1},c.friends.filter(function(e){return"friend"===e.status}).map(function(t){var a=Object(Ae.a)({},l[t.friend],t.friend);return r.a.createElement(Da,Object.assign({key:a._id},e,{account:u,friend:a,realFriends:d,invitingFriends:p,invitedFriends:m}))})),r.a.createElement(Ut.a.TabPane,{tab:"Goals",key:3},c.goals.map(function(e,t){return r.a.createElement(gt,{key:t,perk:e,perkId:e.itemId,owner:c,account:u||{},setEditedPerk:function(){},setEditPerkOpen:function(){},onlyBuy:!0,mode:"goals"})})),r.a.createElement(Ut.a.TabPane,{tab:"Shop",key:4},c.perks&&c.perks.map(function(e,t){return r.a.createElement(gt,{key:t,perk:e,perkId:e.perkId,owner:c,account:u||{},onlyBuy:!0,mode:"shop"})})),r.a.createElement(Ut.a.TabPane,{tab:"Wallet",key:5},r.a.createElement(pa,{pulledProfile:c,account:c})),r.a.createElement(Ut.a.TabPane,{tab:"Wishlist",key:6},c.wishlist.map(function(e,t){return r.a.createElement(gt,{key:t,perk:e,perkId:e.itemId,owner:c,account:u||{},setEditedPerk:function(){},setEditPerkOpen:function(){},onlyBuy:!0,mode:"wishlist"})}))))})),Ta=a(356),Aa=Object(f.g)(Object(u.b)(function(e){return{isAuthed:e.isAuthed,user:e.user,account:e.account}},function(e){return{setPageTitle:function(t){return e(me(t))},setAccountActivated:function(t){return e(function(e){return{type:"SET_ACCOUNT_ACTIVATED",value:e}}(t))}}})(function(e){e.isAuthed||e.history.push("/logout");return r.a.createElement(r.a.Fragment,null,r.a.createElement(Ta.a,{className:"site-page-header",title:"Activate your account",backIcon:!1}),r.a.createElement(D.a,Object.assign({name:"dynamic_form_nest_item",onFinish:function(t){l.a.post("/api/activate-account",Object(Ae.a)({},t)).then(function(t){t.data.success?(ie.b.success("Your account has been activated!"),e.setAccountActivated(!1),e.history.push("/account")):(t.data.nicknameNotUnique&&ie.b.warning("The nickname is taken. Choose another nickname please."),t.data.errorCode&&ie.b.error("Something is wrong with the data. Please try one more time with new data."))}).catch(function(e){})},autoComplete:"off"},{labelCol:{span:8},wrapperCol:{span:16}}),r.a.createElement(D.a.Item,{label:"Name",name:"name",rules:Xe},r.a.createElement(_.a,{placeholder:"Must be more than 1 character long"})),r.a.createElement(D.a.Item,{label:"Nickname",name:"nickname",rules:Ye},r.a.createElement(_.a,{placeholder:"Must be more than 1 character long"})),r.a.createElement(D.a.Item,{wrapperCol:{offset:8,span:16}},r.a.createElement(j.a,{type:"primary",htmlType:"submit",size:"large"},"Save"))))})),Pa=Kt.a.Item,Na=Object(f.g)(Object(u.b)(function(e){return{isAuthed:e.isAuthed,account:e.account,post:e.post,friendData:e.friendData}},function(e){return{setData:function(t){e(de(t))},setPageTitle:function(t){return e(me(t))}}})(function(e){var t=Object(n.useState)({}),a=Object(g.a)(t,2),i=a[0],o=a[1],s=e.account;if(Object(n.useEffect)(function(){var t=e.history.location.pathname.split("/");if(t.length>3){var a=t[2];if(e.isAuthed&&s._id===a){var n=s.perks.find(function(e){return e.perkId===t[3]});o({profile:s,perk:n})}else bt(e,0,o,0,function(t){var a={},n=!0,r=!1,i=void 0;try{for(var o,s=t.friendData[Symbol.iterator]();!(n=(o=s.next()).done);n=!0){var c=o.value;a[c._id]=c}}catch(l){r=!0,i=l}finally{try{n||null==s.return||s.return()}finally{if(r)throw i}}e.setData({post:Object(fe.a)({},t.post._id,t.post),friendData:a})})}},[e.isAuthed]),!i.perk)return null;var c=i.perk,l=i.profile;e.setData({currentPosts:c.post}),c&&e.setPageTitle({main:c.name,sub:l._id});var u;return c?r.a.createElement(ut.a,{title:r.a.createElement("span",null,"Item from ",r.a.createElement(Nt,{id:l._id})," shop"),bordered:!1},r.a.createElement(mt,{images:c.images}),r.a.createElement("h1",null,c.name),r.a.createElement("p",{style:{whiteSpace:"pre-wrap"}},c.description),r.a.createElement(Kt.a,{title:"Goal description",bordered:!0,column:{xxl:4,xl:3,lg:3,md:3,sm:2,xs:1}},r.a.createElement(Pa,{label:"Available for"},(u=c.users,l&&e.friendData?u.map(function(e){return r.a.createElement(Nt,{id:e})}):u)),r.a.createElement(Pa,{label:"Price"},c.price)),r.a.createElement(Bt,{noStartMessage:!0,post:e.post[c.post],account:e.account,friendData:e.friendData,showReplies:!0})):null})),Fa=Object(f.g)(Object(u.b)(function(e){return{isAuthed:e.isAuthed,account:e.account,post:e.post,friendData:e.friendData}},function(e){return{setData:function(t){e(de(t))},setPageTitle:function(t){return e(me(t))}}})(function(e){var t=Object(n.useState)({}),a=Object(g.a)(t,2),i=a[0],o=a[1],s=e.account;if(Object(n.useEffect)(function(){var t=e.history.location.pathname.split("/");if(t.length>3){var a=t[2];if(e.isAuthed&&s._id===a){var n=s.wishlist.find(function(e){return e.itemId===t[3]});o({profile:s,wishlistItem:n})}else bt(e,0,o,0,function(t){var a={},n=!0,r=!1,i=void 0;try{for(var o,s=t.friendData[Symbol.iterator]();!(n=(o=s.next()).done);n=!0){var c=o.value;a[c._id]=c}}catch(l){r=!0,i=l}finally{try{n||null==s.return||s.return()}finally{if(r)throw i}}e.setData({post:Object(fe.a)({},t.post._id,t.post),friendData:a})})}},[e.isAuthed]),!i.wishlistItem)return null;var c=i.wishlistItem,l=i.profile;return e.setData({currentPosts:c.post}),c&&e.setPageTitle({main:c.name,sub:l._id}),c?r.a.createElement(ut.a,{title:r.a.createElement("span",null,r.a.createElement(Nt,{id:l._id})," wishlist"),bordered:!1},r.a.createElement(mt,{images:c.images}),r.a.createElement("h1",null,c.name),r.a.createElement("p",{style:{whiteSpace:"pre-wrap"}},c.description),r.a.createElement(Bt,{noStartMessage:!0,post:e.post[c.post],account:e.account,friendData:e.friendData,showReplies:!0})):null})),Ra=Object(f.g)(Object(u.b)(function(e){return{account:e.account}},function(e){return{setPageTitle:function(t){return e(me(t))}}})(function(e){return Object(n.useEffect)(function(){e.setPageTitle({main:"Wishlist",sub:""})},[]),r.a.createElement(r.a.Fragment,null,e.account._id?r.a.createElement(Et,{mode:"wishlist",account:e.account}):r.a.createElement("span",null))})),Ma=Object(f.g)(Object(u.b)(function(e){return{isAuthed:e.isAuthed,account:e.account,posts:e.post,group:e.group,friendData:e.friendData,progressData:e.progressData}},function(e){return{setData:function(t){e(de(t))},setPageTitle:function(t){return e(me(t))}}})(function(e){var t=Object(n.useState)({}),a=Object(g.a)(t,2),i=a[0],o=a[1],s=Object(n.useState)(!1),c=Object(g.a)(s,2),l=c[0],u=c[1],d=e.history.location.pathname.split("/")[2];Object(n.useEffect)(function(){e.setData({currentGroup:d})},[e.isAuthed]);var m=e.group,p=e.account,f=e.friendData,h=e.posts,y=e.progressData;if(!m._id)return null;e.setData({currentPosts:m.posts}),e.setPageTitle({main:m.name,sub:m.worker});var E=m.progresses.filter(function(e){return y[e]}).map(function(e){return y[e]}),v=r.a.createElement(b.a,{title:"Add goal",visible:l,maskClosable:!0,closable:!0,onCancel:function(){return u(!1)},width:"90%",footer:r.a.createElement(j.a,{key:"back",onClick:function(){return u(!1)}},"Close"),destroyOnClose:!0},r.a.createElement(Zt,{setStartProgressVisible:u,account:p,friendData:e.friendData,inGroup:m._id}));return f?r.a.createElement(r.a.Fragment,null,r.a.createElement(Ut.a,null,r.a.createElement(Ut.a.TabPane,{tab:"Posts",key:"posts"},r.a.createElement(la,{parent:d,account:p,parentType:"progress"}),m.posts.map(function(e){if(h[e]){var t=h[e];return r.a.createElement(ut.a,null,r.a.createElement(Bt,{friendData:f,account:p,post:t}))}return null})),r.a.createElement(Ut.a.TabPane,{tab:"Progresses",key:"progresses"},r.a.createElement(yt,{title:"Start a new progress",sub:"Rich your goals or help others!",action:function(){u(!0)}}),E.map(function(e,t){return r.a.createElement(Gt,{key:t,progress:e})}),v)),r.a.createElement(b.a,{visible:i.previewImage,footer:null,onCancel:function(){return o(Object(Ae.a)({},i,{previewImage:""}))}},r.a.createElement("img",{alt:"example",style:{width:"100%"},src:i.previewImage}))):null})),La=Object(f.g)(Object(u.b)(function(e){return{isAuthed:e.isAuthed,account:e.account,statePosts:e.post,progress:e.progress,friendData:e.friendData,progressData:e.progressData,groupData:e.groupData,lastNotifications:e.lastNotifications}},function(e){return{setData:function(t){e(de(t))},setPageTitle:function(t){return e(me(t))}}})(function(e){var t=e.account,a=e.friendData,n=e.progressData,i=e.groupData;if(!t._id)return null;var o=[],s=!0,c=!1,l=void 0;try{for(var u,d=t.progresses[Symbol.iterator]();!(s=(u=d.next()).done);s=!0){var m=u.value;n[m]&&(o=[].concat(Object(be.a)(o),Object(be.a)(n[m].notifications)))}}catch(j){c=!0,l=j}finally{try{s||null==d.return||d.return()}finally{if(c)throw l}}var p=!0,f=!1,g=void 0;try{for(var h,y=t.groups[Symbol.iterator]();!(p=(h=y.next()).done);p=!0){var E=h.value;i[E]&&(o=[].concat(Object(be.a)(o),Object(be.a)(i[E].notifications)))}}catch(j){f=!0,g=j}finally{try{p||null==y.return||y.return()}finally{if(f)throw g}}var v=!0,b=!1,k=void 0;try{for(var w,O=t.friends[Symbol.iterator]();!(v=(w=O.next()).done);v=!0){var D=w.value;a[D.friend]&&"friend"===D.status&&(o=[].concat(Object(be.a)(o),Object(be.a)(a[D.friend].notifications)))}}catch(j){b=!0,k=j}finally{try{v||null==O.return||O.return()}finally{if(b)throw k}}var _=function(e,t,a,n){return e.find(function(e){return e.notId===t.notId})||e.push(t),e};return o=(o=o.reduce(_,[])).sort(function(e,t){return new Date(e.date).getTime()<new Date(t.date).getTime()?1:-1}).slice(0,100),o=(o=[].concat(Object(be.a)(o),Object(be.a)(t.myNotifications)).filter(function(e){return"add post"!==e.code})).reduce(_,[]),Ea()(o,e.lastNotifications)||e.setData({lastNotifications:o}),r.a.createElement("span",null)})),Ba=new y.a,za=Object(f.g)(Object(u.b)(function(e){return{isAuthed:e.isAuthed,user:e.user,account:e.account,accountNotActive:e.accountNotActive}},function(e){return{tryAuth:function(t,a){return e(ce(t,a))},logout:function(){return e(function(e){se.remove("rememberme",{path:"/"}),se.remove("auth_token",{path:"/"}),delete l.a.defaults.headers.common["x-auth-token"],delete l.a.defaults.headers.post["x-auth-token"],delete l.a.defaults.headers.get["x-auth-token"],delete l.a.defaults.headers.delete["x-auth-token"],delete l.a.defaults.headers.put["x-auth-token"],e(ue(!1))})}}})(function(e){var t=e.isAuthed;Object(n.useEffect)(function(){e.tryAuth(e)},[]);var a=Ba.get("redirectto");a&&Ba.remove("redirectto",{path:"/"});var i=function(){return e.logout(),r.a.createElement(f.a,{to:"/login"})},o=r.a.createElement(f.d,null,r.a.createElement(f.b,{path:"/goals",exact:!0,component:vt}),r.a.createElement(f.b,{path:"/goals",component:zt}),r.a.createElement(f.b,{path:"/progresses",exact:!0,component:aa}),r.a.createElement(f.b,{path:"/progresses",component:ua}),r.a.createElement(f.b,{path:"/groups",component:Ma}),r.a.createElement(f.b,{path:"/profile",component:Ca}),r.a.createElement(f.b,{path:"/friends",exact:!0,component:Ia}),r.a.createElement(f.b,{path:"/account",exact:!0,component:xa}),r.a.createElement(f.b,{path:"/dashboard",exact:!0,component:ka}),r.a.createElement(f.b,{path:"/shop",exact:!0,component:ha}),r.a.createElement(f.b,{path:"/shop",component:Na}),r.a.createElement(f.b,{path:"/wishlist",exact:!0,component:Ra}),r.a.createElement(f.b,{path:"/wishlist",component:Fa}),!t&&r.a.createElement(f.b,{path:"/login",exact:!0,component:O}),r.a.createElement(f.b,{path:"/logout",exact:!0,component:i}),r.a.createElement(f.b,{path:"/activate-account",exact:!0,component:Aa}),!1,t?r.a.createElement(f.a,{to:"/dashboard"}):r.a.createElement(f.a,{to:"/login"}));return e.accountNotActive&&(o=r.a.createElement(f.d,null,!t&&r.a.createElement(f.b,{path:"/login",exact:!0,component:O}),r.a.createElement(f.b,{path:"/logout",exact:!0,component:i}),r.a.createElement(f.b,{path:"/activate-account",exact:!0,component:Aa}),!1,t?r.a.createElement(f.a,{to:"/activate-account"}):r.a.createElement(f.a,{to:"/login"}))),a?r.a.createElement(f.a,{to:a}):r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:{height:"100%"}},r.a.createElement(ae,null,o),t&&r.a.createElement(je,null),t&&r.a.createElement(La,null)))})),Ua=a(360),Va=Object(Ua.a)({isAuthed:!1,user:null,currentAccount:"",account:{},friendData:{},transactionData:{},progressData:{},currentProfile:"",profile:{},currentProgress:"",currentGroup:"",currentPosts:[],progress:{},post:{},postData:{},group:{},groupData:{},pageTitle:{},lastUrl:"",friendSearchResult:null,accountNotActive:!1,lastNotifications:[]},{SET_DATA:function(e,t){if(t.data){for(var a=0,n=["user","account","isAuthed","currentAccount","currentProfile","currentPosts","currentGroup","profile","group","currentProgress","progress","lastNotifications"];a<n.length;a++){var r=n[a];"undefined"!==typeof t.data[r]&&(e[r]=t.data[r])}for(var i=0,o=["friendData","progressData","post","postData","groupData","transactionData"];i<o.length;i++){var s=o[i];if("undefined"!==typeof t.data[s])for(var c in t.data[s])t.data[s][c]&&(e[s][c]=t.data[s][c])}}e.user&&(e.user.currentAccount?(e.currentAccount=e.user.currentAccount,e.accountNotActive=!1):e.user.myAccount?(e.currentAccount=e.user.myAccount,e.accountNotActive=!1):e.accountNotActive=!0)},REMOVE_DATA:function(e,t){if(t.data){for(var a=0,n=["user","account","profile","progress","group"];a<n.length;a++){var r=n[a],i=!0,o=!1,s=void 0;try{for(var c,l=t.data[r][Symbol.iterator]();!(i=(c=l.next()).done);i=!0){var u=c.value;e[r]._id===u&&(e[r]={})}}catch(b){o=!0,s=b}finally{try{i||null==l.return||l.return()}finally{if(o)throw s}}}for(var d=0,m=["post","friendData","progressData","postData","groupData","transactionData"];d<m.length;d++){var p=m[d],f=!0,g=!1,h=void 0;try{for(var y,E=t.data[p][Symbol.iterator]();!(f=(y=E.next()).done);f=!0){var v=y.value;delete e[p][v]}}catch(b){g=!0,h=b}finally{try{f||null==E.return||E.return()}finally{if(g)throw h}}}}},SET_FRIEND_SEARCH_RESULT:function(e,t){e.friendSearchResult=t.data},SET_FRIENDS_DATA:function(e,t){t.data&&(e.account.friendsData=t.data),t.data.perk&&(e.perk=t.data.perk)},SET_AVATAR_V:function(e,t){e.account.image=t.v},INCREASE_AVATAR_V:function(e){e.account.image=e.account.image+1},SET_IS_AUTHED:function(e,t){e.isAuthed=t.id},SET_PAGE_TITLE:function(e,t){e.pageTitle=t.title},SAVE_LAST_URL:function(e,t){"/login"!==t.url&&"/logout"!==t.url&&(e.lastUrl=t.url)},SET_ACCOUNT_ACTIVATED:function(e,t){e.accountNotActive=t.value}});a.d(t,"store",function(){return Ga}),l.a.defaults.baseURL="https://getreward.herokuapp.com";var Ga=Object(d.createStore)(Va,Object(p.composeWithDevTools)(Object(d.applyMiddleware)(m.a))),Ja=r.a.createElement(u.a,{store:Ga},r.a.createElement(s.a,null,r.a.createElement(za,null))),Wa=document.getElementById("root");o.a.render(Ja,Wa)}},[[362,1,2]]]);
//# sourceMappingURL=main.be779723.chunk.js.map